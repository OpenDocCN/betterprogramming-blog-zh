<html>
<head>
<title>How To Create a Loading Button in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Swift中创建加载按钮</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/loading-button-in-swift-566f9ff0d98a?source=collection_archive---------10-----------------------#2021-03-23">https://betterprogramming.pub/loading-button-in-swift-566f9ff0d98a?source=collection_archive---------10-----------------------#2021-03-23</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="3ad1" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">构建简单且可重用的定制装载视图</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/11be60b7c06ede41f91db616c5203dbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Cyt8oKAp3z_CW_EnYEa4Q.jpeg"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">由<a class="ae kw" href="https://unsplash.com/@maxcodes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Maxwell Nelson </a>在<a class="ae kw" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="4257" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">每次用户与我们的应用程序交互时，都需要我们做一些工作(例如调用端点或从后端获取数据)。我们必须让他们知道应用程序正在做一些事情。我们不应该让用户处于不知道当前正在发生什么的境地。</p><p id="d47e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这就是为什么加载动画如此重要。他们给用户一个暗示，在那个时刻应用程序中正在发生一些事情。</p><p id="c0cc" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">最常见的场景之一是登录按钮。当用户输入他们的凭证并点击按钮时，您可能必须与后端交互才能让用户登录应用程序。该过程可能需要几秒钟，也可能由于网络问题而失败。向用户展示按钮内部的某种加载是一个很好的做法。</p><p id="ae6a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这就是本文的内容。我想向你展示如何用几行代码使用一些<a class="ae kw" href="https://developer.apple.com/documentation/quartzcore" rel="noopener ugc nofollow" target="_blank">核心动画</a>基础来制作你自己的加载按钮。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj lt"><img src="../Images/5453254cad3dc843bf6c905b73a8815c.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/1*5YWHge83AFLcvckFqEST2A.gif"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">作者GIF。</p></figure><p id="8777" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">你可以看到负载由三个圆圈组成，它们按比例增加，然后返回到原来的位置。所以让我们从头开始创建一个自定义的<code class="fe lu lv lw lx b">UIView</code>类，它包含要制作动画的点。</p><p id="33aa" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们可以通过创建三个自定义<code class="fe lu lv lw lx b">UIViews</code>来创建点，并将它们的拐角半径设置为其宽度的一半:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ly lz l"/></div></figure><p id="e69e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">接下来要做的是为点配置动画，这是核心动画开始工作的时候。想想动画实际上做了什么:它放大，然后恢复到原始大小。并且这在动画运行时重复。</p><p id="5676" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们可以通过用<code class="fe lu lv lw lx b">UIview.animate…</code> API递归动画视图来实现这一点，但是我总是尽量避免递归函数，除非它们真的很有必要。有了核心动画，我们可以很容易地设置这个动画。</p><p id="ea48" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">首先，让我们定义三个不同的<code class="fe lu lv lw lx b">CABasicAnimation</code>属性(每个点一个)，然后做一些初始设置:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ly lz l"/></div></figure><p id="c98b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您应该仔细查看的设置的最重要属性是:</p><ul class=""><li id="60a2" class="ma mb ir kz b la lb ld le lg mc lk md lo me ls mf mg mh mi bi translated"><code class="fe lu lv lw lx b">autoreverses</code>:当这个设置为<code class="fe lu lv lw lx b">true</code>时，我们告诉动画一旦完成就恢复到原来的大小。</li><li id="dff4" class="ma mb ir kz b la mj ld mk lg ml lk mm lo mn ls mf mg mh mi bi translated">这是我们希望动画达到的比例因子。</li><li id="953d" class="ma mb ir kz b la mj ld mk lg ml lk mm lo mn ls mf mg mh mi bi translated">因为我们想重复播放动画直到它停止，我们必须将重复次数设置为无穷大。</li></ul><p id="9c05" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，为了开始动画，我们需要添加我们的<code class="fe lu lv lw lx b">CABasicAnimations</code>到点的层。为了将事情分开，让我们创建两个函数:<code class="fe lu lv lw lx b">startAnimation()</code>和<code class="fe lu lv lw lx b">stopAnimation()</code>。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ly lz l"/></div></figure><p id="301e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们已经准备好将我们的<code class="fe lu lv lw lx b">DotsAnimationView</code>添加到我们的<code class="fe lu lv lw lx b">ViewController</code>视图中，并调用<code class="fe lu lv lw lx b">startAnimation()</code>来看看会发生什么。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj lt"><img src="../Images/1da251904f54fc35d56f417c47c14213.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/1*lyGaJ-U_0ZKy_Ozf8QMqqA.gif"/></div></figure><p id="e8bc" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们将动画添加到图层后，它们就开始了，所以所有的动画都是同时开始的。幸运的是，我们有<code class="fe lu lv lw lx b">beginTime</code>属性来设置动画的起点。设置此属性可以延迟动画以产生序列效果。</p><p id="3d22" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="mo">注意:根据动画持续时间的不同，动画的延迟可能会有所变化，但是您可以调整一些值，直到它符合您的需要。</em></p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ly lz l"/></div></figure><p id="a857" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们只需要创建一个自定义按钮并添加我们刚刚创建的<code class="fe lu lv lw lx b">DotsAnimationView</code>:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ly lz l"/></div></figure><p id="8904" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">就是这样！我们只需要调用我们按钮的<code class="fe lu lv lw lx b">startAnimation()</code>和<code class="fe lu lv lw lx b">stopAnimation()</code>函数。</p><p id="4606" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在一个单独的视图中获得动画的酷之处在于，你可以在一个按钮或任何其他视图中使用它。例如，您可以在从后端获取一些数据以显示在集合视图中时使用它。</p></div><div class="ab cl mp mq hv mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ik il im in io"><h1 id="ef94" class="mw mx ir bd my mz na nb nc nd ne nf ng jx nh jy ni ka nj kb nk kd nl ke nm nn bi translated">结论</h1><p id="c7bc" class="pw-post-body-paragraph kx ky ir kz b la no js lc ld np jv lf lg nq li lj lk nr lm ln lo ns lq lr ls ik bi translated">我希望这能作为一个起点帮助你。你可以随心所欲地发挥创造力。也许你的加载不包括缩放变换，而是一个平移或不透明度。无论你想做什么，你都可以自己做。只要记住我们在这里使用的分离和可重用原则，这样你就可以不仅在你的按钮中使用你的加载动画。</p><p id="8830" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果您有任何问题，请随时发表评论。我很乐意帮忙。你可以在GitHub 上查看完整代码<a class="ae kw" href="https://github.com/blorenzo10/loading-button" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>