<html>
<head>
<title>Permanent File Storage for Web3 Apps With Arweave, Bundlr, Next.js, RainbowKit, and Wagmi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Arweave、Bundlr、Next.js、RainbowKit和Wagmi为Web3应用程序提供永久文件存储</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/permanent-file-storage-for-web3-apps-with-arweave-bundlr-next-js-rainbowkit-and-wagmi-18aa1506fa6e?source=collection_archive---------10-----------------------#2022-06-27">https://betterprogramming.pub/permanent-file-storage-for-web3-apps-with-arweave-bundlr-next-js-rainbowkit-and-wagmi-18aa1506fa6e?source=collection_archive---------10-----------------------#2022-06-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="910b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何创建存储数据的最佳方式</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4fda7a9e1a31c0f840e5c789f5ec04f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4_aEaUYIFIOfjgTt"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@steve_j?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯蒂夫·约翰森</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="432c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将向您展示如何使用testnet上的bundlr创建一个Dapp，允许我们在Arweave网络上存储数据。</p><p id="795a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在继续之前，让我们看看今天我们要构建什么。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/96381c290b0e0a4eee3805dfcf5fb01b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M4dj3gwBQJjGOex__rN82Q.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="3087" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想尝试一下，下面是已部署的链接:</p><p id="4e73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">【https://bundlr-arweave.netlify.app/ T4】</p><h1 id="fe1c" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">我用过的技术堆栈和库:</h1><ul class=""><li id="e617" class="mn mo iq ky b kz mp lc mq lf mr lj ms ln mt lr mu mv mw mx bi translated">Nextjs</li><li id="8061" class="mn mo iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">Chakra UI</li><li id="6ee0" class="mn mo iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">RainbowKit</li><li id="3669" class="mn mo iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">瓦格米</li><li id="f3d3" class="mn mo iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">Bundlr客户</li></ul><h1 id="6812" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">好吧，好吧，让我们先看看什么是Arweave和Bundlr(来自文档)</h1><p id="08f9" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">如果你像我一样喜欢视频，这里有一个视频给你:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng lu l"/></div></figure><h1 id="6934" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated"><a class="ae kv" href="https://www.arweave.org/" rel="noopener ugc nofollow" target="_blank"> Arweave </a></h1><p id="74c5" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">Arweave使信息永久可持续。</p><p id="8ed8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Arweave是一种新型存储，它以可持续和永久的天赋支持数据，允许用户和开发人员第一次真正永久地存储数据。</p><h1 id="123b" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated"><a class="ae kv" href="https://docs.bundlr.network/docs/about/introduction" rel="noopener ugc nofollow" target="_blank"> Bundlr </a></h1><p id="f81b" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">Bundlr使Arweave上的web3数据存储变得像传统数据存储一样快速、简单和可靠。Arweave是唯一真正分散的永久性数据存储解决方案。</p><p id="9534" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Bundlr在不牺牲安全性或可用性的情况下，将Arweave上进行的交易数量增加了4，000%，上传数据的速度提高了约3，000倍。</p><p id="d732" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Bundlr目前占上传到Arweave的数据的90%以上。它支持无限的可伸缩性，并支持即时和有保证的事务终结。这是一个多链解决方案，兼容领先的区块链，包括以太坊，索拉纳，雪崩，多边形，等等。</p><h1 id="e6f7" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">使用Bundlr上传到Arweave必须遵循的步骤</h1><ol class=""><li id="0a16" class="mn mo iq ky b kz mp lc mq lf mr lj ms ln mt lr nh mv mw mx bi translated">连接钱包</li><li id="00db" class="mn mo iq ky b kz my lc mz lf na lj nb ln nc lr nh mv mw mx bi translated">初始化Bundlr客户端</li><li id="b347" class="mn mo iq ky b kz my lc mz lf na lj nb ln nc lr nh mv mw mx bi translated">添加资金(BNDLR代币)</li><li id="2175" class="mn mo iq ky b kz my lc mz lf na lj nb ln nc lr nh mv mw mx bi translated">上传文件</li></ol><blockquote class="ni nj nk"><p id="ba8e" class="kw kx nl ky b kz la jr lb lc ld ju le nm lg lh li nn lk ll lm no lo lp lq lr ij bi translated"><em class="iq">注意:我们将在polygon mumbai testnet </em>上构建这个应用程序</p><p id="a149" class="kw kx nl ky b kz la jr lb lc ld ju le nm lg lh li nn lk ll lm no lo lp lq lr ij bi translated"><em class="iq"> Bundlr有一个devnet，允许您使用devnet/testnet加密货币网络支付存储费用。devnet节点的行为与mainnet节点完全一样——除了数据不会移动到Arweave，并且会在一周后从Bundlr中清除。</em></p></blockquote><h1 id="2991" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">让我们开始建造吧</h1><p id="8336" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">为了更好地理解<a class="ae kv" href="https://github.com/Deep1144/bundlr-arweave-testnet-uploader" rel="noopener ugc nofollow" target="_blank"> Github </a>，将完成的代码放在一边打开</p><h1 id="cfa1" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">1.设置项目</h1><p id="e214" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">用tailwind CSS和Chakra ui设置一个Nextjs项目你可以使用<a class="ae kv" href="https://github.com/dhaiwat10/create-web3-frontend" rel="noopener ugc nofollow" target="_blank"> create-web3-frontend </a>包快速完成设置，或者直接克隆这个<a class="ae kv" href="https://github.com/Deep1144/bundlr-arweave-testnet-uploader" rel="noopener ugc nofollow" target="_blank">项目报告</a></p><p id="f0d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，安装这两个依赖项:</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="553c" class="nu lw iq nq b gy nv nw l nx ny">yarn add @bundlr-network/client bignumber.js</span></pre><h1 id="f067" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">2.连接钱包</h1><p id="2b73" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">由于我们使用的是Rainbow kit，这一步在<code class="fe nz oa ob nq b">index.tsx</code>中非常简单:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc lu l"/></div></figure><p id="b78b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这5-6行代码，我们就完成了钱包的连接。</p><p id="1b49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还添加了一个条件来检查用户是否在Mumbai测试中，因为我们将在本文中使用polygon Mumbai testnet。</p><p id="07bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe nz oa ob nq b">_app.jsx</code>中，在配置Rainbow kit时，我们已经将其配置为使用polygon Mumbai testnet</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="7caa" class="nu lw iq nq b gy nv nw l nx ny">const { chains, provider } = configureChains(<br/>  [chain.polygonMumbai],<br/>  [<br/>    jsonRpcProvider({ rpc: () =&gt; ({ http: process.env.NEXT_PUBLIC_ALCHEMY_RPC_URL }) }),<br/>    publicProvider(),<br/>  ]<br/>);</span></pre><p id="3764" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，Rainbow kit还会负责为我们更改网络，这就是这个警告的样子</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/af334ec9eaea981a327a02e95585b817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4RZkREkSVli0yGXe.png"/></div></div></figure><h1 id="528b" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">3.初始化Bundlr</h1><p id="007e" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">让我们为bundlr创建一个上下文，这样我们就可以从那里维护所有与bundlr相关的逻辑。</p><p id="1c34" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创造<code class="fe nz oa ob nq b">bundlr.context.tsx</code></p><p id="788f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们在这个文件中创建上下文。你可以在这里看到文件<a class="ae kv" href="https://github.com/Deep1144/bundlr-arweave-testnet-uploader/blob/main/state/bundlr.context.tsx" rel="noopener ugc nofollow" target="_blank">的完整版本</a>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc lu l"/></div></figure><p id="352e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了初始化Bundlr，我们将使用上面代码中的<code class="fe nz oa ob nq b">initialiseBundlr</code>方法。代码也非常简单。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="3b42" class="nu lw iq nq b gy nv nw l nx ny">const bundlr = new WebBundlr(<br/>            "https://devnet.bundlr.network",<br/>            "matic",<br/>            provider,<br/>            {<br/>                providerUrl:<br/>                    process.env.NEXT_PUBLIC_ALCHEMY_RPC_URL,<br/>            }<br/>        );<br/>        await bundlr.ready();<br/>        setBundlrInstance(bundlr);</span></pre><p id="221f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们正在创建Bundlr客户端的一个实例，并将其存储在一个状态变量中</p><p id="dc29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">阅读更多关于<a class="ae kv" href="https://docs.bundlr.network/docs/client/js" rel="noopener ugc nofollow" target="_blank"> bundlr客户端</a>的信息。</p><p id="099a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用Bundlr和testnet，<a class="ae kv" href="https://docs.bundlr.network/docs/devnet" rel="noopener ugc nofollow" target="_blank">阅读此处</a>。</p><blockquote class="ni nj nk"><p id="edbf" class="kw kx nl ky b kz la jr lb lc ld ju le nm lg lh li nn lk ll lm no lo lp lq lr ij bi translated">为了使用devnet，您需要使用<code class="fe nz oa ob nq b">https://devnet.bundlr.network</code>作为节点，并将提供者url设置为给定链的正确testnet/devnet RPC端点。</p></blockquote><p id="32e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的RPC URL看起来像这样，因为我们将使用polygon testnet。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="7001" class="nu lw iq nq b gy nv nw l nx ny">NEXT_PUBLIC_ALCHEMY_RPC_URL=https://polygon-mumbai.g.alchemy.com/v2/{{alchemy_project_id}}</span></pre><p id="1ee0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在此阅读，关于bundlr <a class="ae kv" href="https://docs.bundlr.network/docs/currencies" rel="noopener ugc nofollow" target="_blank">支持的所有货币/网络。</a></p><h1 id="9cba" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">4.添加资金(bndlr代币)</h1><p id="28fb" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">我们已经有了关于bundlr上下文中的<code class="fe nz oa ob nq b">balance</code>的数据，我们也有了一个方法<code class="fe nz oa ob nq b">fundWallet</code>，我们将使用它来添加资金。</p><p id="b1f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加基金也非常简单。只需在<code class="fe nz oa ob nq b">bundlrInstance</code>上使用<code class="fe nz oa ob nq b">fund</code>方法，并传递您想要存入钱包的金额。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="d0fe" class="nu lw iq nq b gy nv nw l nx ny">let response = await bundlrInstance.fund(amountParsed)</span></pre><p id="5f4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe nz oa ob nq b">index.tsx</code>中，进行以下更改:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc lu l"/></div></figure><p id="d609" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们创建<code class="fe nz oa ob nq b">&lt;FundWallet /&gt;</code>组件。</p><p id="1f0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创造<code class="fe nz oa ob nq b">components/FundWallet.tsx</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc lu l"/></div></figure><h1 id="81bb" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">5.上传图像</h1><p id="ee57" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf nd lh li lj ne ll lm ln nf lp lq lr ij bi translated">现在，由于我们已经添加了资金，我们可以将图像(或任何其他文件)上传到Arweave网络。</p><p id="bd54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe nz oa ob nq b">index.tsx</code>中，在文件末尾添加以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc lu l"/></div></figure><p id="d0cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们创建<code class="fe nz oa ob nq b">&lt;UploadImage /&gt;</code>组件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc lu l"/></div></figure><p id="b135" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这个，我们现在可以把文件上传到Arweave网络。</p><h1 id="427f" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">进一步改进</h1><ol class=""><li id="8c8f" class="mn mo iq ky b kz mp lc mq lf mr lj ms ln mt lr nh mv mw mx bi translated">目前，我们只上传图片。我们还可以添加对其他格式的支持(视频、音频等)。</li><li id="5690" class="mn mo iq ky b kz my lc mz lf na lj nb ln nc lr nh mv mw mx bi translated">在Supabase中存储带有钱包地址的上传图像的URL，并在用户连接钱包时显示用户之前上传的文件列表。</li></ol><p id="bc48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成代码:<a class="ae kv" href="https://github.com/Deep1144/bundlr-arweave-testnet-uploader" rel="noopener ugc nofollow" target="_blank"> GitHub </a></p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="0bbb" class="nu lw iq nq b gy nv nw l nx ny"><strong class="nq ir">Want to Connect?</strong></span><span id="82b3" class="nu lw iq nq b gy oe nw l nx ny">Connect with me on <a class="ae kv" href="https://twitter.com/pateldeep_eth" rel="noopener ugc nofollow" target="_blank">Twitter</a> @pateldeep_eth.</span><span id="f43f" class="nu lw iq nq b gy oe nw l nx ny"><a class="ae kv" href="https://www.linkedin.com/in/patel-deep-dev/" rel="noopener ugc nofollow" target="_blank">Linkedin</a></span><span id="d37a" class="nu lw iq nq b gy oe nw l nx ny"><em class="nl">Originally published at </em><a class="ae kv" href="http://pateldeep.xyz/" rel="noopener ugc nofollow" target="_blank"><em class="nl">https://pateldeep.xyz/</em></a></span></pre></div></div>    
</body>
</html>