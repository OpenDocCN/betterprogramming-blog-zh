<html>
<head>
<title>How to Use the Google Drive API With Flutter Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Flutter应用中使用Google Drive API</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-minimum-guide-for-using-google-drive-api-with-flutter-9207e4cb05ba?source=collection_archive---------0-----------------------#2020-09-27">https://betterprogramming.pub/the-minimum-guide-for-using-google-drive-api-with-flutter-9207e4cb05ba?source=collection_archive---------0-----------------------#2020-09-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1cc7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">挖掘Google Drive的强大功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/280c36d3749db7bd077fc4cb2a07899b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E_3grRKLLouLHPF4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">斯蒂芬·弗兰克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d15b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Google APIs是一把巨大的保护伞。查看来自<a class="ae ky" href="https://developers.google.com/apis-explorer" rel="noopener ugc nofollow" target="_blank"> Google API explorer </a>的近200个条目。在所有这些API中，一些流行的API包括:Google Drive、Gmail、Cloud Datastore、Google Cloud Storage等。今天，让我们来看看如何将Google Drive API集成到一个<a class="ae ky" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a>应用中。</p><p id="f424" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Google Drive API有许多有趣的方面。但我发现的最有趣的一点是，它为您的用户数据提供云存储，而无需实际构建、维护和支付云存储。假设您要构建一个简单的待办事项应用程序，您可以使用Google Drive来备份和恢复用户的待办事项。</p><p id="0081" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按照这篇文章，建议你有一些关于省道和扑动的基本知识。如果没有，请先浏览<a class="ae ky" href="https://flutter.dev/docs/get-started/install" rel="noopener ugc nofollow" target="_blank">这里</a>的入门文档。另外，这篇博文的编码部分相对来说比较简单，希望不会太难理解。</p><p id="38e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5259" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">属国</h1><p id="3a66" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们将依赖于两个包:</p><ul class=""><li id="4978" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated"><a class="ae ky" href="https://pub.dev/packages/googleapis" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Google APIs</strong></a><strong class="lb iu"/>包含用于访问Google Drive的库。Google Drive和Google的其他开放API一样，有RESTful端点。但是使用SDK稍微容易一些，也不容易出错。</li><li id="f85b" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><a class="ae ky" href="https://pub.dev/packages/google_sign_in" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">google _ sign _ in</strong></a><strong class="lb iu"/>允许用户登录自己的Google账户。我们还将使用它来请求访问Google Drive的权限。</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f659" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">准备新的颤振应用</h1><p id="647e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们可以从Android studio创建一个app:<code class="fe nn no np nq b">File</code>&gt;<code class="fe nn no np nq b">New</code>&gt;<code class="fe nn no np nq b">New Flutter Project …</code>。我们称这个应用为<code class="fe nn no np nq b">google_drive_demo_app</code>，并给它一个包名<code class="fe nn no np nq b">com.demo.googledrivedemoapp</code>。</p><div class="kj kk kl km gt ab cb"><figure class="nr kn ns nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/c1d6cfbb410054dd95d9c0101b5eef48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*18l13HXiM2PY4PGQhe_elQ.png"/></div></figure><figure class="nr kn ns nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/258bafa491ec232c9aa37f6406b5fdba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*cu1qKhLvrk2hkIgCI_PUZg.png"/></div></figure></div><p id="dff0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，您也可以使用以下命令来初始化新的应用程序:</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="e5a6" class="ob md it nq b gy oc od l oe of">flutter create <!-- -->google_drive_demo_app</span></pre><p id="11a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认的应用程序是这样的。它的右下角有一个浮动按钮，中间有一个标签。我们从现在开始将浮动按钮称为<strong class="lb iu">加按钮</strong>。用户每按一次加号按钮，中间的数字就加1。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/79a7efcfb1f2beffc115679fcadbd9ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*5eX4rrfUWgFnIJHM7Z-F0A.png"/></div></figure><p id="6b88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将对其进行更改，以便每次单击按钮时，它都会将hello_world.txt文件上传到Google Drive <strong class="lb iu">。</strong></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c639" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">添加依赖关系</h1><p id="c070" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">打开<code class="fe nn no np nq b">pubspec.yaml</code>文件，添加以下依赖项:</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="b9a3" class="ob md it nq b gy oc od l oe of">dependencies:<br/>  googleapis: any<br/>  google_sign_in: any</span></pre><p id="0e74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在这里为演示应用程序放置了<code class="fe nn no np nq b">any</code>,但是您应该为您的实际应用程序指定版本。</p><h1 id="bb27" class="mc md it bd me mf oh mh mi mj oi ml mm jz oj ka mo kc ok kd mq kf ol kg ms mt bi translated">谷歌登录</h1><p id="ddec" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">打开<code class="fe nn no np nq b">main.dart</code>，定位<code class="fe nn no np nq b">_incrementCounter()</code>功能，当用户点击加号按钮时调用。这个函数看起来是这样的:</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="abd0" class="ob md it nq b gy oc od l oe of">void _incrementCounter() {<br/>  setState(() {<br/>    _counter++;<br/>  });<br/>}</span></pre><p id="6ec8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们把它改成也要求用户登录到他们的google帐户，并授予Google Drive权限(又名<code class="fe nn no np nq b">scope</code>):</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="eeec" class="ob md it nq b gy oc od l oe of">Future&lt;void&gt; _incrementCounter() async {<br/>  setState(() {<br/>    _counter++;<br/>  });<br/><br/>  final googleSignIn = signIn.GoogleSignIn.standard(scopes: [drive.DriveApi.<em class="om">DriveScope</em>]);<br/>  final signIn.GoogleSignInAccount account = await googleSignIn.signIn();<br/>  print("User account $account");<br/>}</span></pre><p id="5222" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将这些导入添加到<code class="fe nn no np nq b">main.dart</code>文件的顶部:</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="dda3" class="ob md it nq b gy oc od l oe of">import 'package:googleapis/drive/v3.dart' as drive;<br/>import 'package:google_sign_in/google_sign_in.dart' as signIn;</span></pre><p id="ecd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Google Drive API v3是最近发布的，我们这里用的就是这个。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="dbad" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建一个新的Firebase项目</h1><p id="e88e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">打开<a class="ae ky" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>，新建一个项目。我们将这个项目命名为<strong class="lb iu"> Google Drive演示应用。它还会问你是否想启用谷歌分析。这是一个有用的工具，但是我们的演示应用程序不需要它。</strong></p><div class="kj kk kl km gt ab cb"><figure class="nr kn on nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ee4710dc8d367da2eec4122a72578514.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*-VXWOgFZM-PHNcXeUoHIXQ.png"/></div></figure><figure class="nr kn oo nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/06751c7d81afde085a7077d53c663284.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*aS35-tPndoYvnCCo0TEQdg.png"/></div></figure></div><p id="752d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建完成后，寻找“添加firebase到你的应用程序”按钮。我们从安卓开始。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/65b2a6d40e77a379bf517091586710bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*bQ92GXe6xBxo4cgw26TcHg.png"/></div></figure><p id="01f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nn no np nq b">package name</code>和<code class="fe nn no np nq b">SHA-1</code>字段都很重要。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/83caae75730f9bb29c218c1928110d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*O7zAlQmGA8z-ib8UHf3aNw.png"/></div></figure><p id="f3b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要确保<code class="fe nn no np nq b">package name</code>与<code class="fe nn no np nq b">android/app/build.gradle</code>下的<code class="fe nn no np nq b">applicationId</code>匹配:</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="e7eb" class="ob md it nq b gy oc od l oe of">android {<br/>    ...<br/>    defaultConfig <strong class="nq iu">{<br/></strong><em class="om">        </em>applicationId <strong class="nq iu">"com.demo.googledrivedemoapp"</strong><br/>    ...<br/>    }<br/>    ...<br/>}</span></pre><p id="a562" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管<code class="fe nn no np nq b">SHA-1</code>在控制台中标记为可选，但<a class="ae ky" href="https://stackoverflow.com/q/54557479/1035008" rel="noopener ugc nofollow" target="_blank">实际上是必需的</a>。应用程序签名是一个复杂的话题。不需要太深入，我们可以通过运行<code class="fe nn no np nq b">android</code>文件夹下的<code class="fe nn no np nq b">./gradlew signingReport</code>来获得<code class="fe nn no np nq b">SHA-1</code>。</p><p id="6c13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后我们可以从控制台下载<code class="fe nn no np nq b">google-services.json</code>文件，放在<strong class="lb iu"> android/app </strong>文件夹下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/226030a4e396a64b4ee3b73323662615.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*UOqwMW-ptUyfNiaGEsFNvw.png"/></div></figure><p id="0795" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到Firebase控制台。默认情况下，所有登录提供程序都被禁用。让我们启用Google登录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/020f88adee15778fb72aea5515ece5a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Awhe-CaGfZIQbkkZM476gw.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="6cac" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">验证用户登录</h1><p id="95df" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们应该拥有用户登录所需的一切。如果我们现在运行应用程序并单击加号按钮，它应该会提示用户登录，请求访问Google Drive的权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/d031ccf30c09ae7d5b7989a6b1121bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*DBfS437XA4xqijwhPLfQSA.png"/></div></figure><p id="ba0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们检查日志输出，预计会看到以下内容:</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="6b8d" class="ob md it nq b gy oc od l oe of">I/flutter ( 2935): User account GoogleSignInAccount:{displayName: Yuchen, email: y********@gmail.com, id: 103110639438********, photoUrl: https://lh3.googleusercontent.com/a-/AOh14GhKsixVhDGiNcEFkGFn_********37CiHqAF783}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="42e0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">启用Google Drive API</h1><p id="85d0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当我们创建上面的Firebase项目时，我们实际上是在幕后创建一个Google Cloud项目。Firebase控制台可以被认为是一个更简单的配置门户，可以更容易地构建移动应用程序。然而，有些东西是Firebase控制台无法提供的，包括启用Google Drive API。这就是为什么我们需要在这里切换到<a class="ae ky" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>的原因。</p><p id="bb86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Google Cloud Console中，应该已经创建了<strong class="lb iu"> Google Drive演示应用</strong>项目。找搜索栏，搜索“Google Drive API”。这将打开下一页。点击“启用”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/6e4e038fe721774a04230b68eccf91a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HzGfa8WZjGTkQLkRF3P2Yg.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="99fb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">将文件上传到Google Drive</h1><p id="cc85" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最后，是时候把所有东西放在一起，上传一些文件到Google Drive。</p><p id="dee6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<a class="ae ky" href="https://pub.dev/packages/http" rel="noopener ugc nofollow" target="_blank"> http </a>包创建一个新文件<code class="fe nn no np nq b">GoogleAuthClient.dart</code>。<code class="fe nn no np nq b">GoogleAuthClient</code>类基于<code class="fe nn no np nq b"><a class="ae ky" href="https://pub.dev/documentation/http/latest/http/BaseClient-class.html" rel="noopener ugc nofollow" target="_blank">BaseCleint</a></code>，它已经支持所有标准的HTTP请求:<code class="fe nn no np nq b">POST</code>、<code class="fe nn no np nq b">GET</code>等。我们在内部封装了另一个<code class="fe nn no np nq b"><a class="ae ky" href="https://pub.dev/documentation/http/latest/http/Client-class.html" rel="noopener ugc nofollow" target="_blank">Client</a></code>并实现了<code class="fe nn no np nq b">send</code>函数，稍后我们将在其中注入认证头。</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="161e" class="ob md it nq b gy oc od l oe of">import 'package:http/http.dart' as http;<br/><br/>class GoogleAuthClient extends http.BaseClient {<br/>  final Map&lt;String, String&gt; _headers;<br/><br/>  final http.Client _client = new http.Client();<br/><br/>  GoogleAuthClient(this._headers);<br/><br/>  Future&lt;http.StreamedResponse&gt; send(http.BaseRequest request) {<br/>    return _client.send(request..headers.addAll(_headers));<br/>  }<br/>}</span></pre><p id="837e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们用来自上面用户<code class="fe nn no np nq b">account</code>的auth头创建一个<code class="fe nn no np nq b">GoogleAuthClient</code>，然后用它创建一个Google Drive API对象<code class="fe nn no np nq b">DriveApi</code>。</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="0c6d" class="ob md it nq b gy oc od l oe of">final authHeaders = await account.authHeaders;<br/>final authenticateClient = GoogleAuthClient(authHeaders);<br/>final driveApi = drive.DriveApi(authenticateClient);</span></pre><p id="174b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们来上传一个文件。</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="1fe5" class="ob md it nq b gy oc od l oe of">final Stream&lt;List&lt;int&gt;&gt; mediaStream =<br/>    Future.value([104, 105]).asStream().asBroadcastStream();<br/>var media = new drive.Media(mediaStream, 2);<br/>var driveFile = new drive.File();<br/>driveFile.name = "hello_world.txt";<br/>final result = await driveApi.files.create(driveFile, uploadMedia: media);<br/>print("Upload result: $result");</span></pre><p id="5514" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有一点作弊。</p><p id="0d67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，我们会打开一个文件作为<code class="fe nn no np nq b">mediaStream</code>，并上传到Google Drive。但是为了保持这个演示的简单，我们将跳过它。相反，我们直接从<code class="fe nn no np nq b">"hi"</code>创建一个输入流，并作为文件<code class="fe nn no np nq b">"hello_world.txt"</code>上传到Google Drive。神奇的数字<code class="fe nn no np nq b">104</code>、<code class="fe nn no np nq b">105</code>，如果你在<a class="ae ky" href="http://www.asciitable.com/" rel="noopener ugc nofollow" target="_blank"> ascii表</a>中查找它们，对应于<code class="fe nn no np nq b">"h"</code>和<code class="fe nn no np nq b">"i"</code>的ascii码。</p><p id="077f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行应用程序并再次点击加号按钮。预计控制台会显示以下日志:</p><pre class="kj kk kl km gt nx nq ny nz aw oa bi"><span id="37b5" class="ob md it nq b gy oc od l oe of">I/flutter (12091): Upload result: 'Instance of 'File'</span></pre><p id="0b91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你打开你的Google Drive，你应该会看到一个里面有<code class="fe nn no np nq b">hi</code>的<code class="fe nn no np nq b">hello_word.txt</code>文件。我们做到了！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/14a3da6b6b33545084766a2ba2a46c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xikh5NZerZdfRHbOQZ5GVw.png"/></div></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4beb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">结尾</strong></h1><p id="66f9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当然，远不止这些。您可以下载文件、列出文件、搜索文件等。但希望这能给你一个好的起点。</p><p id="a90c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天到此为止。感谢阅读！快乐编码，照顾一个又一个，最重要的是，保持安全！</p><p id="afac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像往常一样，演示代码可以在<a class="ae ky" href="https://github.com/yzhong52/GoogleDriveDemoApp" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。</p></div></div>    
</body>
</html>