<html>
<head>
<title>How To Effectively Scale Your Web Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何有效地扩展您的Web应用程序</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-effectively-scale-your-web-application-7e3917bb98f?source=collection_archive---------2-----------------------#2021-11-19">https://betterprogramming.pub/how-to-effectively-scale-your-web-application-7e3917bb98f?source=collection_archive---------2-----------------------#2021-11-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3d08" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">您需要了解的扩展解决方案，以及选择合适的扩展模式所涉及的流程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7b57242947761d007780341442821620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zmm1wP9k4Bqz4vkR7nuXXQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">抽象比例图|由作者创建</p></figure><p id="5393" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几乎所有的应用程序都有一个共同的目标——建立用户群，证明应用程序有市场。随着用户的增加，流量也会增加，而流量的增加会给应用程序的基础设施带来更多的负载。虽然这个里程碑肯定是你应该庆祝的，但最好还是把香槟放好🍾宜早不宜迟，处理成长的烦恼；否则，很快您就会发现您的应用程序交付的性能很差，这会很快导致用户失望。如果发生这种情况，你将不再需要扩展，因为你的用户已经离开你去找竞争对手了。</p><p id="6219" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">欢迎阅读本系列的第2部分，它将介绍如何有效地扩展您的web应用程序。我发现关于扩展web应用程序的指南要么缺少重要的扩展模式，要么同样重要的是，没有涵盖选择扩展解决方案的思维过程。不过不要担心，这本指南会帮你搞定的！</p><p id="5bcc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通常，数据库是第一个表现出过载迹象的组件，因此我们在第1部分— <a class="ae lu" href="https://medium.com/swlh/5-database-scaling-solutions-you-need-to-know-e307570efb72" rel="noopener">如何有效地扩展您的数据库</a>(下面的链接)中处理了这个问题。本文将重点关注web服务器的伸缩。</p><div class="lv lw gp gr lx ly"><a href="https://medium.com/swlh/5-database-scaling-solutions-you-need-to-know-e307570efb72" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">您需要了解的5种数据库扩展解决方案</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">扩展的成本是什么？如何从鸟瞰角度扩展应用？数据库扩展解决方案。缓存，索引…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="99b0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在开始为您的web服务器扩展解决方案之前，有一些非常重要的方面需要考虑:扩展的成本，以及使用指标来扩展您的应用程序。缩放的这些方面同样重要，如果不是比缩放模式本身更重要的话。我们已经在本系列的第1部分中介绍了这些方面，所以如果您还没有阅读第1部分，我强烈建议您阅读一下，这样您就可以了解这些有效扩展web应用程序的完整过程。事不宜迟，我们开始吧！</p><h1 id="a5cd" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">服务器扩展解决方案</h1><h2 id="b8d8" class="nf mo it bd mp ng nh dn mt ni nj dp mx lh nk nl mz ll nm nn nb lp no np nd nq bi translated"><strong class="ak">垂直缩放(Scaling Up) </strong></h2><p id="e6b8" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">随着我们用户群的增长，同时连接到一个服务器的客户端数量也在增长，web服务器最终会耗尽RAM和CPU，导致应用程序变慢、出错或崩溃。你会问，我们能不能只增加CPU和RAM的数量？是的，我们可以。这就是垂直缩放，也称为<em class="nw">放大</em>。这只是在现有服务器上添加资源，或者用更强大的服务器替换现有服务器的方法；架构模式保持不变。</p><p id="4801" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，这不是永久的解决方案，通常也不是最初实现的最佳扩展模式。垂直扩展是有限制的，因为您最终会达到您正在使用的机器的资源容量。拥有一台容量增加到128GB RAM的服务器比拥有四台32GB RAM的服务器(相当于128GB RAM)的成本更高，与所花的钱相比，容量增加的增量会减少。这种扩展模式的另一个缺陷是，它仍然存在<em class="nw">单点故障的问题— </em>如果服务器出现问题，您的应用程序将会崩溃，因为没有冗余或后备选项<strong class="la iu">。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/93cdaf68dd40f37c69ee9047929e20b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_v9YLjyftK4DyMKncXmhQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">垂直比例(放大)图|由作者创建</p></figure><p id="183d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">水平缩放(缩小)</strong></p><p id="04c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">尽管我们已经考虑了扩展我们的服务器，但我们还没有找到一个持久的解决方案，也没有容错基础设施。欢迎使用水平扩展—这是一种分布式架构模式，您可以添加额外的服务器来实现相同的目的。水平扩展在本质上是无限的，因为您的服务器可以从1扩展到“n”，没有限制。它为应用程序的基础设施建立了弹性，因为如果一个服务器崩溃，有“n”个服务器可以依靠。随着扩展的深入，它也比垂直扩展更加便宜。</p><p id="d87f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">横向扩展带来的一个复杂性是分发流量。为了在服务器之间平均分配流量，我们使用了负载平衡器。负载平衡器充当客户端和服务器之间的中介。它知道服务器的IP地址，因此能够将流量从客户端路由到服务器。</p><p id="d21d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只有一个负载平衡器又带来了单点故障的问题。为了解决这个问题，设置了两个或三个负载平衡器，其中一个主动路由流量，其他的作为冗余。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/57be6a1fd6b0dde60c18b4aabf444ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SWhJ_pGN-nRmUMEAmE7WLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">水平缩放(向外扩展)图|由作者创建</p></figure><p id="6a41" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如今，像AWS、GCP和Azure这样的云服务提供商承担了所有实现负载平衡、水平扩展和垂直扩展的重任。作为工程师，我们现在只剩下设置和管理配置，许多复杂性都被抽象掉了。</p><p id="42c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你仍然需要知道引擎盖下发生了什么，这样你就可以有效地设置和管理一切，但男孩这比以前容易多了。例如，越来越多的服务被发布，具有自动缩放功能，如AWS Fargate您不必手动实现水平缩放，甚至不必设置何时以及如何缩放的配置；这些都被抽象化了，由AWS来处理。</p><p id="d0dd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您只需配置您的AWS Fargate堆栈，就可以开始工作了——这是成为工程师的好时机！有时候，您会希望有更精细的控制，但关键是有一系列选择，从自己实施一切到让IaaS(基础架构即服务)提供商为您处理一切。</p><h1 id="0709" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">会话存储</strong></h1><p id="0d75" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">如果你的应用程序使用<em class="nw">会话</em>来识别用户，而不是基于令牌的认证，那么拥有多个服务器将会遇到问题，因为会话存储在服务器的内存中。例如，当用户登录时，他们可以通过存储会话数据的服务器1进行登录，在下一次请求时，用户/客户端可能会被路由到服务器2，他们需要再次登录，因为该服务器没有会话信息。</p><p id="5e17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了解决这个问题，可以将会话信息分离到一个单独的存储位置，比如内存中的数据结构存储，比如Redis服务器。这样，所有的服务器都可以向Redis服务器发送会话，也可以从Redis服务器接收会话。同样，会有一个单点故障问题，我们可以为Redis服务器添加冗余，以增加应用程序的弹性并消除这个潜在的问题。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/c084ba2d2eb009166f3b670809cf6284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uyy1Utkh_VGyQG_y2DpJ-w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Redis缓存服务器图表|的会话数据由作者创建</p></figure><p id="aac0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果有任何其他数据需要存储在服务器上，应该将其解耦到自己的存储解决方案，并且所有服务器都应该能够访问该存储位置。</p><p id="83a9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">解决会话存储的另一个解决方案是将身份验证实现改为基于令牌的，这将会话负载从服务器转移到客户端。该解决方案可无限扩展，因为用户的会话数据存储在他们的客户端上，而如果用户基数足够大，将所有会话存储在服务器内存中会耗尽服务器的内存。</p><h1 id="15ae" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">缓存数据库查询</strong></h1><p id="ca85" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">这个伸缩解决方案已经在本系列的第1部分中讨论过了。这里再次提到它，因为缓存数据库查询不仅是扩展数据库最简单的方法之一，而且对扩展服务器也有很大的影响。如前所述，“扩展解决方案的高级目标是让堆栈为应用程序最常见的请求做更少的工作，或者在多个资源之间有效地分配无法消除的工作负载。”</p><p id="6707" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">缓存数据库查询就是这么做的——它消除了堆栈中的大量工作。下面是本系列第1部分的链接，在这里您可以更好地理解为什么缓存如此有效以及如何有效地实现它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/38229b7b6065e4637d72dbc2c02df0c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hHHdzSDrWZUKsus7Quymvg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">缓存数据库查询图|由作者创建</p></figure><h1 id="9679" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">通过内容交付网络提供静态资产</strong></h1><p id="81ad" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">静态资产是您发送给用户的、服务器不会更改的对象。HTML页面和JavaScript文件等一些静态资产相对来说是轻量级的。图像和视频等其他静态资产是大文件，每次用户请求页面时，通过网络将它们发送到客户端会给服务器带来很大压力。如果您的应用程序大量使用静态资产，您应该将服务静态资产的负载从您的服务器转移到CDN上，作为您的第一个扩展解决方案。</p><p id="a535" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">内容交付网络(CDN)是一个地理上分布的服务器网络，这些服务器协同工作以提供静态内容的快速交付。内容由内存缓存提供，并且由网络中离请求内容的客户端最近的服务器提供。</p><p id="6703" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用云提供商服务，如AWS的S3和Cloudfront，使这变得非常容易。你所要做的就是设置一个简单的配置，这样不仅可以减轻服务器的负载，还可以更快地处理静态内容，让你的应用程序获得用户喜欢的性能提升。</p><h1 id="4941" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">结论</h1><p id="262b" class="pw-post-body-paragraph ky kz it la b lb nr ju ld le ns jx lg lh nt lj lk ll nu ln lo lp nv lr ls lt im bi translated">由于AWS等IaaS提供商的存在，如今扩展应用程序变得如此容易。当然，我们仍然可以选择自己手动实现扩展解决方案，但是对于大多数场景来说，开发团队将大量繁重的工作抽象出来是有意义的，这样团队就可以专注于应用层。</p><p id="ffbd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">恭喜你，你的应用现在已经有了合适的解决方案来有效地处理服务器负载和数据库负载。现在还不是庆祝的时候…我们人类的注意力持续时间很短；如果你不想让你辛辛苦苦赢得的客户流失到那些无法提出自己想法的讨厌的模仿者手中，那么惊人的速度和性能已经成为必备条件。欢迎阅读本系列的最后一部分——用前端性能模式扩展客户端🚀(下面的链接)。</p><div class="lv lw gp gr lx ly"><a href="https://medium.com/geekculture/12-front-end-performance-patterns-you-need-to-know-def550620464" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">您需要了解的12种前端性能模式</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">使用这些性能解决方案减少页面加载时间</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">medium.com</p></div></div><div class="mh l"><div class="ob l mj mk ml mh mm ks ly"/></div></div></a></div></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><p id="024f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢看这样的文章，可以考虑注册成为一名媒体会员。每月只需5美元，你就可以无限制地访问Medium上的文章。如果你用我下面的链接注册，我会赚一点佣金。</p><div class="lv lw gp gr lx ly"><a href="https://chrisstaudinger.medium.com/membership" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">用我的推荐链接加入媒体-克里斯·斯陶丁格</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">chrisstaudinger.medium.com</p></div></div><div class="mh l"><div class="oj l mj mk ml mh mm ks ly"/></div></div></a></div></div></div>    
</body>
</html>