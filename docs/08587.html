<html>
<head>
<title>The Best Open-source Media Player to Integrate With Your Angular Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与Angular应用程序集成的最佳开源媒体播放器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/the-best-open-source-media-player-to-integrate-with-your-angular-apps-39a80ff1aedb?source=collection_archive---------3-----------------------#2021-05-18">https://betterprogramming.pub/the-best-open-source-media-player-to-integrate-with-your-angular-apps-39a80ff1aedb?source=collection_archive---------3-----------------------#2021-05-18</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="885c" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">在你的角度应用程序中设置沙加播放器</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/49dfcda7d21b069a6e83846be95187e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGOy-R9hzBrmtD67k98UEQ.jpeg"/></div></div></figure><p id="8678" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">最近，在我的公司，我们开始在网络应用中使用沙加播放器来播放媒体。</p><p id="b321" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><a class="ae lr" href="https://github.com/google/shaka-player" rel="noopener ugc nofollow" target="_blank">沙加播放器</a>是来自Google的一个优秀的开源JavaScript库。它可以在不使用任何浏览器插件的情况下播放DASH和HLS。这通过使用标准的<a class="ae lr" href="http://w3c.github.io/media-source/" rel="noopener ugc nofollow" target="_blank">媒体源扩展</a>和<a class="ae lr" href="https://w3c.github.io/encrypted-media/" rel="noopener ugc nofollow" target="_blank">加密媒体扩展</a>来实现。</p><p id="95f3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们有一些使用沙加播放器的经验，但是没有在我们的产品应用中使用它。虽然沙加播放器的文档非常好，但是没有关于如何将沙加播放器库集成到Angular的文档。</p><p id="ec1f" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">当我们成功地将沙加播放器集成到我们的Angular应用程序中时，这篇文章详细描述了我们是如何做到的。</p><p id="4ca9" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们从Azure Media Player切换到沙加播放器，因为我们切换到了不同的编码和打包解决方案。微软将Azure Media Player与Azure Media Service平台紧密耦合，因此打包的媒体无法从我们的新打包平台正确播放。</p><p id="2213" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Angular应用和沙加播放器Angular组件的源代码可以在<a class="ae lr" href="https://github.com/PatrickKalkman/shaka-player-angular" rel="noopener ugc nofollow" target="_blank">这个Github库</a>中找到。</p><h1 id="624a" class="ls lt iu bd lu lv lw lx ly lz ma mb mc ka md kb me kd mf ke mg kg mh kh mi mj bi translated">如何获取和编译沙加播放器</h1><p id="17d1" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">有三种方法可以得到沙加播放器。</p><ul class=""><li id="9b82" class="mp mq iu kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">您可以从源代码编译它</li><li id="a2c4" class="mp mq iu kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">您可以使用npm安装它</li><li id="c087" class="mp mq iu kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">你可以使用谷歌CDN直接链接到它</li></ul><p id="7db4" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们将从源代码编译它。这允许我们在必要时从发布版本切换到调试版本。要编译这个库，您必须安装所需的工具，从GitHub获取源代码，并运行Python中的构建脚本。</p><p id="d6a9" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我不会在这里重复完整的<a class="ae lr" href="https://shaka-player-demo.appspot.com/docs/api/tutorial-welcome.html" rel="noopener ugc nofollow" target="_blank">文档</a>，但是，简而言之，它归结为:</p><ol class=""><li id="c2b2" class="mp mq iu kx b ky kz lb lc le mr li ms lm mt lq nd mv mw mx bi translated">从Github获取源代码:</li></ol><pre class="kk kl km kn gu ne nf ng nh aw ni bi"><span id="9b92" class="nj lt iu nf b gz nk nl l nm nn">git clone https://github.com/google/shaka-player.git<!-- --> </span></pre><p id="07f0" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">2.通过运行Python构建脚本来编译源代码</p><pre class="kk kl km kn gu ne nf ng nh aw ni bi"><span id="b66b" class="nj lt iu nf b gz nk nl l nm nn">python build/all.p</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj no"><img src="../Images/e09cd4f786ccc502bf127a9efae142e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-upgEznlH6utZUZ--k_QNA.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">编译后的沙加播放器的各种版本</p></figure><p id="74bd" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果一切顺利，您将在<code class="fe nt nu nv nf b">dist</code>文件夹中拥有各种版本的库。如果没有，请检查<a class="ae lr" href="https://shaka-player-demo.appspot.com/docs/api/tutorial-welcome.html" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></div><div class="ab cl nw nx hy ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="in io ip iq ir"><h1 id="79c5" class="ls lt iu bd lu lv od lx ly lz oe mb mc ka of kb me kd og ke mg kg oh kh mi mj bi translated">创建角度演示应用程序</h1><p id="cadd" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">有了编译好的沙加播放器库，我们就可以实现Angular应用程序了。在撰写本文时，我们将使用最新版本的Angular CLI v 12 . 0 . 0来创建应用程序。</p><p id="450b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们通过在命令行执行<code class="fe nt nu nv nf b">ng new shaka-player-angular</code>来创建Angular应用程序。我选择无路由和CSS作为选项。生成app后，通过在命令行执行<code class="fe nt nu nv nf b">ng serve -o</code>来确保它正确运行。</p><p id="a86d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果一切顺利，应该会打开一个浏览器，显示以下屏幕:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oi"><img src="../Images/60edbd80375c4045e9ab7a9ae89b1870.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MdX8g4B1n3WEsZTivbPHkA.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">创建新应用程序后的欢迎屏幕</p></figure><h1 id="270f" class="ls lt iu bd lu lv lw lx ly lz ma mb mc ka md kb me kd mf ke mg kg mh kh mi mj bi translated">创建沙加播放器角度组件</h1><p id="2d38" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">现在我们已经生成了Angular应用程序，我们将创建沙加播放器组件。这个角组件将包含视频元素和沙加播放器。</p><p id="7867" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们使用Angular CLI通过在命令行上执行命令<code class="fe nt nu nv nf b">ng generate component shared/shaka-player</code>来创建组件。我使用shared是因为我希望组件位于共享文件夹下。</p><p id="84e8" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">为了确保一切顺利，进入<code class="fe nt nu nv nf b">shaka-player.component.html</code>文件，删除其中的所有内容，并用<code class="fe nt nu nv nf b">&lt;app-shaka-player&gt;&lt;/app-shaka-player&gt;</code>替换。保存文件，用<code class="fe nt nu nv nf b">ng serve -o</code>再次启动应用程序。</p><p id="0cac" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">它应该会在您的浏览器中显示以下结果:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oj"><img src="../Images/95fe1662dfa07d48958397d73eeaeb1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*srZJlNbL4A2I9qBRpcJJCQ.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">运行中的沙加播放器组件</p></figure><p id="49ae" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果您看到这个，那么您已经成功地创建了shaka-player组件。</p><h1 id="949c" class="ls lt iu bd lu lv lw lx ly lz ma mb mc ka md kb me kd mf ke mg kg mh kh mi mj bi translated">将编译好的沙加播放器源码集成到Angular</h1><p id="6293" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">现在是有趣的部分:如何将编译好的沙加播放器库集成到应用程序中。下面详细解释一下。</p><h2 id="5225" class="nj lt iu bd lu ok ol dn ly om on dp mc le oo op me li oq or mg lm os ot mi ou bi translated">添加库和样式表</h2><p id="1fab" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">首先，我们要将编译好的文件复制到Angular app中。进入shaka-player的<code class="fe nt nu nv nf b">dist</code>文件夹，将<code class="fe nt nu nv nf b">shaka-player.ui.debug.js</code>和<code class="fe nt nu nv nf b">controls.css</code>复制到angular app的<code class="fe nt nu nv nf b">src</code>文件夹。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ov"><img src="../Images/80b7ad75b7a85b87451423e2a1ae831e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-O7C9f2-Q57ETLMS6a83g.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">shaka-player.ui.debug.js和controls.css复制到Angular app的src文件夹中</p></figure><p id="de5b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">现在我们必须告诉Angular使用这个脚本和样式表。我们将两个文件都添加到angular.json中，将<code class="fe nt nu nv nf b">“src/controls.css”</code>添加到<code class="fe nt nu nv nf b">styles</code>数组中，将<code class="fe nt nu nv nf b">“src/shaka-player-ui.debug.js”</code>添加到<code class="fe nt nu nv nf b">scripts</code>数组中。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ow"><img src="../Images/d84d89e1ddb0e486616de5e99dc9d1fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zRCLvdOuB3RGAOwcDY8mIg.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">向Angular.json添加control.css和shaka-player.ui.debug.js</p></figure><p id="993d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这确保了Angular应用程序可以使用沙加播放器库和样式。</p><h2 id="1d00" class="nj lt iu bd lu ok ol dn ly om on dp mc le oo op me li oq or mg lm os ot mi ou bi translated">初始化播放器</h2><p id="79b6" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">在我们能使用播放器之前，我们必须初始化它。我们必须改变shaka-player组件的HTML。从<code class="fe nt nu nv nf b">shaka-player-component.html</code>中删除<code class="fe nt nu nv nf b">&lt;p&gt;shaka-player works!&lt;/p&gt;</code>，并替换为以下HTML:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ox oy l"/></div><p class="np nq gk gi gj nr ns bd b be z dk translated">创建视频和视频容器元素</p></figure><p id="bfc4" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们创建了一个由<code class="fe nt nu nv nf b">div</code>包装的<code class="fe nt nu nv nf b">video</code>元素。这是沙加播放器的UI库所期望的结构。让我们看看如何通过实现<code class="fe nt nu nv nf b">shaka-player.component.ts</code>来激活沙加播放器:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ox oy l"/></div><p class="np nq gk gi gj nr ns bd b be z dk translated">激活沙加播放器库</p></figure><p id="9726" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在行<code class="fe nt nu nv nf b">10</code>和<code class="fe nt nu nv nf b">11</code>上，我们使用<code class="fe nt nu nv nf b"><a class="ae lr" href="http://twitter.com/ViewChild" rel="noopener ugc nofollow" target="_blank">@ViewChild</a></code>通过给定的选择器查询视图。执行完这些语句后，<code class="fe nt nu nv nf b">videoElementRef</code>包含对视频元素的引用，而<code class="fe nt nu nv nf b">videoContainerRef</code>包含对包装视频元素的div的引用。</p><p id="2e90" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在第<code class="fe nt nu nv nf b">20</code>行，在<code class="fe nt nu nv nf b">ngAfterViewInit</code>中，我们调用<code class="fe nt nu nv nf b">shaka.polyfill.installAll()</code>。这修补了所有浏览器的不兼容性。</p><p id="da9c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">然后在行<code class="fe nt nu nv nf b">22</code>和<code class="fe nt nu nv nf b">23</code>上，我们得到隐藏在<code class="fe nt nu nv nf b">ElementRef</code>内部的<code class="fe nt nu nv nf b">nativeElement</code>。我们将使用这些来配置<code class="fe nt nu nv nf b">initPlayer()</code>中的UI。这个方法负责配置UI和开始回放。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ox oy l"/></div><p class="np nq gk gi gj nr ns bd b be z dk translated">initPlayer创建沙加播放器，加载并启动视频</p></figure><p id="082c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在<code class="fe nt nu nv nf b">initPlayer</code>的第<code class="fe nt nu nv nf b">2</code>行上发生的第一件事是它创建了shaka播放器。然后，在第<code class="fe nt nu nv nf b">4</code>行，它通过传入播放器、视频容器元素和视频元素来覆盖UI。</p><p id="c8d8" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在第<code class="fe nt nu nv nf b">10</code>行，我们加载电影T <a class="ae lr" href="https://mango.blender.org/" rel="noopener ugc nofollow" target="_blank">的MPEG-DASH流，如果成功，就开始回放。</a></p><p id="b662" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果你用<code class="fe nt nu nv nf b">ng serve -o</code>再次启动应用程序，它应该会打开一个浏览器并开始播放视频。您应该有几个控件来控制电影的回放，如播放、暂停、分辨率和音量。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oz"><img src="../Images/71cd420cfec0788ef69c02956d551e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NsJHEDz1QJQfpvqy53t3Bg.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">沙加玩家播放开源电影<a class="ae lr" href="https://mango.blender.org/" rel="noopener ugc nofollow" target="_blank">钢铁之泪</a></p></figure><h1 id="b5e3" class="ls lt iu bd lu lv lw lx ly lz ma mb mc ka md kb me kd mf ke mg kg mh kh mi mj bi translated">沙加玩家主题</h1><p id="7809" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">来自瑞典的阿米莉娅·桑帕斯为《沙加玩家》创作了几个伟大的主题。我们将使用阿姆斯特丹-酸性蓝主题。你可以从这个页面下载主题。</p><p id="5bdd" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">当你下载主题时，你会得到一个包含JavaScript和CSS文件的zip文件。在我们的例子中，我们得到了<code class="fe nt nu nv nf b">amsterdam-acid-blue.js</code>和<code class="fe nt nu nv nf b">amsterdam-acid-blue.css</code>。</p><p id="8efb" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们将这两个文件复制到angular应用程序的<code class="fe nt nu nv nf b">src</code>文件夹中，就像我们之前处理shaka播放器文件一样。同样，我们将它们添加到<code class="fe nt nu nv nf b">angular.json</code>中的<code class="fe nt nu nv nf b">scripts</code>和<code class="fe nt nu nv nf b">styles</code>数组中。</p><p id="5fc8" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">最后，我们将<code class="fe nt nu nv nf b">class=”amsterdam-acid-blue”</code>添加到视频容器<code class="fe nt nu nv nf b">div</code>元素中，如下所示:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ox oy l"/></div><p class="np nq gk gi gj nr ns bd b be z dk translated">向容器div元素添加amsterdam-acid-blue类</p></figure><p id="08d6" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">当我们重新加载应用程序时，我们看到阿姆斯特丹酸性蓝主题是活跃的</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pa"><img src="../Images/65c88a4213bc8b1b7e2cb3752392b71e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uCq_uqhVhEo0FCHjGEuQbw.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">在沙加播放器上显示阿姆斯特丹酸性蓝主题</p></figure><h1 id="4be7" class="ls lt iu bd lu lv lw lx ly lz ma mb mc ka md kb me kd mf ke mg kg mh kh mi mj bi translated">HLS和DASH回放</h1><p id="d8b6" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">我们用来测试回放的电影使用MPEG-DASH格式。这意味着，如果你在Windows或macOS上使用Chrome，它将正确播放视频。</p><p id="053e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">但是，如果您在iOS设备上播放视频或使用Safari，视频将不会播放。这是因为iOS上的Safari不支持MPEG-DASH——你需要HLS格式的视频。</p><p id="ba7a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">沙加播放器支持破折号和HLS播放。我们必须根据平台选择正确的视频。我们导入Angular Platform模块，并使用它来检测Safari:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ox oy l"/></div><p class="np nq gk gi gj nr ns bd b be z dk translated">使用角度平台模块来检测我们是否在Safari上运行</p></figure><h1 id="29cb" class="ls lt iu bd lu lv lw lx ly lz ma mb mc ka md kb me kd mf ke mg kg mh kh mi mj bi translated">添加和选择字幕</h1><p id="6738" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">沙加播放器支持字幕。如果字幕嵌入在DASH或HLS流中，您可以直接使用它们。如果您有单独的字幕文件，您可以使用以下源代码添加它们:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ox oy l"/></div><p class="np nq gk gi gj nr ns bd b be z dk translated">加载并选择字幕</p></figure><p id="eb44" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">视频加载后，我们使用第<code class="fe nt nu nv nf b">5</code>行的<code class="fe nt nu nv nf b">addTextTrackAsync</code>来添加字幕。在行<code class="fe nt nu nv nf b">6</code>到<code class="fe nt nu nv nf b">10</code>上，我们选择字幕轨道。如果我们不这样做，用户必须使用标题菜单来选择标题。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pb"><img src="../Images/503f31a422b1666d36c3ccc30716cb00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kS5jOBx41mpXP0K8wGKvhw.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">沙加选手演奏钢之泪，英文字幕</p></figure><p id="92cf" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">您可以通过多次调用<code class="fe nt nu nv nf b">addTextTrackAsync</code>来添加多个字幕轨道。UI自动将字幕轨道添加到菜单中，以便用户能够选择字幕的语言。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj pb"><img src="../Images/f42ae0b133779b13668bb4afc2db5b00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lS7OlMzJDmbLMbx0ye0d6Q.png"/></div></div><p class="np nq gk gi gj nr ns bd b be z dk translated">通过沙加播放器用户界面选择字幕语言</p></figure><h1 id="3d21" class="ls lt iu bd lu lv lw lx ly lz ma mb mc ka md kb me kd mf ke mg kg mh kh mi mj bi translated">数字版权管理(DRM)</h1><p id="739a" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">沙加播放器支持以下带有DASH和/或HLS流的DRM。</p><ul class=""><li id="da53" class="mp mq iu kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">谷歌<a class="ae lr" href="http://www.widevine.com/" rel="noopener ugc nofollow" target="_blank"> Widevine </a>:破折号&amp; HLS</li><li id="4a08" class="mp mq iu kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">微软<a class="ae lr" href="https://www.microsoft.com/playready/" rel="noopener ugc nofollow" target="_blank"> PlayReady </a> : DASH</li><li id="c8ae" class="mp mq iu kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">W3C <a class="ae lr" href="https://w3c.github.io/encrypted-media/#clear-key" rel="noopener ugc nofollow" target="_blank">清除键</a>:破折号</li><li id="2f83" class="mp mq iu kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated"><a class="ae lr" href="https://developer.apple.com/streaming/fps/" rel="noopener ugc nofollow" target="_blank"> Apple FairPlay流媒体(FPS) </a> : HLS</li></ul><p id="7263" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">沙加播放器使用加密媒体扩展(EME)，这需要一个安全的网址。因此，为了测试受DRM保护的内容，有必要使用HTTPS。如果站点使用HTTPS，那么清单和每个段也需要使用HTTPS。这是因为混合的内容需求。</p><p id="6b59" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">为了指定Widevine或PlayReady的许可证服务器URL，我们使用以下代码。根据浏览器的不同，我们配置苹果Fairplay或者谷歌Widevine。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ox oy l"/></div><p class="np nq gk gi gj nr ns bd b be z dk translated">使用Fairplay时，我们需要一个带有公钥的证书。该证书在第1行接收，在第12行配置。Fairplay和Widevine都需要知道许可证服务器的位置。</p></figure><p id="41db" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Fairplay许可证服务器配置在第<code class="fe nt nu nv nf b">8</code>行。Widevine许可证服务器配置在第<code class="fe nt nu nv nf b">21</code>行。你只需要插入你的Widevine或者Fairplay许可服务器的URL。</p></div><div class="ab cl nw nx hy ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="in io ip iq ir"><h1 id="5b57" class="ls lt iu bd lu lv od lx ly lz oe mb mc ka of kb me kd og ke mg kg oh kh mi mj bi translated">结论</h1><p id="7821" class="pw-post-body-paragraph kv kw iu kx b ky mk jv la lb ml jy ld le mm lg lh li mn lk ll lm mo lo lp lq in bi translated">我们的媒体解决方案成功地从Azure Media Player迁移到了沙加播放器。事实上，沙加播放器是开源的，这是一个很大的帮助。</p><p id="2ec3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">沙加播放器包括优秀的文档，并有一个充满活力的社区，总是乐意提供帮助。您可以使用或不使用DRM来播放MPEG-DASH和HLS流。沙加播放器支持字幕和多语言音频。</p><p id="7d93" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们将沙加播放器集成到我们的Angular应用程序中。我通过PR向官方的沙加播放器Github库提交了源代码，作为展示如何将沙加播放器集成到Angular应用程序中的例子。</p><p id="850c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">假设你有一个Angular应用，在寻找一种整合媒体的方式。你应该去看看沙加玩家。这个Github库中的例子应该会给你一个好的开始。</p><p id="2aba" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>