<html>
<head>
<title>Improving Redux Reducers in 3 Ways</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从3个方面改进Redux减速器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/improving-redux-reducers-in-3-ways-bf297743b21e?source=collection_archive---------8-----------------------#2019-11-19">https://betterprogramming.pub/improving-redux-reducers-in-3-ways-bf297743b21e?source=collection_archive---------8-----------------------#2019-11-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ebf0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对象、类和函数式编程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8d68ccd6a2eb7cf4366e5ac0f0e2d640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4qm8fQbuZ3EX0hzn9cJ7HA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@isaacmsmith?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Isaac Smith </a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="897a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我假设你知道什么是Redux 以及reducers是做什么的。</p><p id="40e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将讲述如何通过提高Redux Redux reducer的速度来改进它们，以及如何避免<em class="lv">圈复杂度</em>警告/错误，当动作数量增加时，您可能会遇到类似<a class="ae ky" href="https://www.sonarqube.org/" rel="noopener ugc nofollow" target="_blank"> SonarQube </a>的情况。</p><p id="d994" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个简单的<code class="fe lw lx ly lz b">switch</code>语句，你可能在99%的Redux/reducers例子中见过。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="2aa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们要改进的方法是使用一个<code class="fe lw lx ly lz b">dictionary</code>。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="ee09" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">字典(键值对)</h1><p id="a10d" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">一个<code class="fe lw lx ly lz b">dictionary</code>只是一个简单的JavaScript对象，你可以在其中添加一个字符串值作为键，并给它赋值。</p><p id="481a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我们将要创建的内容的简化版本。注意，关键是action <code class="fe lw lx ly lz b">type</code>名称，赋值是一个函数，它将当前状态和有效负载作为参数来创建一个新状态。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="fc8b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak"> JavaScript函数式方法</strong></h1><p id="378b" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">让我们通过创建一个<code class="fe lw lx ly lz b">baseReducer</code>函数来改进字典示例，该函数将<code class="fe lw lx ly lz b">initialState</code>作为第一个参数，将字典作为第二个参数。</p><p id="337e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望下面的代码易于阅读/理解，但是基本上，我们使用动作类型常量作为函数名。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="bf76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，<code class="fe lw lx ly lz b">reducerDictionary</code>参数是传入的字典。注意这里如何使用<code class="fe lw lx ly lz b">action.type</code>，<code class="fe lw lx ly lz b">reducer[action.type]</code>，以访问正确的减速器功能。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="b572" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak"> JavaScript类方法</strong></h1><p id="8264" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">让我们通过为我们的类缩减器创建一个<code class="fe lw lx ly lz b">BaseReducer</code>类来扩展字典示例。</p><p id="c5ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面，注意如何<code class="fe lw lx ly lz b">ShowsReducer</code> <code class="fe lw lx ly lz b">extends</code> <code class="fe lw lx ly lz b">BaseReducer</code>。这是<em class="lv">继承</em>,它将一些逻辑抽象到另一个类中，因此reducers只拥有必要的东西。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="549e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你看上面的<code class="fe lw lx ly lz b">BaseReducer</code>，你会看到:</p><ul class=""><li id="9c09" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated"><code class="fe lw lx ly lz b">Line 2</code>:是当一个reducer类扩展这个<code class="fe lw lx ly lz b">BaseReducer</code>时将被覆盖的<code class="fe lw lx ly lz b">initialState</code>。</li><li id="7399" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe lw lx ly lz b">Line 4</code>:Redux将使用的reducer方法。</li><li id="9eed" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe lw lx ly lz b">Line 5</code>:获取与<code class="fe lw lx ly lz b">action.type</code>匹配的类方法。</li><li id="2f5e" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe lw lx ly lz b">Line 7</code>:如果没有找到方法(<code class="fe lw lx ly lz b">!method</code>)或者动作是错误的(<code class="fe lw lx ly lz b">action.error</code>)，则返回当前的<code class="fe lw lx ly lz b">state</code>。</li><li id="c538" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><code class="fe lw lx ly lz b">Line 11</code>:用<code class="fe lw lx ly lz b">state</code>和<code class="fe lw lx ly lz b">action</code>参数调用找到的方法，该方法将返回Redux将使用的修改后的<code class="fe lw lx ly lz b">state</code>。</li></ul></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="a6c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">为什么更快并避免了圈复杂度？</strong></p><p id="e219" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lw lx ly lz b">switch</code>语句类似于<code class="fe lw lx ly lz b">if</code>语句，其中代码检查多个语句以找到正确的一个。基本上它是检查每一个，看看是否有匹配。使用字典方法，代码可以立即获取正确的代码，因为它知道从哪个槽获取它。</p><p id="0c21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://docs.sonarqube.org/latest/user-guide/metric-definitions/" rel="noopener ugc nofollow" target="_blank">圈复杂度</a>是基于通过代码的路径数计算的。某些关键字增加了复杂性，<code class="fe lw lx ly lz b">case</code>就是其中之一。因此，当reducer中的动作数量增加时，复杂性也会增加。我正在做一个项目，其中的代码不能合并到<code class="fe lw lx ly lz b">master</code>中，除非它通过了所有的代码需求，圈复杂度是其中之一。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="cebe" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">代码示例</h1><p id="8c5b" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">如果您想看看这些代码示例的运行情况，请查阅我的另一篇文章，获取示例应用程序以及函数式方法和基于类的方法的源代码。我也有打字稿版本！</p><div class="nu nv gp gr nw nx"><a href="https://medium.com/better-programming/my-awesome-react-redux-structure-6044e5007e22" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">我的超赞反应/还原结构</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">了解如何以优雅的方式构建React/Redux应用程序</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">medium.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ks nx"/></div></div></a></div><p id="e189" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这篇文章，请分享它，关注我，阅读我的其他<a class="ae ky" href="https://medium.com/@robertsavian" rel="noopener">文章</a>和/或用我下面的推荐链接注册Medium。谢谢！</p><div class="nu nv gp gr nw nx"><a href="https://medium.com/@robertsavian/membership" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">通过我的推荐链接加入Medium—Robert S(代码带)</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">medium.com</p></div></div><div class="og l"><div class="om l oi oj ok og ol ks nx"/></div></div></a></div></div></div>    
</body>
</html>