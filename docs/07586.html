<html>
<head>
<title>Perform Speech Synthesis in Your JavaScript Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在您的JavaScript应用程序中执行语音合成</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/perform-speech-synthesis-in-your-javascript-applications-ac3efa1eb6fa?source=collection_archive---------1-----------------------#2021-01-29">https://betterprogramming.pub/perform-speech-synthesis-in-your-javascript-applications-ac3efa1eb6fa?source=collection_archive---------1-----------------------#2021-01-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0a68" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">web语音合成API的研究</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/edddd94f0f08dc9de0b5563a9f164d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Xg3v8tH6pQ5RmWOoDOwJw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者</p></figure><p id="80af" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://en.wikipedia.org/wiki/Speech_synthesis" rel="noopener ugc nofollow" target="_blank">语音合成</a>是人类语音的人工制作。用于此目的的计算机系统称为语音计算机、语音合成器或文本到语音(TTS)系统。语音合成通过连接保存在数据库中的预先录制的单词来组织句子。下图是典型TTS系统的概述:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/dc3dfcb1e97251949c846ccc30a7d303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/0*JuTCK18Kducwf25z.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:维基百科</p></figure><p id="c4d5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Web语音API使web应用程序能够处理语音数据。它们由用于语音识别和语音合成的API组成。在我们之前的文章中，我们介绍了语音识别。在这里，我们将深入研究语音合成，并给出几个将它们结合在一起的例子。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="f87b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">语音合成界面</h1><p id="d01d" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated"><code class="fe na nb nc nd b">SpeechSynthesis</code>是语音服务的控制器接口。它是一个文本到语音的组件，允许程序读出它们的文本内容。</p><p id="d1dd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打开浏览器控制台，运行下面的JavaScript代码。它需要一行代码来说话。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="b755" class="ni me it nd b gy nj nk l nl nm">speechSynthesis.speak(new SpeechSynthesisUtterance('Currently it is 3 o\'clock in the afternoon.'));</span></pre><p id="7875" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这一行代码中有三点:</p><ul class=""><li id="77fb" class="nn no it la b lb lc le lf lh np ll nq lp nr lt ns nt nu nv bi translated"><code class="fe na nb nc nd b">speechSynthesis</code>:返回<code class="fe na nb nc nd b"><a class="ae lu" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesis" rel="noopener ugc nofollow" target="_blank">SpeechSynthesis</a></code>对象的<code class="fe na nb nc nd b">window</code>对象的只读属性。</li><li id="2303" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe na nb nc nd b">SpeechSynthesisUtterance</code>:代表一个语音请求，包含内容和其他可配置的设置。</li><li id="3ffc" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe na nb nc nd b"><a class="ae lu" href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesis/speak" rel="noopener ugc nofollow" target="_blank">SpeechSynthesis.speak()</a></code>:将话语添加到话语队列的功能。新添加的话语将在任何其他话语在它被说出之前排队时被说出。发言队列中的所有发言都可以暂停、继续或取消。</li></ul><p id="571e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为什么我们需要做一个<code class="fe na nb nc nd b">SpeechSynthesisUtterance</code>对象而不是直接取一个字符串？</p><p id="866a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为这个语音发声对象可以被配置:</p><ul class=""><li id="bc41" class="nn no it la b lb lc le lf lh np ll nq lp nr lt ns nt nu nv bi translated"><code class="fe na nb nc nd b">utterance.rate</code>:设定速度，接受0.1-10之间的值。默认值为1。</li><li id="0cfd" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe na nb nc nd b">utterance.pitch</code>:设置螺距，接受0-2之间的值。默认值为1。</li><li id="93a4" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe na nb nc nd b">utterance.volume</code>:设置音量，接受0-1之间的值。默认值为1。</li><li id="33fc" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe na nb nc nd b">utterance.lang</code>:设置语言，接受<a class="ae lu" href="https://tools.ietf.org/html/bcp47" rel="noopener ugc nofollow" target="_blank"> BCP 47语言标签</a>的值。默认值为<code class="fe na nb nc nd b">en-US.</code></li><li id="ccb5" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe na nb nc nd b">utterance.text</code>:设置要说的文本，接受最多32，767个字符的字符串。如果没有在构造函数中设置文本，这是设置文本的另一种方法。</li><li id="78aa" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><code class="fe na nb nc nd b">utterance.voice</code>:从预定义列表中设置声音。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/032f9dd226af7e068c8dc511f9add945.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*Jpt_Jkxh8AfZGd1Gmc60rg.png"/></div></figure><p id="c23a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一段不同声音的视频剪辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="67af" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一个不同速率和音高的视频剪辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="3e1f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以在浏览器控制台上尝试这段JavaScript代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe od l"/></div></figure><p id="7fed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如本页<a class="ae lu" href="https://stackoverflow.com/questions/49506716/speechsynthesis-getvoices-returns-empty-array-on-windows" rel="noopener ugc nofollow" target="_blank">所述</a>，语音加载是异步执行的。当一个页面被加载时，需要一些时间来填充声音数组。我们可以使用一个拉环来确保声音在分配前被加载。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe od l"/></div></figure><p id="2681" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是浏览器兼容性表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/8ce49e91d2cefa86c5e937ec165ccdb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nwFcmPusoYnjDJsLh2-2Yw.png"/></div></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="7964" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">互动对话</h1><p id="d895" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在我们的上一篇文章中，我们用web语音API尝试了语音识别。通过在语音识别程序中加入<code class="fe na nb nc nd b">SpeechSynthesis</code>，我们就可以组织一次对话，重复程序听到的任何内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe od l"/></div></figure><p id="e424" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第12行，<code class="fe na nb nc nd b">recognition.abort()</code>代替<code class="fe na nb nc nd b">recognition.stop()</code>用于立即停止。</p><p id="73b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第27行，<code class="fe na nb nc nd b">recognition.interimResults</code>被设置为<code class="fe na nb nc nd b">false</code>。我们不希望公布中期结果。</p><p id="afff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第34行，<code class="fe na nb nc nd b">SpeechSynthesis</code>重复它识别的任何内容。</p><p id="a07e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是示例的视频剪辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="87a6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">发生了什么事？为什么节目一直说“今天是星期天”？事情是这样的:</p><p id="cc02" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们说了第一句话，然后程序重复了一遍。然后，它听到了自己的声音，又重复了一遍。</p><p id="af26" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了进行对话，我们需要非常小心。</p><p id="fead" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<a class="ae lu" href="https://medium.com/better-programming/perform-speech-recognition-in-your-javascript-applications-91367b0d0" rel="noopener">上一篇文章</a>中，我们也用<a class="ae lu" href="https://github.com/TalAter/annyang" rel="noopener ugc nofollow" target="_blank"> annyang </a>尝试过语音识别。我们使用了<code class="fe na nb nc nd b">SpeechSynthesis</code>来添加<a class="ae lu" href="https://gist.github.com/JenniferFuBook/7a40b04c9b7e13ea976988bd2c9403fe" rel="noopener ugc nofollow" target="_blank">中的回应对话。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe od l"/></div></figure><p id="ac1f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">函数表达式<code class="fe na nb nc nd b">setContent</code>创建于第25-28行。它设置显示文本并朗读文本。</p><p id="ced3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第30-43行的命令旨在避免自反馈循环:</p><ol class=""><li id="f2d2" class="nn no it la b lb lc le lf lh np ll nq lp nr lt og nt nu nv bi translated">它只听定义好的命令(annyang的特性)。</li><li id="4980" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt og nt nu nv bi translated">响应消息不匹配任何命令(开发人员的选择)。</li></ol><p id="6658" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是示例的视频剪辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d550" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">反应语音项目</h1><p id="b8bb" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">有了语音识别和语音合成，我们就可以开始构建React voice项目了——程序和用户之间的语音交互。</p><h2 id="86d1" class="ni me it bd mf oh oi dn mj oj ok dp mn lh ol om mp ll on oo mr lp op oq mt or bi translated">Artyom.js</h2><p id="bbee" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">我们提到过,<a class="ae lu" href="https://github.com/sdkcarlos/artyom.js" rel="noopener ugc nofollow" target="_blank"> Artyom </a>是另一个流行的语音库，建立在web语音API之上。它处理JavaScript语音识别和语音合成库。我们的第一次尝试是Artyom。</p><p id="91e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">和往常一样，我们从<a class="ae lu" href="https://medium.com/better-programming/10-fun-facts-about-create-react-app-eb7124aa3785" rel="noopener">创建React应用</a>开始。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="fed1" class="ni me it nd b gy nj nk l nl nm">npx create-react-app my-app</span></pre><p id="4bf7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，安装Artyom:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="a138" class="ni me it nd b gy nj nk l nl nm">npm i artyom.js</span></pre><p id="969d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以在<code class="fe na nb nc nd b">package.json</code>的<code class="fe na nb nc nd b"><a class="ae lu" href="https://medium.com/better-programming/package-jsons-dependencies-in-depth-a1f0637a3129" rel="noopener">dependencies</a></code>中看到新的包:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="ccc0" class="ni me it nd b gy nj nk l nl nm">"dependencies": {<br/>  "artyom.js": "^1.0.6"<br/>}</span></pre><p id="60f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用这个包，我们为下面的形式建立一个语音系统:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/aab7de7e5067a48c4fd869b9656d1a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*nukRYVFl0PIUYXYsxQgmtA.png"/></div></figure><p id="4836" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们修改过的<code class="fe na nb nc nd b">src/App.js</code>中的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe od l"/></div></figure><p id="cbc9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第5行，创建了Artyom对象。</p><p id="3560" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第14-24行构建了<code class="fe na nb nc nd b">onSubmit</code>回调。</p><p id="06f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">提交后，第15行检查是否有名字。如果没有名字，就写<code class="fe na nb nc nd b">‘Username is required.’</code>。提交被中止。</p><p id="bdf6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第18行检查是否有水果被选中。如果没有选择，它会显示<code class="fe na nb nc nd b">‘Please select a fruit.’</code>。提交被中止。</p><p id="8055" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">否则，提交数据。程序确认<code class="fe na nb nc nd b">‘Your data have been submitted. Thank you!’</code>。</p><p id="453a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们修改过的<code class="fe na nb nc nd b">src/App.css</code>中的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe od l"/></div></figure><p id="4e63" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是语音交谈项目的视频剪辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ot od l"/></div></figure><p id="4a76" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们给程序增加语音控制之前，它工作得很好。它经常失声。不知何故，发言队列被卡住了。调用<code class="fe na nb nc nd b">speechSynthesis.cancel()</code>可以解决这个问题，重启浏览器窗口或标签也可以。然而，这对于一个项目来说是不够的。我们在等待这个问题得到解决。</p><h2 id="e064" class="ni me it bd mf oh oi dn mj oj ok dp mn lh ol om mp ll on oo mr lp op oq mt or bi translated">安阳</h2><p id="0b60" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">让我们尝试使用Annyang和<code class="fe na nb nc nd b">SpeechSynthesis</code>构建同一个项目。</p><p id="4e46" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">安装<code class="fe na nb nc nd b">annyang.js</code>:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="199e" class="ni me it nd b gy nj nk l nl nm">npm i <!-- -->annyang.js</span></pre><p id="94a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以在<code class="fe na nb nc nd b">package.json</code>的<code class="fe na nb nc nd b"><a class="ae lu" href="https://medium.com/better-programming/package-jsons-dependencies-in-depth-a1f0637a3129" rel="noopener">dependencies</a></code>中看到新的包装:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="5d4d" class="ni me it nd b gy nj nk l nl nm">"dependencies": {<br/>  "annyang": "^2.6.1"<br/>}</span></pre><p id="f240" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们正在构建一个语音控制和说话系统，所以在UI中添加了一个控制按钮，用于启动或停止语音控制。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/78c822ea730b0ef47e08977978c93405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WykTrUkDaLNtxpx9u2WcuA.png"/></div></div></figure><p id="4b23" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们修改过的<code class="fe na nb nc nd b">src/App.js</code>中的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe od l"/></div></figure><p id="2596" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第5行，创建了一个函数表达式<code class="fe na nb nc nd b">say</code>。</p><p id="db75" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第8行引入了一个状态<code class="fe na nb nc nd b">voiceOn</code>，用于启动(第41行)或停止(第43行)语音控制。</p><p id="0b1d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第11行是控制水果选择的<code class="fe na nb nc nd b">ref</code>(第19、24和82行)。</p><p id="0c42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第12行是控制提交按钮的<code class="fe na nb nc nd b">ref</code>(第29和92行)。</p><p id="24aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第14-32行运行一次性<code class="fe na nb nc nd b">useEffect</code>来创建Annyang中的语音命令。</p><p id="4e39" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第34-45行运行<code class="fe na nb nc nd b">useEffect</code>来处理<code class="fe na nb nc nd b">voiceOn</code>状态变化。</p><p id="c38f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第49-52行构建了语音开关按钮。</p><p id="5036" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第59行将错误响应从<code class="fe na nb nc nd b">‘Username is required.’</code>更改为<code class="fe na nb nc nd b">‘First field is required.’</code>。我们必须对将要说的话非常小心。否则，程序会根据第16行的规则将<code class="fe na nb nc nd b">required</code>识别为用户名。</p><p id="f86f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">类似地，第62行将错误响应从<code class="fe na nb nc nd b">‘Please select a fruit.’</code>更改为<code class="fe na nb nc nd b">‘Second field is required.’</code>。</p><p id="6661" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所见，<code class="fe na nb nc nd b">ref</code>可以方便地手动触发事件，比如单击提交按钮。然而，手动触发选择的下拉菜单有点棘手。我们使用了一个黑客来设置<code class="fe na nb nc nd b">choiceRef.current.size</code>。很管用，虽然风格有点不一样。下拉样式可以通过CSS修复，但是我们的建议是使用<a class="ae lu" href="https://medium.com/better-programming/react-select-makes-creating-selectable-menus-easy-5d9dffc7e0d9" rel="noopener"> React-Select </a>。</p><p id="4713" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我们修改过的<code class="fe na nb nc nd b">src/App.css</code>中的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe od l"/></div></figure><p id="cd2e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是语音控制和语音通话体验的视频剪辑:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ot od l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="1311" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">结论</h1><p id="d65f" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">之前，我们探讨了语音识别。在本文中，我们讨论了语音合成，并构建了语音控制和说话系统的例子。Chrome对web语音API的支持最好。我们所有的例子都是在Chrome浏览器上实现和测试的。</p><p id="3805" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有时，语音识别程序可能不理解我们的语言。再说一遍，慢慢地，清楚地。耐心点，网络之声正在成长，一天比一天好。</p><p id="cfcd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢Shraddha Chadha和Jonathan Ma让我对这个领域感兴趣。这项工作的一部分包括乔纳森马的贡献。</p><p id="feea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。我希望这有所帮助。你可以在这里看到我的其他媒体出版物<a class="ae lu" href="https://medium.com/@jenniferfubook/jennifer-fus-web-development-publications-1a887e4454af" rel="noopener">。</a></p></div></div>    
</body>
</html>