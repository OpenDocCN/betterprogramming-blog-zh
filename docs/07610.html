<html>
<head>
<title>Write Vue Like You Write React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像写反应一样写Vue</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/write-vue-like-you-write-react-545eafb60e6a?source=collection_archive---------16-----------------------#2021-02-01">https://betterprogramming.pub/write-vue-like-you-write-react-545eafb60e6a?source=collection_archive---------16-----------------------#2021-02-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b183" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在有状态组件中利用无状态解决方案</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/751ae86acda98f5b6239e2eee188f960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XVFcm0b2SEsa_OAV.png"/></div></div></figure><p id="5bce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用Vue 3组合API，您可以编写功能组件。也可以用React，但是React有不同的模板:JSX。如果我们用JSX模板写Vue功能组件会怎么样？它们类似于反应功能组件吗？</p><p id="ea66" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们看看每个框架的功能组件是如何工作的，以及它们有多少相似/不同之处。我们将为此使用的组件是一个计数器，它对按钮上的点击进行计数。此外，它还接收一个限制参数—当达到该限制时，组件会通知其父组件。</p><p id="7725" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将首先创建React组件，然后查看Vue的等效组件。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="f4cc" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">反应</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="4b18" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">React需要一个普通的JavaScript函数返回一个JSX模板来创建一个组件。每当组件的状态改变时，该函数重新运行。您可以用<code class="fe mr ms mt mu b">useState</code>方法创建这样的状态。状态变量是普通的JavaScript结构，在两次重新运行之间保存值。在状态变化之间，所有其他变量都会丢失。你可以在函数的顶部用一个<code class="fe mr ms mt mu b">console.log</code>语句来测试它。</p><p id="421d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该组件有一个限制和一个可用于通知父组件的方法。每当当前值增加时，我们都要检查它。<code class="fe mr ms mt mu b">useEffect</code>函数充当检查器，每当第二个参数中的依赖关系发生变化时，它就运行回调。</p><p id="de3c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">简而言之:React组件是一个普通的函数，具有普通的JavaScript状态值，在每次状态改变时重新运行并返回JSX。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="2465" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">某视频剪辑软件</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="842b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Vue中的普通函数等同于组件对象中的<code class="fe mr ms mt mu b">setup</code>方法。<code class="fe mr ms mt mu b">setup</code>方法也接收<code class="fe mr ms mt mu b">props</code>作为输入参数，但是它返回一个返回JSX的函数，而不是JSX。你可能想知道为什么…</p><p id="3fd5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">原因是<code class="fe mr ms mt mu b">setup</code>函数只运行一次，并且只有返回的函数在状态改变时运行。但是如果<code class="fe mr ms mt mu b">setup</code>函数只运行一次，Vue怎么检测变化呢？诀窍在于Vue的反应系统。<code class="fe mr ms mt mu b">ref</code>函数将原始值包装在JavaScript <code class="fe mr ms mt mu b">Proxy</code>对象中。每个修改都通过这个代理运行，它通知Vue重新呈现那个组件。如果我们直接修改原始值，框架会忽略这个变化。</p><p id="4312" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">limit和notifier函数作为函数参数出现，但是在Vue中我们没有使用析构。原因是<code class="fe mr ms mt mu b">props</code>也是一个代理对象，如果我们析构它，我们就失去了它的反应性(如果它改变了，什么也不会发生)。为了检查值的变化，我们必须使用<code class="fe mr ms mt mu b">useEffect</code>函数。与React相反，我们不必定义被监视的依赖项——Vue会自动定义，因为它知道我们在回调中使用了哪些状态变量(<code class="fe mr ms mt mu b">Proxies</code>)。</p><p id="283e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于Vue开发人员来说，使用函数而不是事件来通知父节点可能并不常见。有人说这是Vue中的反模式，但为了让它尽可能接近反应，我选择了这种方式。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="52ba" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">摘要</h1><p id="9cab" class="pw-post-body-paragraph ku kv it kw b kx mv ju kz la mw jx lc ld mx lf lg lh my lj lk ll mz ln lo lp im bi translated">两种框架都可以创建具有单一功能的组件。Vue功能组件是一个状态值包装在代理中的函数，它只运行一次，只有返回的函数重新运行并返回JSX。React功能组件是一个具有普通Javascript结构的状态值的函数，它在每次状态改变时重新运行，并直接返回JSX。</p><p id="0058" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">区别在于每个框架解决反应性问题的方式。React是无状态引用比较解决方案，Vue是基于代理的有状态解决方案。</p><p id="c0ee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">尝试用尽可能相似的方法在不同的框架中编写相同的组件是一个有趣的实验。我希望你也会觉得有趣。你也可以在我的<a class="ae na" href="https://github.com/blacksonic/vue-3-playground" rel="noopener ugc nofollow" target="_blank"> Vue 3 Vite游乐场</a>试一试。</p></div></div>    
</body>
</html>