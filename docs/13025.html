<html>
<head>
<title>Build the Apple Calculator in SwiftUI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在SwiftUI中构建苹果计算器</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-the-apple-calculator-in-swiftui-2fad61285dc8?source=collection_archive---------0-----------------------#2022-07-20">https://betterprogramming.pub/build-the-apple-calculator-in-swiftui-2fad61285dc8?source=collection_archive---------0-----------------------#2022-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7053" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">第1部分—视图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0b6d295fd67a0c63d8b387bc11cd1a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5cm-w-qzn1IH2v7O7R-ZVw.png"/></div></div></figure><p id="3fa7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这个系列教程中，我们将从头开始构建苹果计算器。该计算器将按照最佳实践进行开发。如果你是一个初学者，这很好，因为你将开始学习一些新的有挑战性的概念，这将使你成为一个更好的开发者。如果您是中级用户，本教程将帮助您掌握构建可扩展和可维护的SwiftUI应用程序的一些重要实践。</p><p id="9155" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本教程中，我们将从构建视图开始。</p><p id="c0e2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">视图是应用程序中最重要的部分之一，因为视图是用户看到并与之交互的东西。视图也是代码中最有可能随时间变化的部分，因此构建一个结构良好的视图对于可维护性来说是必不可少的。</p><p id="dc6a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将按照一些最佳实践来组织和维护我们的视图，尽可能接近地重新创建苹果计算器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c46e07cad432bf562b87bc10a6d828aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lDOP01a49JO0a7cP0DG8Xw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">成品</p></figure><h1 id="1796" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">创建新项目</h1><p id="fc8d" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">创建新的iOS应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/b911ba8046fe5551686e9c50f6efecb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sgDCOJ1jW7hWXKqoqMJuXA.png"/></div></div></figure><p id="7266" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">输入<code class="fe ms mt mu mv b">Calculator</code>作为产品名称，并确保选择<code class="fe ms mt mu mv b">SwiftUI</code>作为您的界面。取消底部的所有复选框，我们现在不需要这些功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/a45778b8f86ae95df6103fdaf809edc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MbiWa0H4qDnj30IHx7YnKw.png"/></div></div></figure><h1 id="675e" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">规划你的视野</h1><p id="08ef" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">好极了。我们有我们的项目，让我们开始编码。但是等等！如果我们不知道我们将构建什么，我们如何开始编码呢？</p><p id="0730" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我怎么强调这一点都不为过。在建造任何东西之前，先做好计划。</p><p id="516c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当构建视图时，确保你有某种参考来处理你要构建的内容。这可以是任何东西，从画得很差的草图到像素完美的模型。任何你可以回头去看并给你一个结果应该是什么样子的想法的东西都是好的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/6b731c496d68c4f0805dade2ab4d6a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ktnyl5bcjHyOS7ocs2RsA.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">请随意使用我做的这个模型作为参考</p></figure><p id="ac65" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">幸运的是，我们不是从零开始设计我们的视图，因为我们正在构建一个已经存在的应用程序的再造(用于教育目的)。我们可以在iOS设备上打开计算器应用程序来查看参考资料。</p><p id="2d89" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好了，现在我们需要开始考虑在编写任何代码之前如何放置我们的视图。</p><h2 id="4970" class="my lv it bd lw mz na dn ma nb nc dp me ld nd ne mg lh nf ng mi ll nh ni mk nj bi translated">解构一个观点</h2><p id="fb90" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">这一步对于计划和了解我们如何在代码中实现我们的视图是必不可少的。</p><p id="1e51" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">目标是将视图分解成简单的组件。</p><p id="0370" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当解构一个大的复杂视图时，总是试着把一切都想象成一个<em class="nk">容器</em>。从外部(一般分组)开始，慢慢地向内部推进，直到到达简单的组件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/3b77ab4805f1a0ad212e86e2a6fc9e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IbPi-acQ5xvtFwgkUc_a8Q.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">集装箱中的集装箱</p></figure><p id="fc53" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">记住，实现视图有一千种方法。这是我的实现，我认为这是最简单的方法。</p><p id="772f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以，回到我之前提到的解构视图——在最外层的<code class="fe ms mt mu mv b">CalculatorView</code>,我们可以想象一个包含3个组件的<code class="fe ms mt mu mv b">VStack</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/238cbd268424eca574171e42da32b54a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NyevfJmh8MUn7r0Yxwoh5Q.png"/></div></div></figure><p id="128e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ms mt mu mv b">Spacer</code>和<code class="fe ms mt mu mv b">DisplayText</code>已经被解构为最简单的形式(一个<code class="fe ms mt mu mv b">Spacer</code>和一个<code class="fe ms mt mu mv b">Text</code>)，然而，按钮板有很多额外的复杂性需要我们解构。让我们看看我们能想出什么。</p><p id="5f76" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">只关注<code class="fe ms mt mu mv b">ButtonPad</code>，好像它是唯一存在的视角。这是一个非常重要的工程原理；把问题分解成更容易理解的子问题。我们将在整个系列中应用这一原则。</p><p id="748d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在可以看到，另一个<code class="fe ms mt mu mv b">VStack</code>(它的间距比它的父视图小)包含多个堆栈视图。每个<code class="fe ms mt mu mv b">HStack</code>包含3或4个<code class="fe ms mt mu mv b">Button</code>视图。<code class="fe ms mt mu mv b">Button</code>是我们能做到的最简单的形式，所以我们完成了！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a38c655f3252a9fa6690541afb775771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*406wxQeEgITrvGEDBRupJw.png"/></div></div></figure><p id="8eff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们已经完全解构了苹果的计算器观。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/72e98abdcf05da554987ce59a348d810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i76pThFzzZSAXJ8c5991EA.png"/></div></div></figure><h1 id="f714" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">让我们开始编码吧</h1><p id="d605" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">太好了，我们已经成功地解构了视图，现在我们对实现的样子有了一个概念。</p><p id="bec8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在将开始构建视图。</p><h2 id="1bd3" class="my lv it bd lw mz na dn ma nb nc dp me ld nd ne mg lh nf ng mi ll nh ni mk nj bi translated">构建视图</h2><p id="cf4e" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">构建视图不再是规划阶段的一部分。—我们现在正在构建实际的应用程序。</p><p id="d034" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了构建一个复杂的视图，我们将应用同样的原则，将问题分解成更小、更容易理解的子问题。你可以从最里面的一层开始，然后一步一步来，或者你可以从最外面的一层开始，然后一步一步来。</p><p id="a106" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我喜欢把两者结合起来使用，因为它让我看到了全局，同时让我专注于较小的细节。</p><h2 id="49fa" class="my lv it bd lw mz na dn ma nb nc dp me ld nd ne mg lh nf ng mi ll nh ni mk nj bi translated">创建计算器视图</h2><p id="b01f" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">创建一个新的<code class="fe ms mt mu mv b">SwiftUI View</code>并保存为<code class="fe ms mt mu mv b">CalculatorView</code></p><div class="kj kk kl km gt ab cb"><figure class="nl kn nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/adb5a03285c6cb991ea600a5937cc699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*jT2Vlt6G0K0zQGCk5BGENQ.png"/></div></figure><figure class="nl kn nr nn no np nq paragraph-image"><img src="../Images/20b74390d9fd1fd9c3dc787ac9ca7c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*wIcbxXQOm7J_ZI6g6A-IhQ.png"/></figure></div><p id="7ec6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将使用<code class="fe ms mt mu mv b">CalculatorView</code>作为我们的主视图，所以继续删除<code class="fe ms mt mu mv b">ContentView</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/e46675489a6c54a6946a5ad62b2d5ca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*_fJRq7dmplzsHQlgrvdDQA.png"/></div></figure><p id="2bfb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe ms mt mu mv b">CalculatorApp</code>文件中，将行<code class="fe ms mt mu mv b">ContentView()</code>改为<code class="fe ms mt mu mv b">CalculatorView()</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e5aa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将从创建最外面的最简单形式的<code class="fe ms mt mu mv b">VStack</code>开始。</p><p id="9dfc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">添加一个带有<code class="fe ms mt mu mv b">Spacer</code>和<code class="fe ms mt mu mv b">Text</code>视图的<code class="fe ms mt mu mv b">VStack</code>。——我们以后再担心<code class="fe ms mt mu mv b">ButtonPad</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f577178d62fd36ca8ae44e4f8e3d95bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0SrgifyLL2q-2ELLRioC6g.png"/></div></div></figure><p id="0ace" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们正试图把这个问题分解成更小的子问题。对于我们的下一个目标，我们将设计<code class="fe ms mt mu mv b">displayText</code>。首先，改变背景颜色。</p><p id="77ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将<code class="fe ms mt mu mv b">.background(Color.black)</code>修改器添加到<code class="fe ms mt mu mv b">VStack</code>中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/570de3318c98e30969ce3b7d7a5e2abf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4ajeBVkSMQoELNsvvR7KA.png"/></div></div></figure><p id="4b67" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你会看到我们的视图现在包含一个奇怪的线。我们会解决这个问题，但是首先，背景颜色和我们的<code class="fe ms mt mu mv b">displayText</code>一样，所以我们看不到它。</p><p id="254a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe ms mt mu mv b">Text(“0”)</code>下添加以下修饰符:</p><pre class="kj kk kl km gt nv mv nw nx aw ny bi"><span id="b4a3" class="my lv it mv b gy nz oa l ob oc">.foregroundColor(.white)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/1dd4c6a9acfb959ee4e289c26cabaa0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*L6AD9TYHdjHVuwdfhg2LDA.png"/></div></figure><p id="165b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因为<code class="fe ms mt mu mv b">Text</code>没有全屏宽度，所以<code class="fe ms mt mu mv b">VStack</code>很薄。让我们让文本框架占据整个屏幕宽度，并确保文本优先于它的位置。trailing = right，。前导=左)。</p><p id="e512" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">给<code class="fe ms mt mu mv b">Text</code>加上以下修饰语:</p><pre class="kj kk kl km gt nv mv nw nx aw ny bi"><span id="cb4a" class="my lv it mv b gy nz oa l ob oc">.frame(maxWidth: .infinity, alignment: .trailing)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cbd7245e3d3b1c43fefec346222866ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gdDqwmoK7ig4oNU6m59F6w.png"/></div></div></figure><p id="dcb5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完美！我们正在接近。<code class="fe ms mt mu mv b">displayText</code>的布局差不多完成了。然而，字体看起来一点也不像最终产品。让我们更新字体。</p><p id="6f46" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">向<code class="fe ms mt mu mv b">Text</code>添加以下修饰符:</p><p id="4cb5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ms mt mu mv b">.font(.system(size: 88, weight: .light))</code></p><p id="59c1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，注意在真正的计算器应用程序中，当显示大数字时，文本是如何收缩的？那是另一个叫做<code class="fe ms mt mu mv b">minimumScaleFactor</code>的修改器。如果有必要，它会缩小视图，并且您可以设置视图可以缩小多少的限制。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/ef200ddd2b987791603021aa61c1cf35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*npsvQWoREdvTK6GzZMkgrg.png"/></div></div></figure><p id="5a82" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">默认情况下，如果<code class="fe ms mt mu mv b">Text</code>达到其宽度限制，它将自动占据下一行。我们希望将显示文本限制为一行，这样我们就可以缩小文本。<code class="fe ms mt mu mv b">lineLimit</code>修改器让我们做到了这一点。</p><p id="ca57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">向<code class="fe ms mt mu mv b">Text</code>添加以下修改符:</p><pre class="kj kk kl km gt nv mv nw nx aw ny bi"><span id="1df5" class="my lv it mv b gy nz oa l ob oc">.lineLimit(1)</span><span id="b217" class="my lv it mv b gy of oa l ob oc">.minimumScaleFactor(0.2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/847965d0f14f9f15a771f179dd2a7277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hPeT9wlt5IRBaX1Njuz2ZQ.png"/></div></div></figure><p id="ea6f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，添加<code class="fe ms mt mu mv b">.padding()</code>作为第一个修改器，我们就完成了<code class="fe ms mt mu mv b">displayText</code>的制作。</p><p id="380f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">重要:记住修饰词是按顺序应用的，所以顺序很重要。</p><p id="ef65" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是迄今为止完整的示例代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c4d39c67c8578def559906070f804ecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eYuCsl5bAYVA6Y5uI2-ifg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">完成显示文本的计算器视图</p></figure><h1 id="7d5c" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">创建计算器按钮</h1><p id="575c" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">我们现在将开始创建<code class="fe ms mt mu mv b">ButtonPad</code>。</p><p id="ad2d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">回到我们的视图的解构，对于<code class="fe ms mt mu mv b">ButtonPad</code>我们有一个<code class="fe ms mt mu mv b">VStack</code>，它包含5个<code class="fe ms mt mu mv b">HStack</code>视图，其中有3到4个<code class="fe ms mt mu mv b">Button</code>视图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/f9a9f953bb0356f858a6705a16193259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S0WlpGA73f8SjCFWMySb4A.png"/></div></div></figure><p id="285e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">总共有19个按钮。我们不打算为计算器显式编码19个独特的按钮。我们必须为每一个设置自定义标题、前景色、背景色和宽度！真是浪费时间。</p><p id="61fa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">解决办法？—枚举。</p><h1 id="4a89" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">按钮类型模型</h1><p id="54a8" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">我们将创建一个<code class="fe ms mt mu mv b">ButtonType</code>枚举来做4件事。</p><ol class=""><li id="0659" class="oh oi it kw b kx ky la lb ld oj lh ok ll ol lp om on oo op bi translated">区分不同的按钮。(咄…)</li><li id="2a8c" class="oh oi it kw b kx oq la or ld os lh ot ll ou lp om on oo op bi translated">获取其对应的按钮文本</li><li id="91e2" class="oh oi it kw b kx oq la or ld os lh ot ll ou lp om on oo op bi translated">获取其对应的前景色</li><li id="580d" class="oh oi it kw b kx oq la or ld os lh ot ll ou lp om on oo op bi translated">获取其对应的背景颜色</li></ol><p id="f0fe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">创建一个名为<code class="fe ms mt mu mv b">ButtonType.swift</code>的新Swift文件，并添加一个名为<code class="fe ms mt mu mv b">ButtonType</code>的enum。将您在屏幕上看到的所有按钮类型添加为可能的案例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">注:案例。全部清除。清除占据相同的按钮位置并根据需要显示在屏幕上。然而，它们是不同类型的按钮。</p></figure><p id="9109" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在是开始构建我们项目的好时机。</p><p id="4afb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">创建一个名为<code class="fe ms mt mu mv b">Models</code>的新组，并将<code class="fe ms mt mu mv b">ButtonType</code>移入。创建另一个名为<code class="fe ms mt mu mv b">Views</code>的组，并将<code class="fe ms mt mu mv b">CalculatorView</code>移入。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/f5d39d31c634af70fbd284acc65ada54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1YNlzzimF5EpTTC5XTt9tA.png"/></div></div></figure><p id="5f73" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在有了所有可能的情况。然而，我们可以做得更好。让我们通过分组这些情况来简化。</p><p id="d7cc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数字有10种情况(。零，。一，。二…九个)并且有4种情况用于算术运算(。加法，。减法，。乘法和。司)。</p><p id="1253" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将这些案例归入它们自己的枚举是一个好主意，因为它们在功能(例如:数字可以组合成数字)和设计(例如:数字有灰色背景)方面有相似之处。</p><p id="a8bf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe ms mt mu mv b">Models</code>组中，创建一个名为<code class="fe ms mt mu mv b">Digit</code>的新Swift文件和另一个名为<code class="fe ms mt mu mv b">ArithmeticOperation</code>的文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/88039594b92d0b70e894136836f90051.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*W3qnDIJH-TnthWL8DPFBtA.png"/></div></figure><p id="edd0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为<code class="fe ms mt mu mv b">Digit</code>创建一个枚举并传递所有相应的事例。我们将创建这个类型为<code class="fe ms mt mu mv b">Int</code>的枚举，因为它将允许我们通过使用它的<code class="fe ms mt mu mv b">rawValue</code>属性来获取它的值。</p><p id="3481" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使它符合<code class="fe ms mt mu mv b">CaseIterable</code>协议，这样我们就可以很容易地使用它的属性<code class="fe ms mt mu mv b">Digit.allCases</code>获得所有案例的有序数组。</p><p id="54a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使其符合<code class="fe ms mt mu mv b">CustomStringConvertible</code>。该协议要求您添加<code class="fe ms mt mu mv b">description</code>属性。我们将使用它作为按钮文本。</p><p id="17d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="6de2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">类似地，创建一个<code class="fe ms mt mu mv b">ArithmeticOperation</code>枚举并添加以下代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="2421" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">回到我们的<code class="fe ms mt mu mv b">ButtonType</code>枚举，我们现在可以封装大量的案例。</p><p id="84bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">添加<code class="fe ms mt mu mv b">digit</code>和<code class="fe ms mt mu mv b">operation</code>案例及其相应的枚举作为关联值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="140f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们几乎完成了我们的模型！</p><p id="04f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使<code class="fe ms mt mu mv b">ButtonType</code>符合<code class="fe ms mt mu mv b">Hashable</code>协议。这个协议将让我们稍后迭代一组ButtonTypes。</p><p id="7030" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让它也符合这里的<code class="fe ms mt mu mv b">CustomStringConvertible</code>协议。如前所述，我们将使用description属性来显示相应的按钮文本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">带有协议的ButtonType枚举</p></figure><p id="8661" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在有一个文本描述来显示所有不同的<code class="fe ms mt mu mv b">ButtonTypes</code>。然而，我们缺少一种方法来获得相应的背景和前景颜色。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/78cac49f0bfbc02fc545f9af984ef549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNWIqYH7UI9ImLqDy5U0Hw.png"/></div></div></figure><p id="b9c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在顶部添加<code class="fe ms mt mu mv b">import SwiftUI</code>，因为我们需要引用<code class="fe ms mt mu mv b">Color</code></p><p id="8d3d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">创建两个名为<code class="fe ms mt mu mv b">backgroundColor</code>和<code class="fe ms mt mu mv b">foregroundColor</code>的<code class="fe ms mt mu mv b">Color</code>类型的计算属性，并返回其案例的相应颜色。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">ButtonType完成示例</p></figure><p id="e4b0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们终于完成了我们的<code class="fe ms mt mu mv b">ButtonType</code>模型！现在我们已经有了构建按钮板的所有必要信息，该按钮板包含带有相应文本、背景色和前景色的按钮。</p><p id="dc6b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我们开始构建ButtonPad视图时，一切都会变得更有意义。</p><h1 id="ea83" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">构建按钮板</h1><p id="b4a4" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">很好，我们有了包含所有计算器按钮类型的<code class="fe ms mt mu mv b">ButtonType</code>枚举。问题？—还没有订单。</p><p id="952c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">按钮的显示顺序是视图的责任，而不是模型的责任。因此，让我们回到我们的<code class="fe ms mt mu mv b">CalculatorView</code>并添加一个新的<code class="fe ms mt mu mv b">buttonTypes</code>二维数组，其中包含正确的按钮类型顺序。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">表示按钮板的行和列的二维数组</p></figure><p id="717c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们有了一个顺序为<code class="fe ms mt mu mv b">ButtonType</code>的二维数组，我们将开始构建<code class="fe ms mt mu mv b">ButtonPad</code>。我们需要创建一个<code class="fe ms mt mu mv b">VStack</code>及其相应的<code class="fe ms mt mu mv b">HStack</code>视图，并在每个<code class="fe ms mt mu mv b">Button</code>中创建。</p><p id="4add" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">用以下代码替换<code class="fe ms mt mu mv b">// TODO: ButtonPad</code>行</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/40ff3744ac0023e842cb395d2c93b937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fd4rIAbjagniRc64AZAQxw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">CalculatorView视图现在以正确的顺序显示按钮网格</p></figure><p id="fa05" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不要担心按钮设计，我们一会儿就开始。</p><p id="0844" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您的<code class="fe ms mt mu mv b">CalculatorView</code>文件应该是这样的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">重构前的CalculatorView视图</p></figure><p id="200f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">代码变得有点脏了，我们还远没有完成，所以让我们做一点重构，让一切变得更清晰一点。</p><p id="4f2e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">封装<code class="fe ms mt mu mv b">displayText</code>和<code class="fe ms mt mu mv b">buttonPad</code>并将其移动到<code class="fe ms mt mu mv b">CalculatorView</code>文件底部的扩展名a中</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">重构后的CalculatorView</p></figure><p id="1fc4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在代码更容易理解了。当组件开始变得有点太复杂时，我喜欢用这种方式封装它们。</p><p id="e292" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">正如我们所见，从设计角度来看，计算器按钮看起来糟透了。我们将创建一个新的<code class="fe ms mt mu mv b">CalculatorButtonStyle</code>来立即解决这个问题。</p><h2 id="2b27" class="my lv it bd lw mz na dn ma nb nc dp me ld nd ne mg lh nf ng mi ll nh ni mk nj bi translated">创建计算器按钮样式</h2><p id="14af" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">创建一个名为<code class="fe ms mt mu mv b">Styles</code>的新组，并添加一个名为<code class="fe ms mt mu mv b">CalculatorButtonStyle</code>的新Swift文件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/c2605df1f05ae5771d5d8b69fb93d2a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*91PDKUIBRRmynW3QM-srJQ.png"/></div></figure><p id="093b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将为我们的计算器按钮创建一个自定义的<code class="fe ms mt mu mv b">ButtonStyle</code>。如果你想了解更多关于创建自定义按钮样式的知识，我已经写了一个故事，你可以在这里找到它<a class="ae ox" href="https://medium.com/@ricardomongza/create-custom-button-styles-in-swiftui-f3778f695266" rel="noopener">。</a></p><p id="400b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们需要为样式设置3个属性。—按钮<code class="fe ms mt mu mv b">size</code>、<code class="fe ms mt mu mv b">foregroundColor,</code>和<code class="fe ms mt mu mv b">backgroundColor</code>。</p><p id="e242" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="7f47" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想看一下<code class="fe ms mt mu mv b">ButtonStyle</code>的现场预览，你可以在文件底部添加这段代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9a81b936d8388749ac537f10456dbf7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uWaKekgQt5vrrpp1Co-IIw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">计算器按钮样式预览</p></figure><p id="8873" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们回到我们的<code class="fe ms mt mu mv b">CalculatorView</code>文件，找到我们的<code class="fe ms mt mu mv b">buttonPad</code>属性，并用我们新创建的<code class="fe ms mt mu mv b">CalculatorButtonStyle.</code>传递相应的参数添加<code class="fe ms mt mu mv b">buttonStyle</code>修饰符。现在，使用<code class="fe ms mt mu mv b">size: 80</code>，我们将在最后计算正确的按钮大小。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">将CalculatorButtonStyle添加到现有按钮中</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/62359ff015f5533ee1963da304160c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8iKQodmrrgH2gPSVMb3jNw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">到目前为止我们的计算器视图</p></figure><h1 id="21a4" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">最终细节</h1><p id="fe5b" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">我们几乎完成了我们的<code class="fe ms mt mu mv b">CalculatorView</code>。我们只是遗漏了两个重要的细节。</p><ol class=""><li id="1a28" class="oh oi it kw b kx ky la lb ld oj lh ok ll ol lp om on oo op bi translated">我们需要计算按钮大小(去掉<code class="fe ms mt mu mv b">80</code>常量)。</li><li id="f960" class="oh oi it kw b kx oq la or ld os lh ot ll ou lp om on oo op bi translated">我们需要使“0”按钮变宽。</li></ol><h2 id="6e70" class="my lv it bd lw mz na dn ma nb nc dp me ld nd ne mg lh nf ng mi ll nh ni mk nj bi translated">小重构—计算器按钮</h2><p id="3ec2" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">在继续最后的细节之前，让我们对我们的<code class="fe ms mt mu mv b">CalculatorView</code>做一点重构，因为我们将增加一点额外的复杂性，尽可能保持我们的代码整洁是一个好主意。</p><p id="7908" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将把计算器按钮封装到它自己的结构中。</p><p id="1bcb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在视图中创建一个名为<code class="fe ms mt mu mv b">Components</code>的新组。在内部，创建一个名为<code class="fe ms mt mu mv b">CalculatorButton</code>的新SwiftUI视图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/6961adb62ffba8c8e263d5a6239f0ea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*4ItBT1Y_AX0MYsLLSEFuOw.png"/></div></figure><p id="3a9c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在较大规模的应用程序中，最好包含下面视图专用的所有组件，在我们的例子中，是由<code class="fe ms mt mu mv b">CalculatorView</code>专用的所有组件。</p><p id="3757" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一次重构，因此不会添加新功能。我们只是移动代码，让它更整洁。</p><p id="a1df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将<code class="fe ms mt mu mv b">CalculatorView</code>中的<code class="fe ms mt mu mv b">Button</code>代码剪切并粘贴到<code class="fe ms mt mu mv b">CalculatorButton</code>主体中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">之前编写的相同代码</p></figure><p id="2df3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意我是如何扩展了<code class="fe ms mt mu mv b">CalculatorView</code>并在里面添加了<code class="fe ms mt mu mv b">CalculatorButton</code>结构的？那是很好的练习。<code class="fe ms mt mu mv b">CalculatorButton</code>不会在<code class="fe ms mt mu mv b">CalculatorView</code>之外使用，所以我们可以在内部声明它。</p><p id="02a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">额外:如果您想对此视图使用预览，请添加以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="0eb4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，将我们的新<code class="fe ms mt mu mv b">CalculatorButton</code>添加到<code class="fe ms mt mu mv b">CalculatorView</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">更新的计算器视图</p></figure><p id="bb3a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这一步没有添加新的功能，但是我们的代码更加简洁。</p><h2 id="70ee" class="my lv it bd lw mz na dn ma nb nc dp me ld nd ne mg lh nf ng mi ll nh ni mk nj bi translated">计算按钮大小</h2><p id="0df3" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">现在，一点数学。为了计算按钮大小，我们需要屏幕宽度、按钮数量以及每个按钮和外部填充之间的间距总和。</p><ul class=""><li id="1ecf" class="oh oi it kw b kx ky la lb ld oj lh ok ll ol lp oz on oo op bi translated">我们可以用<code class="fe ms mt mu mv b">UIScreen.main.bound.width</code>得到屏幕宽度。✅</li><li id="35e4" class="oh oi it kw b kx oq la or ld os lh ot ll ou lp oz on oo op bi translated">按钮数很简单，每行应该有4个按钮。✅</li><li id="6972" class="oh oi it kw b kx oq la or ld os lh ot ll ou lp oz on oo op bi translated">获得间距和填充可能会有点棘手。❓</li></ul><p id="801d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们设置恒定的间距和填充。</p><p id="295f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在有一种叫做<em class="nk">的隐性</em>间隔。我们还没有在<code class="fe ms mt mu mv b">buttonPad</code>堆栈视图中<em class="nk">明确</em>设置间距量。我们也没有在<code class="fe ms mt mu mv b">CalculatorView</code>的外部设置填充，所以我们的按钮在技术上延伸到了屏幕的边缘。</p><p id="aebb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们首先设置一个恒定的间距/填充量，我们可以在整个应用程序中访问它。</p><p id="f20d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">创建一个新的Swift文件名<code class="fe ms mt mu mv b">Constants</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/224b5b3012f0ab072c3ddf8c9fbd3212.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*3jB6cvqC8cEtZj8NKYa7cw.png"/></div></figure><p id="ad8b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">导入<code class="fe ms mt mu mv b">CoreGraphics</code>(我们将引用<code class="fe ms mt mu mv b">CGFloat</code>)并创建一个静态<code class="fe ms mt mu mv b">padding</code>属性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">在较大的应用程序中，这个结构更有用</p></figure><p id="0657" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在有一个常量，<code class="fe ms mt mu mv b">padding</code>，我们可以在应用程序的任何地方使用它。</p><p id="aaae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">回到<code class="fe ms mt mu mv b">CalculatorView</code>。</p><p id="e636" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe ms mt mu mv b">.background()</code>修改器上插入设置为我们的<code class="fe ms mt mu mv b">Constants.padding</code>属性的<code class="fe ms mt mu mv b">.padding()</code>修改器</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="86f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">向下滚动到<code class="fe ms mt mu mv b">buttonPad</code>属性，设置<code class="fe ms mt mu mv b">Constants.padding</code>为<code class="fe ms mt mu mv b">VStack</code>和<code class="fe ms mt mu mv b">HStack</code>间距</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="b200" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们来计算一下<code class="fe ms mt mu mv b">buttonSize</code>。</p><p id="0456" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">转到您的<code class="fe ms mt mu mv b">CalculatorButton</code>文件，在<code class="fe ms mt mu mv b">body</code>下添加以下函数</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/b52887d73b4d5a7d02352bb1f31af4ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OKmXnIb5q8J4huUppbxc8Q.png"/></div></div></figure><p id="c82a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，将<code class="fe ms mt mu mv b">buttonStyle</code>参数中的<code class="fe ms mt mu mv b">size: 80</code>替换为<code class="fe ms mt mu mv b">size: getButtonSize()</code>。</p><p id="f93a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最终的<code class="fe ms mt mu mv b">CalculatorButton</code>代码应该是这样的</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">计算按钮大小的计算器按钮</p></figure><h2 id="95b8" class="my lv it bd lw mz na dn ma nb nc dp me ld nd ne mg lh nf ng mi ll nh ni mk nj bi translated">使“0”按钮变宽</h2><p id="ed05" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">最后细节。我们可以观察到“0”按钮与所有其他按钮在按钮形状上的差异。就目前而言，我们的<code class="fe ms mt mu mv b">CalculatorButtonStyle</code>只能将按钮设置为圆形。—让我们更新一下，这样我们就可以给“0”按钮一个宽胶囊形状。</p><p id="63b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">回到我们的<code class="fe ms mt mu mv b">CalculatorButtonStyle</code>，在<code class="fe ms mt mu mv b">foregroundColor</code>下，添加以下属性:</p><pre class="kj kk kl km gt nv mv nw nx aw ny bi"><span id="9bc0" class="my lv it mv b gy nz oa l ob oc">var isWide: Bool = false</span></pre><p id="306c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nk">注意:如果</em> <code class="fe ms mt mu mv b"><em class="nk">isWide</em></code> <em class="nk">未设置，则默认设置为</em> <code class="fe ms mt mu mv b"><em class="nk">false</em></code> <em class="nk">。</em></p><p id="c4c1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">转到<code class="fe ms mt mu mv b">makeBody</code>，在<code class="fe ms mt mu mv b">.frame()</code>修改器下添加以下修改器:</p><pre class="kj kk kl km gt nv mv nw nx aw ny bi"><span id="5084" class="my lv it mv b gy nz oa l ob oc">.frame(maxWidth: isWide ? .infinity : size, alignment: .leading)</span></pre><p id="ec46" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ms mt mu mv b">CalculatorButtonStyle</code>的最终代码应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/b01c9f9fa2602123960bca05afa94fd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-0Kr2ztmB2WnU0wo85vSg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">现在CalculatorButtonStyle允许宽按钮</p></figure><p id="d013" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，返回到<code class="fe ms mt mu mv b">CalculatorButton</code>，在<code class="fe ms mt mu mv b">CalculatorButtonStyle</code>初始化中，在<code class="fe ms mt mu mv b">foregroundColor</code>的正下方，添加以下行:</p><p id="dc26" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ms mt mu mv b">isWide: buttonType == .digit(.zero)</code></p><p id="948b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您最终的<code class="fe ms mt mu mv b">CalculatorButton</code>代码应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h1 id="3793" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">包裹</h1><p id="f852" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld mo lf lg lh mp lj lk ll mq ln lo lp im bi translated">咻，时间真长...谢谢你挺过来了。</p><p id="7645" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们已经完成了计算器视图。构建视图总是非常耗时，尤其是当我们坚持最佳实践而不走捷径的时候。保持视图的简单性(代码方面)对于构建更大的应用程序是必不可少的，所以当视图变得有点太复杂时，总是要尝试封装。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/171cccf4be585b12b14525b0d6ea449b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/1*mweEgvu2z5rfqWgKTLl7HQ.gif"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">最终的计算器视图</p></figure><p id="0cdd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下一个教程中，我们最终将为计算器添加功能。我们将看到我们为<code class="fe ms mt mu mv b">ButtonType</code>创建的模型如何极大地帮助我们让计算器工作。我们将添加<code class="fe ms mt mu mv b">CalculatorViewModel</code>和一个<code class="fe ms mt mu mv b">Calculator</code>类，它将负责计算一切。</p><p id="67a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以在这里继续第二部分<a class="ae ox" rel="noopener ugc nofollow" target="_blank" href="/complete-the-apple-calculator-in-swiftui-using-mvvm-99571a5875b4"/>。</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><h1 id="67c5" class="lu lv it bd lw lx pi lz ma mb pj md me jz pk ka mg kc pl kd mi kf pm kg mk ml bi translated">资源</h1><ul class=""><li id="c102" class="oh oi it kw b kx mm la mn ld pn lh po ll pp lp oz on oo op bi translated">你可以在Github <a class="ae ox" href="https://github.com/ricardomongza99/Calculator/tree/part1" rel="noopener ugc nofollow" target="_blank">这里</a>找到这部分的源代码。</li><li id="fe82" class="oh oi it kw b kx oq la or ld os lh ot ll ou lp oz on oo op bi translated">“在SwiftUI中创建自定义按钮样式”故事<a class="ae ox" href="https://medium.com/@ricardomongza/create-custom-button-styles-in-swiftui-f3778f695266" rel="noopener">此处</a></li><li id="7b7e" class="oh oi it kw b kx oq la or ld os lh ot ll ou lp oz on oo op bi translated">你可以在这里找到第2部分“使用MVVM在SwiftUI中完成苹果计算器”。</li></ul></div></div>    
</body>
</html>