<html>
<head>
<title>Storing Images on Cloudinary to Use for Your Rails Backend</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将图像存储在Cloudinary上以供Rails后端使用</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/storing-images-on-cloudinary-to-use-for-your-backend-ruby-on-rails-81c93cb53f69?source=collection_archive---------4-----------------------#2020-10-04">https://betterprogramming.pub/storing-images-on-cloudinary-to-use-for-your-backend-ruby-on-rails-81c93cb53f69?source=collection_archive---------4-----------------------#2020-10-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6bfc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用React上传到Cloudinary</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3123359300eccb1ec3b63f5a7fbb56c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*big4K5jC-JMk1kp2Keu0ig.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:作者</p></figure><p id="2ca4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最近，我需要上传图片到我的Rails后端。然而，我不能使用原始图像文件(JPEG或PNG)，我需要这些图像的URL。经过一番研究，我有了云存储的想法。我最初打算使用谷歌照片，但是，我一直被跨原产地资源共享(CORS)所阻止。我的解决方案是使用<a class="ae lr" href="https://cloudinary.com" rel="noopener ugc nofollow" target="_blank"> Cloudinary </a>代替。我使用React将图像上传到Cloudinary，并从Cloudinary中检索url以用于Ruby on Rails所需的URL。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="183d" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">使用React上传到Cloudinary</h1><p id="503a" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">我使用fetch和API url，通过POST方法将图像上传到我的cloudinary帐户上的特定文件夹中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/9675c8d4ff10d0fcdd1c291008920dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QXhoGA6gGJe1oXMEC01ELQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><h2 id="3358" class="mx ma iq bd mb my mz dn mf na nb dp mj le nc nd ml li ne nf mn lm ng nh mp ni bi translated">从Cloudinary中检索URL，以便在Ruby on Rails的后端使用</h2><p id="862f" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">我需要在后端(Ruby)创建一个新的图像，以便存档。因此我创造了这个方法:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/aff75deeddb4e821d76788c2c5c02bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5uYDkaScWiX4gEQ-JjH94Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><p id="2de8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上面的代码片段中有两个函数，对你来说，阅读是未定义的。首先是(API.postImage)，这是一个post方法，它将图像URL和主体作为参数，然后以JSON格式响应，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/9d26a94133831f2d1e5714f8ab0e537e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sk4dfEf1UyckZek-sqqVTQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><p id="e060" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样，上面的代码片段引用了post方法，对于您来说，读取是未定义的。这是post方法:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/670ba452325a916e9ca267d2ca911d8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zw82Om-hORA-TAKYbyBPeQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><p id="757b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是一个通用的post方法，我是为了它的可重用性而创建的。您只需要调用它并传递一个URL和主体作为参数。</p><p id="f3c8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其次，是<code class="fe nl nm nn no b">addImageToImageCollection</code>法。该方法不言自明，定义如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/b960fa9eda06fc22765d620630307a57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E_wybOmR_AtnuZRmFFnDDw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><p id="de1b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里有一个使用spread操作符的图像集合，新的图像被无损地添加到集合中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/38e4d6d67f18cb7508e756f9c0e2a814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R8EtsKcaU3AQUG4XtMiq5Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><p id="b2eb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，当您单击upload image按钮时，您将使用从Cloudinary检索的图像URL在后端(Ruby)创建一个新的图像。</p><p id="3380" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一如既往地感谢您的阅读，祝您编码愉快，我希望这能帮助到其他人。</p></div></div>    
</body>
</html>