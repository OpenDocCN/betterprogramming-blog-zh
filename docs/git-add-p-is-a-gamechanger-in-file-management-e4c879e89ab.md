# git add -p 是文件管理的一个改变者

> 原文：<https://betterprogramming.pub/git-add-p-is-a-gamechanger-in-file-management-e4c879e89ab>

## 一个经常被忽略的 git 提交工具

![](img/0db9568dfde2aa5e9fb3c42cdca1bd2c.png)

git add -p 让我们对提交采取一种微观的方法。[亚辛·哈尔法利](https://unsplash.com/@yassine_khalfalli?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

Git 管理是你第一次开始编码时学习的东西之一，一旦你熟悉了基础知识并建立了你的 GitHub 账户，你就会觉得这是理所当然的。

这是一件很容易习惯的事情，如果不是在你的工作过程中，甚至不需要考虑太多。

但是，如果 Git 是我们作为软件开发人员首先要学习的东西之一，难道我们不应该试着在此基础上进行构建吗？

这是我最近一直试图了解更多的东西，尤其是在一次网络活动中进行了一次启发性的谈话之后。

我最近和一个已经在软件工程领域工作了一段时间的人聊了聊，碰巧和一群刚进入这个领域的人在一起，包括我自己。

我们向这个家伙请教，最终，他提出了开发人员，不管是新的还是有经验的，没有真正关注他们的 g it 提交是多么令人讨厌。

他解释说，在这方面的懒散使得跟踪文档的变化变得很困难，这尤其困难，因为他的团队规模并不小。

这意味着，当一个 bug 出现时，追踪到它的根源会花费更长的时间，更不用说在 bug 成为问题之前找到一个有效的版本了。

他说了类似这样的话:“如果我采访某人，他们真的知道`git add -p`是什么，我会印象深刻。”

自然，这激起了几个人的兴趣。我们询问这到底是怎么回事，因为我们大多数人只是在项目上`git add -A`(你可以想象，这导致了一些指责)。

他解释说`git add -p`一次加载你修改的代码片段。当您运行这个命令时，会显示您所做的“大量”工作，显示您添加或删除的代码。

如果你已经做了很多，但有一段时间没有提交，这是非常有用的，它让你想起你到底做了什么，并在开始之前给你最后一次机会。

当你浏览数据块时，你也可以看到你正在浏览的不同文件。这再次让你保持对你所做的工作和你在哪里做的工作的认知。

它还会产生更强烈的承诺信息，促使对你的工作进行更具体的描述，而不是平淡或模糊的陈述。

在每一大块结束时，系统会提示您执行以下操作之一(直接取自`git add -p`的帮助部分):

```
y — stage this hunkn — do not stage this hunkq — quit; do not stage this hunk or any of the remaining onesa — stage this hunk and all later hunks in the filed — do not stage this hunk or any of the later hunks in the fileg — select a hunk to go to/ — search for a hunk matching the given regexj — leave this hunk undecided, see next undecided hunkJ — leave this hunk undecided, see next hunke — manually edit the current hunk? — print help
```

*   前两个选项，`y` 和`n`，是相当不言自明的——你要么选择把那个大块头送上舞台，要么不送。
*   第三个选项是`q`，它中止了这个过程，如果您意识到还不想开始转移或者意识到了一个关键错误，那么这个选项会很有用。
*   第四个选项是`a`，当你知道当前文件中后面的部分不需要仔细检查时，可以使用这个选项。这对于某些事情很有用，比如对代码进行小的润色，比如删除空格。
*   第五个选项`d`，与此相反。它类似于第三个选项，因为您选择不暂存当前块，而是只放弃暂存特定文件中的任何其他块。它也不会完全中止这个过程。
*   第六个选项`g`，允许您转到文件中的某个块。当被激活时，它将按编号列出文件中存在的其他块。输入相应的数字会让你看到那个帅哥的评论。(如果文件中只存在一个块，这将不会作为一个选项出现。)
*   第七个选项`**/**`，允许你输入一个正则表达式(正则表达式的缩写，如果你不熟悉的话，你可以在这里阅读更多关于[的内容)来搜索给定文件中的几大块。](https://medium.com/better-programming/the-joy-of-regular-expressions-part-1-what-is-regex-539dc581e282)

如果你记得你做过的某件事，但不是很详细，这可能很有用。想象你在做前端工作，在某个地方用特定的类名写了一个`<div>`。

如果你记住了这个名字，你就大大缩小了你需要搜索的对象的范围。

*   第八和第九个选项，`j` 和`J` **，**是类似的，你可以选择留下一个尚未决定的大帅哥。它们的区别仅仅在于你接下来会看到什么，是下一个普通的大块头还是下一个未定的大块头。

当你不确定自己是否想在那个时候上演什么时，把一个大块头标为未决定是很有用的。例如，一个模块的试运行可能取决于其他模块的审查和试运行。

*   第十个选项`e`，打开您的默认文本编辑器，并允许您直接修改大块内容。当你发现一个问题或者想立即快速解决时，这是一个很好的选择。
*   最后一个选项只是打开如上所示的帮助窗口。

# 结论

通过将你在最新版本的作品中所做的改动分门别类，你可以更加留意那些改动。您可以回顾您在每个部分具体做了什么，并决定这些部分是否准备就绪。

这种文件管理的“风水”方法也可以导致更频繁的提交，用更清晰的消息描述其中的工作。

当涉及到细致的工作时，使用`git add -p`是一个更好的方法，而不是盲目地将你所有的工作一次送到舞台上。尝试在下一次提交时使用它，看看有什么不同。

一如既往，玩得开心，开心编码！