<html>
<head>
<title>How To Implement React “useInView” Custom Hook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何实现React“usein view”自定义钩子</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/react-useinview-hook-intersection-observer-animations-and-multiple-refs-73c68a33b5b1?source=collection_archive---------4-----------------------#2022-11-15">https://betterprogramming.pub/react-useinview-hook-intersection-observer-animations-and-multiple-refs-73c68a33b5b1?source=collection_archive---------4-----------------------#2022-11-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c236" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">交叉点观察器、动画和多个参考</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/292e6f06968a42d76fd375ea23f9db5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZczQWN17Uv5FHKD6"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@matreding?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马蒂亚斯雷丁</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="5371" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将介绍如何构建一个名为<code class="fe ls lt lu lv b">useInView</code>的定制钩子，并在一些元素进入用户视图时用它来制作动画。</p><h1 id="e2ab" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">什么是交叉点观察器，以及如何在React中使用它</h1><p id="b833" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">正如文档所说，它是一个浏览器API。浏览器功能允许我们在特定元素与特定目标(默认为用户视口)相交时执行操作。</p><p id="3a01" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我强烈推荐阅读<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h2 id="8f1f" class="mt lx iq bd ly mu mv dn mc mw mx dp mg lf my mz mi lj na nb mk ln nc nd mm ne bi translated">它能用来做什么</h2><p id="7fd7" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">有一些很酷的应用程序，例如:</p><ul class=""><li id="1ef3" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">当视频退出/进入视图时暂停/播放视频</li><li id="823e" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">统计一篇文章或一个帖子被用户阅读了多少次</li><li id="730d" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">图像或任何其他内容的延迟加载</li><li id="b2d9" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">展示一些好看的动画</li><li id="0941" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">基于滚动的动态导航栏</li></ul><h2 id="54b2" class="mt lx iq bd ly mu mv dn mc mw mx dp mg lf my mz mi lj na nb mk ln nc nd mm ne bi translated">如何在React中快速设置交叉点观察器</h2><p id="2422" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">我们需要一个引用来定位需要观察的元素。将在<code class="fe ls lt lu lv b">useEffect</code>中设置<code class="fe ls lt lu lv b">Observer</code>，当元素在视图中时，我们可以有一个标记状态。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="62a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里发生了什么？我们在页面的底部显示一个段落，并且我们希望标记该元素何时在视图中，何时不在视图中。为此，我们保留对它的引用。</p><p id="40c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当组件被挂载时，我们创建一个交叉点观察器的新实例。我们传递回调函数，当观察者检测到我们的元素进入或退出视图时，该函数将被触发。<code class="fe ls lt lu lv b">entries</code>参数表示我们的目标节点，在我们的例子中，就是页面底部的段落。然后，我们用我们的目标调用<code class="fe ls lt lu lv b">observe</code>方法，最后，我们确保当组件被卸载时观察器断开连接。</p><h2 id="6bd4" class="mt lx iq bd ly mu mv dn mc mw mx dp mg lf my mz mi lj na nb mk ln nc nd mm ne bi translated">如何在自定义钩子中提取它</h2><p id="3d31" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">我们喜欢干净的代码，不是吗？在其他组件中使用它会很好，但是我们当然不希望每个组件重复大约20行代码。所以，让我们在一个单独的钩子中提取它，并让它观察多个元素。最好每个元素都有一个唯一的标识符。我们可以使用id或数据属性。</p><p id="6596" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">快速信息:数据属性是额外的属性，我们可以附加到HTML元素来存储一些信息，而不显示任何视觉表示。我们还必须尊重模式，将<code class="fe ls lt lu lv b">data</code>放在我们酒店的后面。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="310d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们的钩子变成了一个漂亮的黑盒，它接受对元素的引用，并返回一个对象，该对象包含元素名称(作为数据属性传递)和一个标志，该标志指示当前元素在视图中。</p><p id="a165" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在回调中所做的不同是，我们试图获取元素名称。如果没有找到，我们显示一个警告。否则，如果元素是相交的，我们就切换元素对象中的元素。我们应该意识到每个元素都应该有一个唯一的名字。</p><p id="5c87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我们重构后的组件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="80da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这只是一个基本的例子。我希望最终开发人员决定什么最适合他们的场景。如前所述，可以用id代替数据属性。钩子也可以被参数化以接收数据属性的名称。我们可以返回一个数组而不是一个对象，等等。</p><p id="81dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面，我演示了文章中的内容，我还添加了如何触发平滑淡入淡出动画。干杯🍺！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nu l"/></div></figure></div></div>    
</body>
</html>