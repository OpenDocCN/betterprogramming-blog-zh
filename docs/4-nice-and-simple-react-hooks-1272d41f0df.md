# 4 个漂亮简单的反应挂钩

> 原文：<https://betterprogramming.pub/4-nice-and-simple-react-hooks-1272d41f0df>

## useDebounce、useWhenVisible、useTimeout 和 useInterval

![](img/230ed6b02a8dcfcd44e01e985d64df98.png)

由 [Tatiana Rodriguez](https://unsplash.com/@tata186?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片。

React 已经成为在浏览器中构建应用程序的最流行的库之一。虽然它是由脸书发明的，但它是开源的，任何人都可以免费使用。数百万开发人员已经在使用 React 构建令人惊叹的企业应用程序。新的脸书网站完全由 React 和 Relay 组成，我们已经看到微软等其他大公司在 Azure DevOps 等应用程序中使用 React。

React 在 2019 年 2 月推出了 16.8 版本的钩子。它们允许您使用状态和其他 React 特性，而无需编写类。钩子允许您将一段有状态逻辑封装到一个可重用的“钩子”中，然后您可以在您的组件中使用它。

> "钩子允许你在不改变组件层次结构的情况下重用有状态逻辑."— [React 的文档](https://reactjs.org/docs/hooks-intro.html)

我收集了一些我日常使用的非常有用的钩子。

# 使用反跳

有了这个简洁的钩子，您将能够延迟一个值的去抖——就像您可以通过正常的去抖来延迟一个函数的执行。这个想法非常相似:我们在钩子中定义了一些局部状态，我们只在去抖动函数开始运行时更新这些状态。

非常适合这种挂钩的情况是，您想要对快速变化的值做出反应，但是您的反应可能是异步的或缓慢的，因此您只想对您能够消费的最新值做出反应。这里有一个例子:

## 履行

使用反钩

## 使用

useDebounce 用法示例

在上面的例子中，只有当用户停止输入超过 500 毫秒时，`debouncedSearchTerm`才会更新并运行我们的效果。如果他们再次开始输入，我们会在他们停止时再次运行该效果。通过这种方式，我们可以确保每次击键都不会向服务器发出请求。

# 使用可见时间

对于无限滚动这样的实现特性来说，这是一个非常有用的钩子，当用户滚动时，可以获取更多的数据。这个钩子允许您监听特定的元素，当该元素在视窗中可见时，将调用一个回调函数来通知您。然后，您可以使用这个回调作为获取更多数据的触发器。

当用户向下翻页时，它对于延迟加载图像或触发动画也很有用。

钩子利用浏览器中的`IntersectionObserver` API 来观察一个元素，然后在元素相交时调用提供的回调函数(在屏幕上可见)。

## 履行

使用可见挂钩

## 使用

useWhenVisible 用法示例

上面的代码所做的就是每当最后一个元素出现在视窗中时更新`offset`，触发我们的效果运行并获取下一组待办事项。简单易行。

# 使用超时

这个钩子可以让你以声明的方式使用普通的`setTimeout`行为，只要你想在做某事之前等待。这在很多情况下非常有用，通过使用钩子，您永远不必担心内存泄漏或奇怪的错误，因为您忘记了清除超时。

## 履行

使用超时挂钩

首先，我们为回调函数创建一个 ref。然后我们用一个效果来记住最新的回调函数。然后我们使用一个效果来设置计时器，并在之后进行清理。它的巧妙之处在于，你可以简单地通过将`null`作为延迟传入来取消一个正在运行的超时，因为它将清除超时并且*而不是*安排一个新的超时(第 15 行)。

## 使用

useTimeout 用法示例

如果这不容易读，我不知道什么是。简单，声明性，易于使用。

# 使用间隔

这和`useTimeout`很像。我已经把`setTimeout`的妹妹(`setInterval`)列为挂钩。它们的实现和 API 看起来几乎一样，所以我只向您展示代码:

## 履行

使用区间挂钩

如果您想在服务器上进行任何类型的轮询以获得新数据，那么`useInterval`非常有用。如果你不能控制 API，你就不能仅仅实现像 WebSockets 这样的东西来把数据推送到客户端。相反，您可以使用这个钩子来设置轮询。

假设你有一个协作购物清单应用程序，当你在杂货店把东西放进篮子里时，你和你的 S.O .可以从清单上划掉它们。在这种情况下，获取新数据是绝对必要的，这样你就不会在收银台遇到两件相同的商品，或者因为你认为你的 S.O .已经获取而完全忘记。

## 使用

useInterval 用法示例

这只是一个非常简单的例子，说明如何每五秒钟轮询一次 API 以获取新数据，从而保持视图的更新。

# 结论

我希望你喜欢这些例子，并且有一天能在你的应用中使用它们。

感谢阅读！