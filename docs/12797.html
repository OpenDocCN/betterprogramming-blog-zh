<html>
<head>
<title>Tired of Acknowledging Emails? Automate Replying Using Google App Scripts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">厌倦了回复邮件？使用谷歌应用程序脚本自动回复</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/you-dont-have-to-reply-to-emails-ever-again-a549ba1af696?source=collection_archive---------4-----------------------#2022-07-02">https://betterprogramming.pub/you-dont-have-to-reply-to-emails-ever-again-a549ba1af696?source=collection_archive---------4-----------------------#2022-07-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6c7d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你再也不用回复邮件了！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7b3078931d3f2ade448642045dd8effb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rd9IZ3SLf5vJJ_qCd6dz9w.jpeg"/></div></div></figure><p id="4b68" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">处理电子邮件是一件麻烦事。每个人每天都会收到数百封电子邮件。回复所有的邮件需要一天中相当长的时间。你可以花时间和家人在一起，从事一项爱好，或者漫无目的地浏览社交媒体。</p><p id="9b36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">回复邮件对我们大多数人来说是必须的。假设你正在开始一项新业务。尽快回复你的客户是非常重要的。你的竞争对手赢得那个你花了太长时间才回应的客户只是时间问题。</p><p id="4e1c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果我说有一种方法可以自动回复你收到的每封邮件。你不必查看每一封邮件。如果你错过了任何邮件，你不必担心。寄信人会对你的快速回复感到高兴。</p><h1 id="c611" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">什么是Google Apps脚本？</h1><p id="33c1" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated"><a class="ae mk" href="https://developers.google.com/apps-script" rel="noopener ugc nofollow" target="_blank"> Google Apps脚本</a>主页定义如下。</p><p id="ddfb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一个基于云的JavaScript平台，让您可以集成和自动化跨Google产品的任务。</p><p id="977d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Google在隐藏连接不同Google APIs的所有复杂性方面做得非常好。一个应用程序脚本用户必须调用几个预定义的函数和viola，你可以创造奇迹！！！</p><p id="1d68" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">还没印象深刻？让我给出一些应用程序脚本的示例用例。</p><ul class=""><li id="8c21" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated">基于电子表格上的事件详细信息创建日历事件，并将注册表单发送给事件的受邀者。</li><li id="e2e7" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">创建一张漂亮的发票，并使用电子表格中的数据通过电子邮件发送出去。</li><li id="7abe" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated">使用Google Chat创建Google日历事件。</li></ul><p id="26a7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们已经很好地理解了什么是应用脚本，让我们看看如何利用应用脚本来实现我们的目标；给你的邮件发送自动回复。我们一步一步来看解决方案。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="ec2d" class="ln lo iq bd lp lq ng ls lt lu nh lw lx jw ni jx lz jz nj ka mb kc nk kd md me bi translated">步骤1:设置应用程序脚本项目</h1><p id="40a3" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">首先，你必须去script.google.com<a class="ae mk" href="http://script.google.com" rel="noopener ugc nofollow" target="_blank"/>。点击<code class="fe nl nm nn no b">+ New Project</code>按钮，创建一个全新的项目来完成我们的任务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/f2b1670914792c30b1913b51cfdefcc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*dYwjhj40dymcdGgkk8M7yw.png"/></div></figure><p id="7a76" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它将打开一个类似下图的优雅编辑器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/b2fdf4f61edfde8ac3565fb2d9a5fe88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zGn-T4DbUjFCFSztZuykZA.png"/></div></div></figure><p id="502c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您的代码放在默认打开的文件<code class="fe nl nm nn no b">Code.gs</code>中。让我们清除编辑器中的模板代码，并添加代码来完成我们的电子邮件任务。</p><h1 id="12c4" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">第二步:阅读新邮件</h1><p id="266e" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">为了阅读新邮件，我们需要访问Gmail。Apps脚本为此提供了一个API，<code class="fe nl nm nn no b">GmailApp</code>。</p><p id="eab3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们只需要搜索新的电子邮件。但是，无法直接访问收件箱中的未读邮件。</p><p id="400a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这里，我们做一个小把戏。一旦我们回复了一封邮件，我们就给它加上一个标签。先说<code class="fe nl nm nn no b">replied</code>。下次我们搜索时，我们只需在收件箱中寻找没有标记为<code class="fe nl nm nn no b">replied</code>的邮件。我们用搜索查询<code class="fe nl nm nn no b">is:inbox-label:replied</code>。这里<code class="fe nl nm nn no b">is:inbox</code>确保对收件箱邮件的搜索已经完成。<code class="fe nl nm nn no b">-label:replied</code>确保搜索没有标签<code class="fe nl nm nn no b">replied</code>的邮件。</p><p id="468a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">假设<code class="fe nl nm nn no b">sendRepliesToEmails</code>是我们的函数名。这是目前为止的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">阅读新邮件</p></figure><h1 id="f562" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">第三步:回复过滤后的邮件</h1><p id="1a87" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">现在，我们必须回复列表上的每一封邮件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">回复每封邮件</p></figure><p id="cbc4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们必须想出<code class="fe nl nm nn no b">sendReplyTo</code>功能的逻辑。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="6059" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这里，我在回复消息中添加了一个示例正文作为<code class="fe nl nm nn no b">replyBody</code>。你可以改变它来满足你的要求。</p><p id="2db2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我使用由<code class="fe nl nm nn no b">GmailApp</code> API提供的<code class="fe nl nm nn no b">reply</code>函数发送一个带有<code class="fe nl nm nn no b">replyBody</code>的回复。</p><h1 id="d0be" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">步骤4:将回复的电子邮件主题标记为“已回复”</h1><p id="7951" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">我们现在已经回复了收件箱中的所有新邮件。为了避免下次运行脚本时回复相同的邮件，我们应该用标签<code class="fe nl nm nn no b">replied</code>标记我们回复的邮件。在下面的函数中，我们从它的名字<code class="fe nl nm nn no b">replied</code>中获取标签，然后将标签添加到我们刚刚回复的电子邮件线程中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="b79c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们已经创建了一个脚本来读取所有新邮件并给它们发送回复。你可能会想，是不是每天醒来都要运行这段代码！不要担心。应用程序脚本为您提供了保障。</p><h1 id="05a3" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">步骤5:创建一个触发器来定期运行该过程</h1><p id="f74c" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">应用程序脚本有一个很酷的设置触发器的功能。触发器可以在不同的动作上被激活。我们需要的是一个周期性启动的触发器。您可以设置一个触发器，只运行一次，就大功告成了！</p><p id="32a5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在下面的代码段中，从第3–7行，您可以看到我已经创建了一个调用函数<code class="fe nl nm nn no b">sendRepliesToEmails</code>的触发器。每15分钟触发一次。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="9247" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可能还注意到，在上面代码的第2行，我使用了一个名为<code class="fe nl nm nn no b">markOldEmailThreadsAsReplied</code>的函数。让我解释一下。</p><p id="8c43" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当您第一次运行函数<code class="fe nl nm nn no b">sendRepliesToEmails</code>时，它会搜索未标记为<code class="fe nl nm nn no b">replied</code>的电子邮件线程。因为没有邮件被标记为已回复，所以你所有可以追溯到恐龙时代的旧邮件都会被回复。根本不是我们想要的😆。</p><p id="b43b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，我们创建了一个名为<code class="fe nl nm nn no b">replied</code>的标签，获取所有收件箱邮件线程，并将它们标记为<code class="fe nl nm nn no b">replied</code>。在创建触发器之前，第一次只需要这样做一次。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="d65d" class="nx lo iq bd lp ny nz dn lt oa ob dp lx la oc od lz le oe of mb li og oh md oi bi translated">完全码</h2><p id="37d2" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">这是我们到目前为止所经历的代码片段的组合。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h1 id="49a1" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">第六步:执行</h1><p id="9aa2" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">从下拉菜单中，选择我们想要执行的功能<code class="fe nl nm nn no b">setEmailReplyTrigger</code>。然后点击️▶️ <code class="fe nl nm nn no b">Run</code>按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/f251f41079dafc0febeb7584d0e9328b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UR7yKcZAAm-YqwbiAbdn4Q.png"/></div></div></figure><p id="292b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第一次运行该脚本时，会出现一个弹出窗口，您可能需要接受访问Gmail的权限请求。弹出窗口甚至可能指出脚本不安全。嘿…你创作了剧本。能有多不安全😄</p><p id="a609" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以看到在选项卡中已经创建了一个触发器⏰<code class="fe nl nm nn no b">Triggers</code>。选项卡中显示了定期执行📑<code class="fe nl nm nn no b">Executions</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/2b304908a5a4b1d4274cc672ec4caec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*5--4mDi8xaS7CXOgAJeddQ.png"/></div></figure><p id="6f17" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在你可以啜饮一杯咖啡，享受你的早晨。应用程序脚本会照顾你的电子邮件。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><pre class="kg kh ki kj gt ol no om on aw oo bi"><span id="6764" class="nx lo iq no b gy op oq l or os"><strong class="no ir">Want to Connect?</strong></span><span id="a3e9" class="nx lo iq no b gy ot oq l or os">You can connect with me on <a class="ae mk" href="https://www.linkedin.com/in/gayal-dassanayake/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>.</span></pre></div></div>    
</body>
</html>