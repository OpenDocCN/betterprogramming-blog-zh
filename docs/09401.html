<html>
<head>
<title>Pivot Tables in Python With Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带熊猫的Python数据透视表</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/pivot-tables-in-python-with-pandas-d9b42b040bb3?source=collection_archive---------6-----------------------#2021-08-19">https://betterprogramming.pub/pivot-tables-in-python-with-pandas-d9b42b040bb3?source=collection_archive---------6-----------------------#2021-08-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="35e5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">最强大的数据分析工具之一的完整指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c97ace03b866b4487b12a5a327a352ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CRCAzrPJfi5ZBsyh"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">诺德伍德主题公司在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="ac5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们假设你有很多数据，你不知道如何处理这些数据。或者，假设您需要确定数据中的潜在模式，但不知道如何去做。或者，您可能正忙于创建一些奇特的数据表。</p><p id="f06a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有这些场景都可以用一个伟大的工具来解决:数据透视表。</p><p id="7478" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据透视表基本上是通过按特定功能对原始数据进行分组并使用某种函数聚合所需值而创建的表。让我们看一个例子来更好地理解这个定义的含义。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="f2fc" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">例子</h1><p id="4bce" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">假设你是一名学校官员，想要确定哪个老师在他们班的平均成绩方面做得更好。</p><p id="48e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，您有一个来自学校数据库的表，其中每个学生都有一个学生组(每个组有不同的老师)、年龄和最终成绩。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/f289bf096c0cc534c3b59872375af609.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*fbcU2zZrefRLEfhyAc0L1g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">学生数据表</p></figure><p id="0e70" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你现在需要做的是以某种方式将你的学生分组，并计算每组学生的平均分数。</p><p id="f14d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果表将是一个数据透视表，因为我们按组对数据进行分组，并使用均值函数对等级进行汇总(将所有等级相加，然后除以它们的数量)。</p><p id="dfa3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我已经在下面创建了所需的数据透视表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/7785299a408ae27de64629166fade7a7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*YbUNp_CFdU4721BA2n3osw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的数据透视表</p></figure><p id="a4a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们所看到的，第1组和第3组的老师做得很好，而第2组的老师可能需要更多地与学生合作，以确保更好的学习效果。简单的表格修改帮助我们轻松地回答了这个问题。</p><p id="cde6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据透视表可以成为数据分析工具箱中最强大、最易于使用的工具之一。因此，让我们深入研究一下吧！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e2b4" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">Python中的基本数据透视表</h1><p id="17dd" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了介绍Python数据透视表，我将使用易于访问的开源成人数据<a class="ae kv" href="https://archive.ics.uci.edu/ml/datasets/Adult" rel="noopener ugc nofollow" target="_blank">这里</a>。它有关于人及其特征的信息，如种族、性别、收入等。您可以使用<a class="ae kv" href="https://github.com/Zhenia-Magic/Adult_Data" rel="noopener ugc nofollow" target="_blank">这个GitHub库</a>下载原始数据和列名</p><p id="19a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要读取数据(因为它没有内部列名，所以我们需要使用另一个CSV文件来读取列并将它们放入数据框中)。</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="d8dd" class="nd ma iq mz b gy ne nf l ng nh">import pandas as pd<br/>import csv<br/><br/>with open('col_name.csv', newline='') as f:<br/>    reader = csv.reader(f)<br/>    cols = list(reader)<br/><br/>def flatten(t):<br/>    return [item for sublist in t for item in sublist]<br/><br/>cols = flatten(cols)<br/><br/>data = pd.read_csv("adults.csv", names=cols)</span></pre><p id="7f11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于本文的第一个Python数据透视表，我想确定每个性别的最大年龄。为此，我将为数据透视表编写熊猫函数。</p><p id="c2ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它被称为<code class="fe ni nj nk mz b">pd.Dataframe.pivot_table</code>，具有以下关键参数(还有更多，但在大多数情况下不使用):</p><ul class=""><li id="4b0f" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated"><code class="fe ni nj nk mz b">index</code>:数据分组所依据的单个列或列列表。</li><li id="e3ff" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><code class="fe ni nj nk mz b">values</code>:聚合并显示在结果透视表中的单个列或列列表。</li><li id="7e6f" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><code class="fe ni nj nk mz b">columns</code>:列，我们将根据它(与索引列同时)对数据进行分组。</li><li id="529a" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><code class="fe ni nj nk mz b">aggfunc</code>:数据透视表中值的聚合函数或函数列表。</li></ul><p id="f728" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们问题的结果代码是:</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="9f4d" class="nd ma iq mz b gy ne nf l ng nh">data.pivot_table(index="sex", values="age", aggfunc="max")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/91e81835a68a38f1eff131ca50ae5048.png" data-original-src="https://miro.medium.com/v2/format:webp/1*gunp59UJQ_b9WHwf6hX2SQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的数据透视表</p></figure><h2 id="a329" class="nd ma iq bd mb nz oa dn mf ob oc dp mj lf od oe ml lj of og mn ln oh oi mp oj bi translated">增加复杂性</h2><p id="9305" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">下一个数据透视表将是一个多索引数据透视表。如何确定数据中存在的年龄模式？我们将使用race和<code class="fe ni nj nk mz b">sex</code>作为分组列，并使用<code class="fe ni nj nk mz b">pd.Dataframe.describe</code>函数来聚合年龄。于是，我们将几乎不费时费力地看到大量与年龄相关的统计数据。</p><p id="8864" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要为函数的index参数使用一个列列表。这个表的代码如下。</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="6a04" class="nd ma iq mz b gy ne nf l ng nh">data.pivot_table(index=["race", "sex"], values="age", aggfunc="describe")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/0ea19f8cfd65efd13723be1473656eab.png" data-original-src="https://miro.medium.com/v2/format:webp/1*nkYXoBJkiCLDEneypIsMtw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的数据透视表</p></figure><p id="4e51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已经在本文中介绍了<code class="fe ni nj nk mz b">columns</code>参数，但是让我们看看它在特定情况下是如何有帮助的。</p><p id="bf3e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">比方说，我们希望使用与之前相同的分组列(<code class="fe ni nj nk mz b">race</code>和<code class="fe ni nj nk mz b">sex</code>)并向其中添加<code class="fe ni nj nk mz b">salary</code>(它是一个值小于或等于50 K美元或大于50K美元的二元变量)。现在，我要计算每个类别的人数(基于<code class="fe ni nj nk mz b">gender</code>、<code class="fe ni nj nk mz b">race</code>、<code class="fe ni nj nk mz b">income</code>)。</p><p id="3144" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">值得注意的是，为了只计算每个单元格中的人数(而不是一些数学运算，如均值或中值)，我可以使用任何既没有缺失值也没有索引参数作为值的列。在我们的例子中，所有的列都没有<code class="fe ni nj nk mz b">NaNs</code>，所以我可以选择任何一个。为了方便起见，我决定继续留在<code class="fe ni nj nk mz b">age</code>专栏。</p><p id="4fc9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然，我可以像下面这样简单地编写命令:</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="3bdc" class="nd ma iq mz b gy ne nf l ng nh">data.pivot_table(index=["race", "sex", "salary"], values="age", aggfunc="count")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/7efe157e49dfec03b4c14aecf9632e6e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*R8J13CCf4pFy1-qk-MPWoA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的数据透视表</p></figure><p id="8c0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">哎呦！这张桌子又长又复杂，不容易看出里面有什么图案。</p><p id="5daa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很高兴，有一个解决方案。我们可以对其中一个索引列使用columns参数。尽管可以在columns参数中使用任何列，但我建议坚持使用唯一值最少的列，以免表太大。</p><p id="c83c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我可以选择<code class="fe ni nj nk mz b">gender</code>或者<code class="fe ni nj nk mz b">income</code>。但是<code class="fe ni nj nk mz b">income</code>似乎是与<code class="fe ni nj nk mz b">race</code>和<code class="fe ni nj nk mz b">gender</code>分开的更好的选择，因为从逻辑上讲，它不是一个人预先确定的生物特征。</p><p id="e946" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">新代码如下所示:</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="aaf2" class="nd ma iq mz b gy ne nf l ng nh">data.pivot_table(index=["race", "sex"], columns="salary", values="age", aggfunc="count")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/b0aedcab03994c05b4624a7092c7b76f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*XCLROY0KKZOxW6-EUmW4Fw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的数据透视表</p></figure><p id="de94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好像好多了。现在，您已经知道如何创建好看的数据透视表，所以有时间学习熊猫数据透视表的一些高级功能。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="00ff" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">高级功能</h1><p id="d431" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">使用数据透视表可以做的最令人兴奋的事情之一是用自己的聚合函数创建它。这样，您可以更加个性化您的表格。</p><p id="bc77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了理解需要哪种类型的函数作为<code class="fe ni nj nk mz b">aggfunc</code>参数，让我们深入研究当使用索引列对数据进行分组时实际会发生什么。</p><p id="626b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们为数据透视表提供一个索引列时，例如<code class="fe ni nj nk mz b">sex</code>，Pandas会在该列中查找所有唯一值(在我们的例子中是<code class="fe ni nj nk mz b">male</code>和<code class="fe ni nj nk mz b">female</code>)，并通过使用这个唯一值过滤索引列来为每个唯一值创建一个单独的数据框。</p><p id="3a45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们现在有两个内部数据框架:只有女性和男性。随后，对序列(数据框中的一列)使用聚合函数，我们将其标识为值列。</p><p id="9ed3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">比如可以是年龄。因此，如果我们有平均值<code class="fe ni nj nk mz b">aggfunc</code>，我们从女性数据框架中提取所有年龄，并计算女性的平均年龄。然后，我们对男士数据框做同样的处理。</p><p id="d93e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，聚合函数是值列中的一系列值所在的函数。</p><p id="250c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们看另一个例子。我想找到男女的年龄范围。该范围是序列中最大值和最小值之间的差值。基于系列计算范围的函数如下所示:</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="0af8" class="nd ma iq mz b gy ne nf l ng nh">def range_func(series: pd.Series) -&gt; int:<br/>	return series.max() - series.min()</span></pre><p id="badb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们写好一个函数之后，我们可以把它放入<code class="fe ni nj nk mz b">aggfunc</code>参数中。</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="4bff" class="nd ma iq mz b gy ne nf l ng nh">data.pivot_table(index="sex", values="age", aggfunc=range_func)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/e314c99fed6278f685a0c015eb30b634.png" data-original-src="https://miro.medium.com/v2/format:webp/1*dNKq8VeJLnfYxYRxq5l5xg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的数据透视表</p></figure><p id="e232" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用自定义函数，我们不需要使用引号。</p><p id="8898" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用数据透视表时，另一个潜在的想法是如何对许多值列使用不同的聚合函数。例如，我想计算均值<code class="fe ni nj nk mz b">age</code>和众数<code class="fe ni nj nk mz b">salary</code>(<code class="fe ni nj nk mz b">income</code>最常见的值)。<code class="fe ni nj nk mz b">Age</code>和<code class="fe ni nj nk mz b">salary</code>至少在本质上是不同的变量(<code class="fe ni nj nk mz b">age</code>是数值型的，而<code class="fe ni nj nk mz b">salary</code>是分类型的)，所以我不能对它们都使用均值<code class="fe ni nj nk mz b">aggfunc</code>。但是，有一个解决方案。</p><p id="aa1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以将一个字典(其中键是值列，值是我们想要为该值列计算的聚合函数(或多个函数))放入<code class="fe ni nj nk mz b">aggfunc</code>参数中。参见下面的代码:</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="fc83" class="nd ma iq mz b gy ne nf l ng nh">data.pivot_table(index="sex", aggfunc={"age": "mean", "salary": lambda x: x.mode()[0]})</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/f3440ec306e865a1f5b63ec0393391f4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*hcAHlRN-nQVwL6xPL4as2g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的数据透视表</p></figure><p id="0817" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以通过将<code class="fe ni nj nk mz b">margins</code>参数设置为<code class="fe ni nj nk mz b">True</code>来添加总数。</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="6fd6" class="nd ma iq mz b gy ne nf l ng nh">data.pivot_table(index=["race", "sex"], values="age", aggfunc="count", margins=True)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mx"><img src="../Images/c136fbb0753b2b699afa6ca548c51bda.png" data-original-src="https://miro.medium.com/v2/format:webp/1*3GLC18sInj27iRpMmrVA7Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的数据透视表</p></figure><p id="da9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后一个小建议是，如果由于缺少特定类别的数据而在数据透视表中获得了一些<code class="fe ni nj nk mz b">NaNs</code>，只需使用<code class="fe ni nj nk mz b">fill_value</code>参数并将其设置为您想要查看的任何内容，而不是<code class="fe ni nj nk mz b">NaNs</code>。</p><p id="7d5d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尽管没有<code class="fe ni nj nk mz b">NaNs</code>，以下是如何使用该参数:</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="e9c7" class="nd ma iq mz b gy ne nf l ng nh">data.pivot_table(index="sex", aggfunc={"age": "mean", "salary": "mode"}, fill_value=0)</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="1a87" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="e891" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">就是这样！现在你是熊猫里的数据透视表忍者。开始在任何数据分析项目中创建数据透视表，以更好地理解数据特征和模式。感谢阅读。</p></div></div>    
</body>
</html>