<html>
<head>
<title>Build an Animating UINavigationBar in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Swift中构建一个动画UINavigationBar</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/building-an-animating-navigation-bar-in-ios-13-96355c6822ce?source=collection_archive---------9-----------------------#2020-05-11">https://betterprogramming.pub/building-an-animating-navigation-bar-in-ios-13-96355c6822ce?source=collection_archive---------9-----------------------#2020-05-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8cf3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">超越默认的导航栏功能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/873cde83b12ca806386588f12f9fee9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e_KaILWGWIBG5Ssr"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@ryz0n?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">瑞安唐</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照。</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="9c06" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">我们在建造什么？</h1><p id="9954" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">我们将建立一个自定义导航栏，有一个动画视图和右栏按钮。</p><p id="1ca1" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">我们将通过玩框架的轴(基本上是平移)来构建动画。这是最有用的，当你有一个模型演示，并希望你的UX脱颖而出！</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="428e" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">先决条件</h1><p id="4729" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">这是入门教程。您应该熟悉视图的框架和边界。此外，这篇文章采用了一种程序化的视图构建方法，但是动画部分通过故事板也是类似的。</p><p id="8cc3" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">了解<a class="ae kv" href="https://developer.apple.com/documentation/coregraphics/cgaffinetransform" rel="noopener ugc nofollow" target="_blank"> CGAffineTransform </a>和<a class="ae kv" href="https://github.com/roberthein/TinyConstraints" rel="noopener ugc nofollow" target="_blank"> TinyConstraints </a>者优先。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="584f" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">从哪里开始</h1><p id="fa34" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">我们的最终产品将是下面的动画。在GitHub 上下载启动项目<a class="ae kv" href="https://github.com/arjunbaru/mediumArticles" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/f53e2d5c571b1e16ce8fc7f9464cf716.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/1*13gWeBw-9fC1b6YMdtZbUA.gif"/></div></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="10a9" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">起始项目中有什么？</h1><p id="3022" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">浏览代码，我们有一个<code class="fe mx my mz na b">ViewController.swift</code>类，它有一个添加了不同城市数据源的表视图。</p><p id="3e6a" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">它还没有导航栏呢！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/f21356d3ed1191a4b4e60ae3310ca422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i49LZkiy3f94B4GqgnHltg.png"/></div></div></figure><p id="e8bb" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">让我们创建一个CustomNavigationBar <strong class="lx ir"> </strong>类<strong class="lx ir">。</strong>将<code class="fe mx my mz na b">CustomNavigationBar.swift</code> <strong class="lx ir"> </strong>文件添加到项目中。</p><p id="096f" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">首先，我们将创建一个自定义枚举<strong class="lx ir"> </strong> ( <code class="fe mx my mz na b">AnimationStyle</code> ) <strong class="lx ir"> </strong>，这个<strong class="lx ir"> </strong>将指导视图的动画行为。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/901af19713d8a8711d98d8c12c974f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Ff0HeGZEcoY96AWX7tPSw.png"/></div></div></figure><p id="a362" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">在本教程中，我们将只实现从左到中的动画。</p><p id="ee45" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">由于我们使用的是enum，我们可以根据需要在将来添加其他类型的动画。</p><p id="b8bf" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">让我们创建一个<code class="fe mx my mz na b">CustomNavigationBar.swift</code> <strong class="lx ir"> </strong>类<strong class="lx ir"> </strong>并添加下面的代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/f0daf78370bac1bc90a51d1d871b7380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lfXEANwjqa0AasToQFOGlA.png"/></div></div></figure><p id="6608" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">我们用动画视图和动画样式初始化这个类。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="8788" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">让我们来设置UI</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/96990eafe30a9b80f57591454e854ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q7r-KkgGns9QPC8bfD18AA.png"/></div></div></figure><p id="8dc7" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">让我们将视图放置在左侧，以Y轴为中心，高度为超级视图的高度。</p><p id="bcfa" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">我使用TinyConstraint库作为一个工具来布置约束。您也可以使用NSLayoutConstraint。只要确保你把它放在正确的地方。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="3dea" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">是时候加入魔法了</h1><p id="46a2" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">添加以下代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/004e0cf15717099c4e03395fea16fe50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAI9cD5rxVw9NrnVXDj7dw.png"/></div></div></figure><p id="c69b" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">我们在这里做的是相对于偏移表格/滚动视图平移x轴。</p><p id="01fa" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">由于原点从左上角开始，我们将平移视图，并在到达超级视图的中心时停止。</p><p id="6f4b" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">为此，我们将取(<code class="fe mx my mz na b">zero, ContentOffset</code>)的<strong class="lx ir"> </strong>最大值，这样<code class="fe mx my mz na b">-ve translation(of scrollView)</code>就可以被删除，并与<strong class="lx ir"> </strong>超级视图的中心进行比较(取最小值)。然后我们将更新为翻译。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="40ea" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">让我们连接导航栏</h1><p id="6a91" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">在<code class="fe mx my mz na b">ViewController.swift</code>文件中创建导航栏和动画视图(在本例中是一个UILabel ):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/fd40ad72f9b2996fe49da145d96fcae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dfc9bTdweuZfZWfIKVD_SA.png"/></div></div></figure><p id="d811" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">使用ScrollView的<code class="fe mx my mz na b">scrollViewDidScroll(_ scrollView: UIScrollView)</code> <em class="nh"> </em>方法，传递tableView的<code class="fe mx my mz na b">contentOffSet</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/8c153255cc031114d169e697aa436ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mFSlaI2ELsF8AwdB9q2q5g.png"/></div></div></figure><p id="7ba9" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">建造并运行！</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="096e" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated"><strong class="ak">让我们添加导航栏按钮</strong>并制作动画</h1><p id="6e89" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md me mf mg mh mi mj mk ml mm mn mo mp mq ij bi translated">添加以下代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/89845f2504f5d88d10dd73de91008a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qmr2rlp_QReUrUXodHJO8Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用iOS 13默认图像创建信息按钮</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/346d6ed2f3cb81a78d5e960adacd4e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CktFBVTFkC3lpYhCRDg0eg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">把它放在右上角</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/bf15e3c7f588ed59b1a72ecab591d21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cnLLW9omLi1t7_94IEfGcw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">随着表视图偏移量的增加，alpha也增加</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="f71a" class="ld le iq bd lf lg lh li lj lk ll lm ln jw lo jx lp jz lq ka lr kc ls kd lt lu bi translated">看看最后的结果吧！</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/f53e2d5c571b1e16ce8fc7f9464cf716.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/1*13gWeBw-9fC1b6YMdtZbUA.gif"/></div></div></figure><p id="ad03" class="pw-post-body-paragraph lv lw iq lx b ly mr jr ma mb ms ju md me mt mg mh mi mu mk ml mm mv mo mp mq ij bi translated">厉害！你可能想知道iOS 13的大导航栏是如何做到这一点的。嗯，这是另一个动画教程的主题。</p></div></div>    
</body>
</html>