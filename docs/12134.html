<html>
<head>
<title>Help Ethereum Become More Secure and Decentralized and Set Up a Node</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">帮助以太坊变得更加安全和分散，并设置一个节点</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/help-ethereum-become-more-secure-and-decentralized-and-set-up-a-node-in-5-minutes-6a0316f2b7?source=collection_archive---------15-----------------------#2022-05-13">https://betterprogramming.pub/help-ethereum-become-more-secure-and-decentralized-and-set-up-a-node-in-5-minutes-6a0316f2b7?source=collection_archive---------15-----------------------#2022-05-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7b0e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">五分钟后！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4af0ed4521e1c0cd1783658d24c690ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YNHmihYILLJOsM6wx3cxdQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://pixabay.com/vectors/ethereum-logo-ethereum-icon-6278328/" rel="noopener ugc nofollow" target="_blank">以太坊</a>由pixabay上的<a class="ae kv" href="https://pixabay.com/users/imnamlas-15727080/" rel="noopener ugc nofollow" target="_blank"> imnamlas </a></p></figure><p id="8194" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">免责声明:</strong>教程中使用的实例是<code class="fe ls lt lu lv b">m5zn.xlarge</code>，定价大致为0.33美元/小时(240美元/月)。请不要忘记在最后一步中清理资源，除非您需要持续、无限制地访问mainnet APIs，或者您打算成为ETH 2.0上的验证者。</p><h1 id="52ed" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">环境变量:</h1><ul class=""><li id="cda5" class="mo mp iq ky b kz mq lc mr lf ms lj mt ln mu lr mv mw mx my bi translated"><code class="fe ls lt lu lv b">TF_VAR_AWS_ACCESS_KEY</code></li><li id="25ba" class="mo mp iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><code class="fe ls lt lu lv b">TF_VAR_AWS_SECRET_KEY</code></li><li id="7ebc" class="mo mp iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><code class="fe ls lt lu lv b">TF_VAR_SSH_PASSWORD</code></li><li id="910b" class="mo mp iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><code class="fe ls lt lu lv b">TF_VAR_REGION</code></li></ul><p id="dda6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">依赖关系:</p><ul class=""><li id="a60f" class="mo mp iq ky b kz la lc ld lf ne lj nf ln ng lr mv mw mx my bi translated">aws-cli</li><li id="c0eb" class="mo mp iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">将（行星）地球化（以适合人类居住）</li><li id="b723" class="mo mp iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">ansible</li><li id="a205" class="mo mp iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">jq(用于解析json)</li><li id="b143" class="mo mp iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">ssh键(<code class="fe ls lt lu lv b">~/.ssh/id_rsa</code>和<code class="fe ls lt lu lv b">~/.ssh/id_rsa.pub</code>)</li></ul><p id="2ac1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在macOS上，那些都可以用<code class="fe ls lt lu lv b">brew</code> (aws，terraform，jq)或者<code class="fe ls lt lu lv b">pip</code> (ansible)安装。</p><h1 id="d1ff" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">使用</h1><ul class=""><li id="9f79" class="mo mp iq ky b kz mq lc mr lf ms lj mt ln mu lr mv mw mx my bi translated">获取分配的IP地址并将其附加到ansible hosts文件中，将该地址导出到环境中</li></ul><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="cb80" class="nl lx iq lv b gy nm nn l no np">aws ec2 allocate-address &gt; /etc/allocated-address<br/>export NODE_IP=$(cat /etc/allocated-address | jq -r ".PublicIp")<br/>export TF_VAR_ALLOCATION_ID=$(cat /etc/allocated-address | jq -r ".AllocationId")<br/>echo $NODE_IP &gt;&gt; /etc/ansible/hosts</span></pre><p id="f0a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果希望保持相同的地址，可以将<code class="fe ls lt lu lv b">NODE_IP</code>和<code class="fe ls lt lu lv b">TF_VAR_ALLOCATION_ID</code>变量的设置附加到<code class="fe ls lt lu lv b">~/.profile</code>上。</p><ul class=""><li id="b38a" class="mo mp iq ky b kz la lc ld lf ne lj nf ln ng lr mv mw mx my bi translated">启动并设置实例</li></ul><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="236c" class="nl lx iq lv b gy nm nn l no np">git clone <a class="ae kv" href="https://github.com/piotrostr/eth-mainnet-light-node" rel="noopener ugc nofollow" target="_blank">https://github.com/piotrostr/eth-mainnet-light-node</a><br/>cd eth-mainnet-light-node<br/>cd ./terraform &amp;&amp; terraform init &amp;&amp; terraform apply<br/>cd ../<br/>ansible-playbook ansible/main.yml<br/>ssh ubuntu@$NODE_IP</span></pre><ul class=""><li id="9c8b" class="mo mp iq ky b kz la lc ld lf ne lj nf ln ng lr mv mw mx my bi translated">选择一个节点并运行，可以是一个轻节点</li></ul><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="f9f1" class="nl lx iq lv b gy nm nn l no np">geth --syncmode light --http</span></pre><p id="307a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者一个完整的节点</p><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="5e38" class="nl lx iq lv b gy nm nn l no np">geth --http</span></pre><ul class=""><li id="75e9" class="mo mp iq ky b kz la lc ld lf ne lj nf ln ng lr mv mw mx my bi translated">在geth节点与mainnet同步后，它可以接受请求</li></ul><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="dc04" class="nl lx iq lv b gy nm nn l no np">curl <a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/$NODE_IP/">http://$NODE_IP:8545/</a></span></pre><h1 id="618e" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">打扫</h1><p id="0537" class="pw-post-body-paragraph kw kx iq ky b kz mq jr lb lc mr ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">破坏资源</p><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="0556" class="nl lx iq lv b gy nm nn l no np">cd ./terraform<br/>terraform destroy</span></pre><p id="1ca3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">释放弹性IP</p><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="2d13" class="nl lx iq lv b gy nm nn l no np">aws ec2 release-address --allocation-id $TF_VAR_ALLOCATION_ID<br/>rm /etc/allocated-address</span></pre><p id="774e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并且不要忘记从<code class="fe ls lt lu lv b">/etc/ansible/hosts</code>中移除主机<code class="fe ls lt lu lv b">$(echo $NODE_IP)</code></p><h1 id="e957" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">许可证</h1><p id="ba54" class="pw-post-body-paragraph kw kx iq ky b kz mq jr lb lc mr ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">麻省理工学院</p></div></div>    
</body>
</html>