<html>
<head>
<title>How to Lint Commit Messages with Husky and CommitLint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Husky和CommitLint提交消息</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-lint-commit-messages-with-husky-and-commitlint-b51d20a5e514?source=collection_archive---------0-----------------------#2022-07-16">https://betterprogramming.pub/how-to-lint-commit-messages-with-husky-and-commitlint-b51d20a5e514?source=collection_archive---------0-----------------------#2022-07-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e509" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用CommitLint将您的提交提升到下一个级别</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/78be617e023cb871402884556aa0a338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ho_lSgKBmze-MMLD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@brett_jordan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布雷特·乔丹</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="4ae8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="6048" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您遇到过多少次类似这样的git日志？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/5986be2e28c9eda523aaa2c076d0a152.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*-v_FwjDAda7kikg8Z-Ey3A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">git日志—单行</p></figure><p id="3654" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">比你想象的要多，对吧？我们开发人员往往会变得懒惰，不会在我们认为不重要的事情上投入太多精力(这些事情通常是我们代码之外的事情)。然而，从这些不可理解的提交来理解我们的存储库中发生了什么是绝对不可能的。这使得团队很难有效地合作。</p><p id="02a6" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">那么，如果维护一个干净的git日志如此重要，我们该如何做呢？如何才能逼自己写出更好、更干净、语义更明确、一目了然的提交？</p><p id="1196" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">请看，终极提交林挺工具:<a class="ae ky" href="https://commitlint.js.org/#/" rel="noopener ugc nofollow" target="_blank">commit list</a>。</p><p id="7428" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">本教程将向您展示如何安装和配置CommitLint，以及<a class="ae ky" href="https://typicode.github.io/husky/#/" rel="noopener ugc nofollow" target="_blank"> Husky </a>。</p><h2 id="7395" class="mt la it bd lb mu mv dn lf mw mx dp lj ma my mz ll me na nb ln mi nc nd lp ne bi translated">索引</h2><ul class=""><li id="eb61" class="nf ng it lt b lu lv lx ly ma nh me ni mi nj mm nk nl nm nn bi translated">安装CommitLint</li><li id="a5db" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated">安装Husky</li><li id="2e69" class="nf ng it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated">测试</li></ul></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="27ed" class="kz la it bd lb lc oa le lf lg ob li lj jz oc ka ll kc od kd ln kf oe kg lp lq bi translated">安装CommitLint</h1><p id="4821" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">CommitLint是一个提交林挺工具，它将迫使我们写出漂亮的提交。它是怎么做到的？</p><p id="7c78" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">CommitLint使用一种叫做约定的东西，它基本上是我们提交需要遵循的一系列规则。如果我们试图做出一个不遵循我们选择的约定的承诺，它将会失败。您可以在这里找到所有可用约定的列表<a class="ae ky" href="https://github.com/conventional-changelog/commitlint#shared-configuration" rel="noopener ugc nofollow" target="_blank">。对于本教程，我将使用基于</a><a class="ae ky" href="https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#-commit-message-guidelines" rel="noopener ugc nofollow" target="_blank">角度约定的</a><a class="ae ky" href="https://www.conventionalcommits.org/en/v1.0.0/" rel="noopener ugc nofollow" target="_blank">常规提交规范</a>。看起来是这样的:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="80bf" class="mt la it og b gy ok ol l om on">type(scope?): message</span></pre><p id="82ba" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">要安装CommitLint和config-conventi on，让我们运行以下命令:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="a502" class="mt la it og b gy ok ol l om on">npm i -D <a class="ae ky" href="http://twitter.com/commitlint" rel="noopener ugc nofollow" target="_blank">@commitlint</a>/{cli,config-conventional}</span></pre><p id="37ed" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">要在CommitLint中使用配置常规规则，我们有两个选项:</p><ol class=""><li id="147c" class="nf ng it lt b lu mo lx mp ma oo me op mi oq mm or nl nm nn bi translated">在您的应用程序根目录中创建一个<code class="fe os ot ou og b">.commitlintrc.json</code>文件，这将扩展配置常规规则。</li></ol><p id="4ecb" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">2.创建一个<code class="fe os ot ou og b">commitlint.config.js</code>文件，该文件将导出配置常规规则。</p><p id="c5a3" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><em class="ov">注意:我通常会选择第一个选项，但任何一个都可以，只要你不两个都做！</em></p><h2 id="5e30" class="mt la it bd lb mu mv dn lf mw mx dp lj ma my mz ll me na nb ln mi nc nd lp ne bi translated">选项1:创建一个. commitlintrc.json文件</h2><p id="f80b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，我们在应用程序的根目录下创建文件:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="abef" class="mt la it og b gy ok ol l om on">touch .commitlintrc.json</span></pre><p id="2c32" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">然后，我们扩展配置常规规则:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="47bc" class="mt la it og b gy ok ol l om on">{<br/>  "extends": ["<a class="ae ky" href="http://twitter.com/commitlint/config-conventional" rel="noopener ugc nofollow" target="_blank">@commitlint/config-conventional</a>"]<br/>}</span></pre><p id="5731" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">您的<code class="fe os ot ou og b">.commitlintrc.json</code>文件应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/07319395700590e61ef3b34b230bf061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8JqaPQWQs15KkwnWo3kJvA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">. commitlintrc.json文件</p></figure><h2 id="57bb" class="mt la it bd lb mu mv dn lf mw mx dp lj ma my mz ll me na nb ln mi nc nd lp ne bi translated">选项2:创建commit link . config . js文件</h2><p id="828d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，我们在应用程序的根目录下创建文件:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="cc6f" class="mt la it og b gy ok ol l om on">touch commitlint.config.js</span></pre><p id="21a6" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们导出配置常规规则:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="f2ef" class="mt la it og b gy ok ol l om on">module.exports = {<br/>  extends: ['<a class="ae ky" href="http://twitter.com/commitlint/config-conventional" rel="noopener ugc nofollow" target="_blank">@commitlint/config-conventional</a>'],<br/>};</span></pre><p id="8560" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">仅此而已！CommitLint已经设置好了。该装哈士奇了。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="4daa" class="kz la it bd lb lc oa le lf lg ob li lj jz oc ka ll kc od kd ln kf oe kg lp lq bi translated">安装Husky</h1><p id="fbcd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Git为我们提供了一个叫做钩子的小东西，我们可以用它来进入git工作流的不同阶段。因为我们想让CommitLint解析我们的提交消息，所以我们可以使用commit-msg钩子，它会在我们每次添加提交消息时运行。如果消息不符合约定，CommitLint将出错，我们将不得不重试。</p><p id="6edf" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们要做的第一件事是安装哈士奇。我们可以通过运行以下命令来实现这一点:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="e488" class="mt la it og b gy ok ol l om on">npm i -D husky</span></pre><p id="1d6d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">接下来，我们需要启用Husky的git挂钩，我们可以使用以下命令来完成:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="5a68" class="mt la it og b gy ok ol l om on">npx husky install</span></pre><p id="5479" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">或者，如果您在全球范围内安装了Husky:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="fdbd" class="mt la it og b gy ok ol l om on">husky install</span></pre><p id="2187" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><em class="ov">提示:如果你得到如下错误:</em> <code class="fe os ot ou og b"><em class="ov">fatal: not a git repository (or any parent up to mount point '')</em></code> <em class="ov">，说明你还没有初始化git，你要通过运行</em> <code class="fe os ot ou og b"><em class="ov">git init</em></code> <em class="ov">命令来完成。</em></p><p id="e52f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果一切顺利，您将在终端中看到以下消息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/3b94ea652a11543dfe0daefc8863cd00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTc8BKezLLaFI6AsosX6KQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Husky安装正确</p></figure><p id="3c17" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">运行命令后，您应该在应用程序根目录中有一个新的隐藏目录，名为<code class="fe os ot ou og b">.husky</code>，其中包含Husky的配置。一旦我们确定它在那里，我们就可以忘记它，因为我们不需要自己编辑它。</p><p id="ec9e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">最后，我们需要添加commit-msg挂钩:</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="6d30" class="mt la it og b gy ok ol l om on">npx husky add .husky/commit-msg 'npx commitlint --edit $1'</span></pre><p id="85ea" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><em class="ov">注意:使用单引号来指定命令非常重要，因为如果使用双引号，</em> <code class="fe os ot ou og b"><em class="ov">$1</em></code> <em class="ov">将被转义。</em></p><p id="7dc4" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果一切顺利，您的终端应该有以下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/fb885aacc29a4473b5bb63da6239f126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v405eYCOaM8VwqhZtX0fdQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈士奇的提交消息挂钩添加正确</p></figure><p id="fe6b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们完了！是时候检验是否有效了。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="1039" class="kz la it bd lb lc oa le lf lg ob li lj jz oc ka ll kc od kd ln kf oe kg lp lq bi translated">测试</h1><p id="4949" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们试着不遵循惯例做些事情:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/1243949b31f326efabfee869ee41625a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQrvGAD4GteqHG-X3pOPtQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">提交失败</p></figure><p id="f70f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如您所见，我们的提交失败了。让我们用一个遵循约定的提交再试一次:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/a5aa2993ef21392b2ccc4411a8c8903d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*2TUOqDHxZwunq0hPttAidw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">传递提交</p></figure><p id="378c" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">干得好！您已经成功地将CommitLint和Husky添加到您的项目中！</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="ca7f" class="kz la it bd lb lc oa le lf lg ob li lj jz oc ka ll kc od kd ln kf oe kg lp lq bi translated">结论</h1><p id="3164" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">那都是乡亲们！如果遵循本教程一切顺利，你的git日志将会变得非常漂亮和干净(你的团队成员会因此而喜欢你)。</p><p id="975a" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">你可以在这里找到这个回购<a class="ae ky" href="https://github.com/puntotech/husky-commitlint-setup" rel="noopener ugc nofollow" target="_blank">的源代码。</a></p><p id="bf8b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">感谢阅读。</p></div></div>    
</body>
</html>