<html>
<head>
<title>3 Approaches to State in Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux中的3种状态方法</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/3-approaches-to-state-in-redux-b1835d1ab098?source=collection_archive---------8-----------------------#2020-06-30">https://betterprogramming.pub/3-approaches-to-state-in-redux-b1835d1ab098?source=collection_archive---------8-----------------------#2020-06-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f08d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">或者，在去商店的路上发生了一件有趣的事情</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/73b7df64e4e90d85f1d3dc2502afad8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GLl1y8YLnBtlO5JtdTKIiw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最佳花蕾(图片由作者提供)</p></figure><p id="7350" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">开发人员也是人，和其他人一样。</p><p id="25e5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们和任何人一样容易陷入俗套。事实上，我们更有可能。当你在一个紧张的期限内，并且你没有时间去试验你在这个项目中使用的库/框架/语言的所有闪亮的新特性时，你很容易陷入一个俗套。“以后，”你告诉自己，“我会深入研究这些文档，真正弄清楚是什么让这件事发生的。”</p><p id="aa6c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">太多时候，“以后”不会到来，实验的动力会消退，而您将会从头到尾了解的那项令人敬畏的技术会变成您腰带上的另一个工具，您会为一组非常特定的用例拿出来。</p><p id="3319" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我最大的缺点是使用了<a class="ae lr" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>和<a class="ae lr" href="https://react-redux.js.org/" rel="noopener ugc nofollow" target="_blank"> React Redux </a>，这两个伟大的库用于在React中处理应用程序范围的状态管理。我开始和他们一起工作，我进入了一个有效的流程，我拒绝从中挖掘出路。</p><p id="7df4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">直到现在，那是。今天我将向大家展示三种使用Redux和React的方法。其中两种方法利用了React Redux helper库，另一种方法纯粹是用Redux和自定义React挂钩实现的。</p><p id="138e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好奇吗？启动你的终端，让我们开始吧。</p><p id="cf4d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以在<a class="ae lr" href="https://github.com/timmalstead/3_ways_to_use_redux" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到完整的代码。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="9041" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">1.准备和安装</h1><p id="a82d" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated"><a class="ae lr" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank">创建React应用</a>是脸书提供的一个伟大的工具，他也创建了React和Redux，旨在在几分钟内为你启动一个正常运行的React应用。如果您还没有，我建议您输入以下命令进行全局安装:</p><p id="4b1d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">npm i -g create-react-app</code></p><p id="4534" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，通过键入以下命令创建一个新应用程序:</p><p id="497f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">npx create-react-app 3_ways_to_use_redux</code></p><p id="5096" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">构建完成后，导航到项目的根级别并键入:</p><p id="6e62" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">npm i redux react-redux</code></p><p id="4fb3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这将安装基本的Redux库，以及一个专门用来集成Redux和React的有用的钩子和方法库。</p><p id="3840" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我保证，只要再多一点点，我们就可以开始真正的编码了。</p><p id="577c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">导航到您的<code class="fe mw mx my mz b">src</code>文件夹并键入:</p><p id="9b0f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">mkdir redux</code></p><p id="eef8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这将为您创建一个文件夹来放置Redux逻辑。</p><p id="c140" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，打开您的<code class="fe mw mx my mz b">redux</code>文件夹并键入:</p><p id="79e7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">touch actions.js constants.js reducers.js store.js</code></p><p id="20a2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这将为您创建使用Redux的初始文件。</p><p id="c13c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">好吧！安装够了。启动你最喜欢的IDE，让我们开始工作吧。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8453" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">2.设置Redux</h1><p id="c9f4" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">先说<code class="fe mw mx my mz b">constants.js</code>。复制以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="f087" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在Redux中，您通过动作与状态交互。动作是必须有类型属性的普通对象。最佳实践是让type属性是一个字符串。但是因为字符串容易出错，所以将它们作为常量调用也被认为是最佳实践。明白了吗？</p><p id="e1fd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我知道，太多了。我喜欢把常数想象成你行为的标题。给它们取一个简短的描述性名称，并遵循一个令人尖叫的_SNAKE_CASE命名约定。我们将只对我们的状态做两件事，添加和删除文章。</p><p id="3f74" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，<code class="fe mw mx my mz b">actions.js</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="85bb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在这里所做的只是做一些传递对象的简单动作。正如我上面所说的，动作必须传递一个具有类型属性的对象。通常，他们也会传递信息。这个信息按照惯例被称为<code class="fe mw mx my mz b">payload</code>。我们将在下一步中看到如何使用该有效载荷。</p><p id="b4d7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">reducers.js</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="0c12" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">reducer是一个指示动作如何与状态交互的函数。它需要两个参数，状态和改变它的动作。当我们开始我们的程序并且reducer第一次运行时，我们将为它提供一个运行的初始状态。一种常见的模式是使用编写的<code class="fe mw mx my mz b">switch</code>语句根据类型属性对动作进行排序。看到所有的小片段是如何组合在一起的了吗？</p><p id="6543" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">需要记住的一件重要事情是Redux中的状态是不可变的<em class="nc">。</em>无法改变，只能复制替换。每次我们发一个动作，reducer都会看一下<code class="fe mw mx my mz b">action.type</code>，看如何实现。它将改变状态的一部分，并复制其余部分不变。</p><p id="6656" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在返回新副本之前，我们的reducer将对状态进行以下更改:</p><ul class=""><li id="d9ca" class="nd ne iq kx b ky kz lb lc le nf li ng lm nh lq ni nj nk nl bi translated">如果类型是<code class="fe mw mx my mz b">ADD_ARTICLE</code>，reducer将复制当前的<code class="fe mw mx my mz b">articles</code>数组，并将<code class="fe mw mx my mz b">payload</code>追加到其中。</li><li id="124a" class="nd ne iq kx b ky nm lb nn le no li np lm nq lq ni nj nk nl bi translated">如果类型是<code class="fe mw mx my mz b">DELETE_ARTICLE</code>，我们的reducer将过滤<code class="fe mw mx my mz b">articles</code>数组，并返回一个副本，其中包含id与<code class="fe mw mx my mz b">payload</code>不匹配的所有内容。</li></ul><p id="bdbd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">到目前为止，我们只是在用普通的JavaScript做一些事情。没有什么新奇的东西，没有什么特别的Redux魔法——只有字符串、对象、数组和一个开关。你可能会问，Redux实际上在哪里出现？你会在我们的下一个文件中看到。</p><p id="e195" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">store.js</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="c9b0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们走吧。我告诉过你Redux会有东西出现。我们使用Redux库中的<code class="fe mw mx my mz b">createStore</code>方法，用我们的reducer作为参数来创建一个存储，我们将它命名为<code class="fe mw mx my mz b">store</code>。</p><p id="2c9f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的商店就是我们的国家所在的地方。在我将要向您展示的两个工作流中，我们将使用React Redux helper库来访问存储，在第三个工作流中，我们将直接从存储中访问状态，然后编写我们自己的定制挂钩来将其交付给我们的组件。</p><p id="f134" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是我们最初的Redux设置。我们接下来设置我们的组件，这样我们就有好看的东西看了，怎么样？</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="60b7" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">3.设置前端并启用连接</h1><p id="8f86" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">我们已经设置了Redux存储来处理状态，但是我们仍然需要能够在组件中添加和使用状态。</p><p id="3952" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们要做的第一件事是在应用程序的入口点包装我们的<code class="fe mw mx my mz b">App</code>组件。将以下代码复制到应用程序根目录下的<code class="fe mw mx my mz b">index.js</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="1098" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们导入<code class="fe mw mx my mz b">Provider</code>组件并使用我们创建的商店作为道具后，应用程序的任何部分都可以访问Redux全局状态，而不必使用道具钻取<em class="nc">。</em>这是Redux和其他全球状态管理系统的主要诉求。您可以在应用程序的任何部分更改和访问状态，而不必通过应用程序中不需要它的部分进行传递。</p><p id="d11e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，创建一个名为<code class="fe mw mx my mz b">Components</code>的文件夹，并创建名为<code class="fe mw mx my mz b">List.js</code>和<code class="fe mw mx my mz b">Input.js</code>的文件。将以下代码复制到它们中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="6cb3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">喔，喔，喔。这些东西是怎么回事？这是我们将Redux状态和动作连接到组件时必须做的额外步骤。我马上会解释更多。不过，在此之前，请将下面的代码复制到根文件夹中的<code class="fe mw mx my mz b">App.js</code>中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="eb6e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在那里也创建一个名为<code class="fe mw mx my mz b">style.js</code>的文件。我喜欢这个应用程序中漂亮的亮红色，但请随意将其更改为您最喜欢的颜色。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="50f8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的两个新组件中，我们使用了与React Redux的<code class="fe mw mx my mz b">connect</code>方法相结合的<code class="fe mw mx my mz b">mapDispatchToProps</code>和<code class="fe mw mx my mz b">mapStateToProps</code>函数，将我们的Redux状态和动作传递到我们的组件中。为了导出它，我们创建一个高阶组件，然后将它用作默认导出。</p><p id="7281" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您在终端中键入<code class="fe mw mx my mz b">npm start</code>，您应该会看到类似这样的内容。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/a44fa2126a12cdb2a1e63e7b367fe554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fonEDxUvmUxt_VXeLYsnIg.png"/></div></div></figure><p id="d19b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">恭喜你，你已经用Redux设置了一个React应用。</p><p id="9ecd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果设置Redux需要经历很多，那是因为确实如此。自从引入钩子之后，我们有了更简单、更直接的选择来做同样的事情。我只是向您展示了连接Redux以作出反应的一种更老的风格，这样您就知道它看起来像什么以及它是如何工作的，以防您在查看更老的代码时遇到它。</p><p id="878f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下一节中，我将向您展示如何使用定制钩子来连接更现代的工作流。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="253d" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">4.使用钩子在React中重复</h1><p id="9c5b" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">在您的<code class="fe mw mx my mz b">redux</code>文件夹中，创建一个名为<code class="fe mw mx my mz b">selectors.js</code>的新文件，并复制以下代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="749a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里我们创建了一个定制钩子，使用React Redux的<code class="fe mw mx my mz b">useSelector</code>钩子指向Redux状态的一部分。它将Redux状态作为参数，从那里，您可以将它指向您喜欢的状态的任何部分。当然，我们只有<code class="fe mw mx my mz b">articles</code>可以使用，但是在实践中，您可以拥有简单或复杂的状态。然后我们返回一个对象中的文章。这将允许我们在组件中使用钩子时析构它。如果这看起来有点迂回，不要担心，你很快就会明白我的意思。</p><p id="4b78" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们必须改变一下我们的<code class="fe mw mx my mz b">actions.js</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="35a6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">类似于我们设置<code class="fe mw mx my mz b">selectors.js</code>的方式，我们在一个自定义钩子中使用React Redux的<code class="fe mw mx my mz b">useDispatch</code>方法来进一步抽象我们的动作对象。这是件小事，但我喜欢。它允许我们在组件中保持我们的动作更加原子化和清晰。此外，它允许我们将重点放在前端的重要逻辑上，例如文章中的文本，而不是我们在组件中不需要真正担心的事情，例如为对象创建id。有一个做两次事情的元素，但我觉得这是由我们的组件中的事情会有多清晰来平衡的，接下来。</p><p id="3d93" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">List.js</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="412a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">Input.js</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="dfed" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">啊，那不是很好吗？看每样东西看起来多干净。看所有的东西读起来多么简单。钩子很棒，我们可以解开状态的每一部分或我们需要的每一个动作，并放弃任何我们不需要的东西。</p><p id="804c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">启动<code class="fe mw mx my mz b">npm start</code>并确认一切正常。</p><p id="7f2c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">恭喜你。您已经将您的应用程序从旧的特设工作流迁移到一个干净的、基于钩子的现代工作流。</p><p id="674a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是我建议在生产应用程序中设置Redux状态的方式。除了易于阅读之外，Redux和React Redux库都经过了优化，可以在React应用程序中可靠、快速地工作。</p><p id="9cce" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">也就是说，为了启发我们自己，让我们构建最后一个工作流，这次不使用React Redux库，只使用Redux方法。这样，如果您希望将Redux用于其他框架，甚至静态网页，您可以获得更好的理解。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e5a6" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">5.反应中的冗余没有反应中的冗余</h1><p id="6eee" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">在我们之前的两个工作流中，我们从主Redux库中访问的唯一东西是我们的<code class="fe mw mx my mz b">store.js</code>文件中的<code class="fe mw mx my mz b">createStore</code>方法。我们与Redux交互的所有其他内容都来自React Redux库。</p><p id="ac7b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们稍微重构一下Redux文件。</p><p id="9626" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">store.js</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="9950" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的存储文件中，我们将从存储对象中析构一些方法并导出它们。这些将用于替换我们在上一个工作流中从React Redux导入的钩子。此外，我们将不再需要默认导出，因为我们将只从存储中导出方法，而不是存储本身。</p><p id="45dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">selectors.js</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="63e9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的选择器在实现上稍微复杂一点，但是在概念上与我们上一个工作流相同。我们正在设置一个<code class="fe mw mx my mz b">useEffect</code>钩子来监听我们从商店导出的<code class="fe mw mx my mz b">subscribe</code>和<code class="fe mw mx my mz b">getState</code>方法的状态变化。当我们的状态改变时，我们将把它设置到我们的<code class="fe mw mx my mz b">useState</code>钩子中，并用我们的<code class="fe mw mx my mz b">useReduxState</code>钩子把它导出到组件中。</p><p id="d142" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">是的，这有点绕弯，如果你的linter因为你在你的<code class="fe mw mx my mz b">useEffect</code>钩子的依赖数组中使用了复杂的表达式而对你大喊大叫，不要感到惊讶，但是它完成了工作。</p><h2 id="c858" class="ns ma iq bd mb nt nu dn mf nv nw dp mj le nx ny ml li nz oa mn lm ob oc mp od bi translated">更新</h2><p id="a976" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">我意识到我使用了一个<code class="fe mw mx my mz b">useEffect</code>钩子和<code class="fe mw mx my mz b">subscribe</code>函数做了过多的工作。下面的代码也可以工作。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="e2c1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我能想到的唯一缺点是(我相信)<code class="fe mw mx my mz b">subscribe</code>在Redux状态有任何变化时触发，而我相信<code class="fe mw mx my mz b">useEffect</code>钩子的依赖数组正在监听状态的特定部分。如果任何人有任何关于哪个更有性能的见解，我很乐意在评论中听到。</p><p id="e4fb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe mw mx my mz b">actions.js</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="26ca" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这与我们上一个工作流程几乎相同。事实上，这要简单一点，因为我们可以在这里使用<code class="fe mw mx my mz b">dispatch</code>方法，而不必解构它。</p><p id="2860" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们要做的另一件事是稍微重构一下我们的根层次<code class="fe mw mx my mz b">index.js</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="d40e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为我们没有使用React Redux库，所以没有必要导入商店或将我们的应用程序包装在一个<code class="fe mw mx my mz b">Provider</code> HOC中。</p><p id="ebbb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，检查以确保一切正常运行。</p><p id="4d47" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就是你在没有助手库的情况下使用Redux所需要做的一切。不太复杂，是吧？</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e444" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">最后的想法</h1><p id="e13b" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">我们已经分解了在React中使用Redux全局状态的三种方式。首先，我们学习了如何使用<code class="fe mw mx my mz b">connect</code>函数来设置高阶组件，以映射我们的状态并分派到组件中的props。然后我们学习了如何使用React Redux库中包含的钩子与我们的组件进行通信。最后，我们学习了如何在没有助手库的情况下使用状态。</p><p id="10a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我希望我已经向您很好地概述了Redux如何与React一起提供一个应用程序范围的状态管理解决方案，无论您选择如何实现它。</p><p id="29a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你觉得我遗漏了什么或者可以改进的地方，请在评论中告诉我。</p><p id="6855" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">黑客快乐！</p></div></div>    
</body>
</html>