<html>
<head>
<title>How To Build a Hello-World Cron Job With Firebase in 2019</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在2019年用Firebase建立Hello-World Cron作业</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-build-a-hello-world-cron-job-with-firebase-in-2019-659bd89d0f88?source=collection_archive---------16-----------------------#2019-09-19">https://betterprogramming.pub/how-to-build-a-hello-world-cron-job-with-firebase-in-2019-659bd89d0f88?source=collection_archive---------16-----------------------#2019-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d65e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">针对2019年的变更进行了更新</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6237392724022803e2491b852f45e7b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wfblFFWHR4sw89Cp.png"/></div></div></figure><p id="17ce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当我第一次开始编程时，我想创建的第一个工具之一是一个可以每天(或其他时间间隔)运行代码块的应用程序。</p><p id="e191" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是当你刚刚起步的时候，就像我一样，我不知道该去谷歌搜索什么来找到解决方法。如果你不太了解我，我原本是学心理学的，原本自学如何在MATLAB中编码。我写这篇文章是为了解释为像我这样的人编写一个<em class="ln"> cron作业</em>(可以在指定时间间隔运行的代码块)的基本构建块。</p><p id="4fe5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，无论你是一个有经验的程序员还是像我一样的菜鸟，这里有你需要知道的编写你的第一个cron工作的一切。</p><p id="0ab1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是您需要熟悉的工具列表，以便进行后续操作:</p><ul class=""><li id="41b4" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">节点. js</li><li id="3a80" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">BASH的基本命令行内容</li></ul></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="c132" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">1.先决条件</h1><p id="28c5" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">我们需要做的第一件事是确保Node.js安装在我们的机器上。您可以通过打开终端程序并运行以下命令来检查您是否已经安装了它:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="8c26" class="nl mk iq nh b gy nm nn l no np">node -v</span></pre><p id="7c3f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你得到“错误命令没有找到”的错误，那么你没有安装它。只要去<a class="ae nq" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">这里</a>下载它真的很快。</p><p id="f1a2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果它给了你一个版本，那么你就可以使用Node.js了。</p><p id="2e04" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">其次，我们需要确保安装了最新版本的npm。Npm(或节点包管理器)是我们将要安装Firebase CLI的方式。Npm是Node.js自带的，但是你下载了Node.js并不代表你有最新版本的npm。为了安全起见，请运行以下命令:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="99de" class="nl mk iq nh b gy nm nn l no np">npm install npm@latest -g</span></pre><p id="934f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，我们需要安装Firebase CLI(或命令行界面)。这将允许我们从终端初始化和部署我们的云功能。</p><p id="8d12" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你想阅读下载的文档，你可以在这里阅读更多。</p><p id="f241" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是如果您不耐烦(像我一样)，只需在您的终端中运行以下命令:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="8b9d" class="nl mk iq nh b gy nm nn l no np">npm install -g firebase-tools</span></pre></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="459a" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">2.有些东西需要运行你的代码</h1><p id="cd32" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">如果您曾经思考过cron作业是如何工作的，那么您可能已经意识到，为了实际执行您的代码，某些设备需要处于活动状态。</p><p id="c365" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您有三种常见的选择:</p><h2 id="0050" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">云函数</h2><p id="f75b" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">Cloud Functions非常容易设置，非常轻量级，让cron工作变得轻而易举。因为它很容易使用，我们将在整个教程中使用它。</p><p id="ddd5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有很多很棒的技术可以设置云功能，你不会错的。不过，我推荐AWS Lightsail或者谷歌的Firebase。在本教程中，我们将使用Firebase，因为他们的CLI对于部署云功能来说非常简单。</p><h2 id="b825" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">AWS/数字海洋类型实例:</h2><p id="4227" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">另一种选择是建立自己的机器实例。简而言之，这基本上意味着你正在激活世界上某个地方的一台将永远运行的计算机(就像你现在所在的这台计算机一样)。因为它总是开启、激活并由其他人维护，所以它可以在一定时间间隔内执行您的代码。</p><p id="0188" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为此，我强烈推荐AWS EC2实例、DigitalOcean或Kubernetes集群。</p><h2 id="f8d3" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">为你自己的硬件编程</h2><p id="9b84" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">这与设置机器实例基本相同，只是您负责确保机器正在运行并得到维护。除非你是专家，否则我不建议你这么做——除非你只是想玩玩树莓派什么的。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="39ed" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">3.初始化Firebase项目</h1><p id="a096" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">现在让我们开始写一些代码。</p><ol class=""><li id="ccb8" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm oc lu lv lw bi translated">打开你的终端。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/92352055a13a3036f58ee3568fc6fb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HoG6GWsplMppx9rNXSoJZQ.png"/></div></div><p class="oe of gj gh gi og oh bd b be z dk translated">如果您不知道如何打开它，请前往您的spotlight搜索并搜索“终端”</p></figure><p id="bc67" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我将进入我的项目目录，但是您可以导航到您想要存储代码的任何位置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/fd2e764d84d00d20f62932f4476b907e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IElZstRuWb5YRbhbDCWj_g.png"/></div></div></figure><p id="f266" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我需要创建我的项目目录，这是我将要存储这个项目的地方。因此，让我们用以下内容创建一个新文件夹:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="f86c" class="nl mk iq nh b gy nm nn l no np">mkdir HelloWorldFirebase</span></pre><p id="d972" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">并通过以下方式导航进入:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="25fb" class="nl mk iq nh b gy nm nn l no np">cd HelloWorldFirebase</span></pre><p id="6458" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将带我们来到这里:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/fa05535a7f89aa3299c61b822048f1ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s05dPoyHwPdLyFppwow2QA.png"/></div></div></figure><p id="b1be" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">好了，现在我到了我想去的地方，所以我要通过键入以下命令来初始化一个新的Firebase应用程序:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="c541" class="nl mk iq nh b gy nm nn l no np">firebase init</span></pre><p id="3a88" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">注意:</strong>如果您得到“错误命令‘Firebase’未找到”，那么您没有正确安装Firebase CLI。请返回，并尝试再次安装。</p><p id="bdb6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果一切正常，您将得到如下所示的输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/14556d31ea18442d4539aa0f179e78cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tLP5QhyIyVGe6qZ4Gx_hwg.png"/></div></div></figure><p id="96aa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Firebase让我们的初始化过程变得超级简单。您可以使用键盘上的箭头选择其中一个初始化选项。</p><p id="b207" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们想用云函数做的就是让代码每分钟左右运行一次。因此，我将通过点击space来选择“功能:配置和部署云功能”选项，然后通过点击Enter来确认我的选择。</p><p id="e32e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，它会要求您选择一个现有项目或创建一个新项目。为了保护现有项目的隐私，我不会在这一步显示我的屏幕，但您只需向下滚动并选择[创建新项目]。</p><p id="9a8b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后它会让你选择一种语言，Javascript或Typescript。</p><p id="0887" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我选了JavaScript，但是如果你喜欢Typescript，你就做你的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/121abaa4f00041aa6ef4e6b2eed915e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwMNhdPFb6OnMjZcGwF8XA.png"/></div></div></figure><p id="ef81" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它会问你是否要启用ESLint。只需按Y并输入。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/f8fdfde594e020ba71bef6c8f54a76ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wy_YQKAMUpcT70NscI1EJw.png"/></div></div></figure><p id="ae2e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这只是问你是否想现在安装npm依赖项，这是你最终要做的事情，所以我们不妨现在就做。按Y并输入。</p><p id="73df" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果一切按计划进行，我们应该会看到类似这样的内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/f333bca2c0f6be5f58b5324fd668ddc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qzbra9lpk3inoXU_qc6pmQ.png"/></div></div></figure><p id="a087" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你已经走了这么远，恭喜你！您已经用Firebase初始化了您的第一个云函数。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="e0ff" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">4.配置Google云控制台</h1><p id="7260" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">首先，您需要登录Firebase控制台。前往<a class="ae nq" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank">这里，</a>并登录或注册谷歌。一旦你进去了，就去<a class="ae nq" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank">这里</a>创建你的第一个项目。</p><p id="4841" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">同样，为了保护我的项目的隐私，我不会在这一步显示我的屏幕，而只是单击“添加项目”的大按钮</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/8ce0902c1aaa6e33f08db4361e1ffe50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-RxvsBL6oPXNPbRBicvI8A.png"/></div></div><p class="oe of gj gh gi og oh bd b be z dk translated">请原谅我的chrome标签，我边走边写</p></figure><p id="aea4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为你的项目选择一个名字(他们对某些字符有一些限制)，然后点击“继续”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/9ccab6be431d43f244b340f245ac294c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HXuoxxQO27GW1azJNUP6bg.png"/></div></div></figure><p id="aea2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将把你带到第二步。</p><p id="9ff4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">向下滚动一点，关闭谷歌分析。我们不需要那个。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/5da121a98a139bcbf35f48ddc682d91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhJKCUd1hGzraGq8Xqg14Q.png"/></div></div></figure><p id="bac4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">点击“创建项目”</p><p id="0665" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">给它一秒钟来初始化你的应用程序，再次点击继续，它会带你到Firebase控制台。</p><p id="f924" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这里结束之前，我们还需要做两件事(有点烦人)。</p><h2 id="fe64" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">升级您的账单方案并添加信用卡。</h2><p id="8ba8" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">我知道这很糟糕，但谷歌这样做是为了让你不能只是开始使用8万亿TB的计算能力。如果你超过一定限度，他们会告诉你。但是相信我，你不用付出任何代价就能得到一大笔钱。尤其是在发展的时候。</p><p id="4481" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，你需要创建一个谷歌帐户。点击<a class="ae nq" href="https://console.cloud.google.com/billing?authuser=0&amp;consoleUI=FIREBASE&amp;folder&amp;organizationId=0" rel="noopener ugc nofollow" target="_blank">这里</a>，登录，点击“创建账户”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/f45f7d0834bc1e82baa69bdc5cd8f485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AC7XuRHYIs_63dbxfn2WOA.png"/></div></div></figure><p id="e7fe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">选择一个名字(你叫它什么并不重要)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/c4c60f7722a8eceeab757fb1fbf1eabb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pkte3I-RBGB09SCz5ZrOUA.png"/></div></div></figure><p id="ff4c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后通过正常的帐单帐户设置的东西。</p><p id="3bbe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当你完成后，点击“提交”，它会把你带到这个控制台。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/1b16d6df81c565425f62eab2c6b12112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xBBwNLLb_YavnBVvqZpK3w.png"/></div></div></figure><p id="11c7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">太棒了，现在你有了一个可以链接你的项目的谷歌账单账户。</p><p id="bcf7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">回到你的Firebase控制台<a class="ae nq" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank">这里，</a>并选择你创建的项目，看起来应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/027458b062c22eb3400cfc2007f1e96f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UrjY0uXcTOAll5_tFTlfaw.png"/></div></div></figure><p id="6c16" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">左手边是你的导航。现在，我们有了Spark计划，我们希望将我们的项目升级到Blaze计划，这样我们就可以启用计费。</p><p id="a98e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">查看导航底部显示“升级”的地方，然后点击它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/aba2dce1df5efa6d7d9fe218493f5df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60JdgCEgjtNbTigd7APOKw.png"/></div></div></figure><p id="9997" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">点击“火焰”下的“选择计划”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/4edbb4a6f0e06a24e4e7906f004797e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DNzudTGlhSOL57b1w-V03w.png"/></div></div></figure><p id="2a77" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在选择您刚刚创建的要链接到的帐单帐户。如果你只有一个账单账户，那么它不会给你一个下拉菜单。但是，因为我有多个，它允许我选择我想要链接的一个。</p><p id="8efb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">此外，“随机计费帐户”是我为我的计费帐户选择的名称。这不仅仅是某个人的叙述。</p><p id="bc57" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">点击“购买”(别担心，他们不会向你收取任何费用)，你应该会收到一封通知你升级的电子邮件。</p><p id="d7f3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">好的。我们结束了。</p><h2 id="32d9" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">设置您的GCP资源位置</h2><p id="971d" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">实际上我不知道为什么Google只对cron作业要求这个，但是我们需要设置我们的GCP资源位置。不过，这很简单。</p><p id="53a2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在Firebase控制台的导航中，找到靠近顶部的小齿轮符号。点击它，然后点击“项目设置”，这将带你到这里:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/e97feb124a26a12297a218485cbf09d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6M7q7u0V3YCZYZfdI_--cw.png"/></div></div></figure><p id="f51f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在“谷歌云平台(GCP)资源位置”的右边，点击“尚未选择”旁边的小铅笔，这将打开它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/b69fd7fb439efb4aad420069f6bd4cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ds42jxBw6P5DKb1j1ZY16g.png"/></div></div></figure><p id="faa6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你总是可以在下拉列表中搜索位置，看看哪一个离你最近，但我住在洛杉矶，所以我将使用us-west4。</p><p id="bf13" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">好了，我们终于完成了控制台。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="bc4c" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">5.编写您的项目代码</h1><p id="ceec" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">在您喜欢的文本编辑器中打开您的项目目录。我将使用VSCode。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/cea684b3dc205fd88bc6409e9b4fd89f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hZ7AxtdbXwI1BpavvR44RQ.png"/></div></div></figure><p id="c9ed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是我们项目的基本结构。出于我们正在做的事情的目的，我们真正关心的唯一事情是“functions”目录中的index.js文件。让我们打开它。</p><p id="e852" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它给了我们一个示例云函数，写在这里的评论中。然而，这个例子是一个HTTP函数，我们想要一个cron作业。两者之间的区别在于它们是如何被调用的:</p><ul class=""><li id="9493" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm lt lu lv lw bi translated">通过向函数发送HTTP请求(如GET或POST请求)来调用HTTP函数，这与服务器在收到传入请求时调用路由的方式相同</li><li id="d100" class="lo lp iq kt b ku lx kx ly la lz le ma li mb lm lt lu lv lw bi translated">根据计划调用cron作业</li></ul><p id="51e9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我将添加运行我们的程序所需的最少代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/d04d82072c8fc86b454ed986e2519454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6CFsQMoM0qQ6YqZpwK4GBw.png"/></div></div></figure><p id="5d66" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你不在乎这意味着什么，你可以跳到下一节。如果你感兴趣，我会分解这段代码的每一行。</p><ol class=""><li id="6dca" class="lo lp iq kt b ku kv kx ky la lq le lr li ls lm oc lu lv lw bi translated"><code class="fe pb pc pd nh b">exports.myPubSubFunction</code></li></ol><p id="8ef0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是将我们的函数添加到exports对象中，并将我们的函数称为“myPubSubFunction”</p><p id="23f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">exports对象可以包含多个函数，所以如果我们想要添加更多的函数来部署到Firebase项目中，我们可以在这个index.js文件中向exports对象添加更多的函数。</p><p id="d103" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">2.<code class="fe pb pc pd nh b">functions.pubsub</code></p><p id="42be" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">functions类是我们在这个文件中做所有Firebase工作的基础。</p><p id="1889" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">前面我们看到了一个HTTP函数的例子，它是这样实现的:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="11be" class="nl mk iq nh b gy nm nn l no np">functions.http</span></pre><p id="505a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们想要创建所谓的发布/订阅功能，这基本上只是Firebase对cron作业的一种说法。</p><p id="15cb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">3.<code class="fe pb pc pd nh b">.schedule('* * * * *')</code></p><p id="4b84" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是我们安排工作的方式。五个星号代表这个想法，“每分钟做这个功能。”如果你想学习如何创建自己的时间间隔，去<a class="ae nq" href="https://crontab.guru/#1_*_*_*_*" rel="noopener ugc nofollow" target="_blank"> Cron Tab Guru，</a>会帮到你。</p><p id="d7d2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi">4.</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="586d" class="nl mk iq nh b gy nm nn l no np">.onRun(() =&gt; {</span><span id="e8f9" class="nl mk iq nh b gy pe nn l no np">console.log(‘Hello World’);</span><span id="656f" class="nl mk iq nh b gy pe nn l no np">})</span></pre><p id="3dad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是回调函数，当我们的函数实际被调用时，它将被调用。在这里，我们所做的就是告诉Firebase控制台记录一个老式的“Hello World”</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="6358" class="mj mk iq bd ml mm mn mo mp mq mr ms mt jw mu jx mv jz mw ka mx kc my kd mz na bi translated">6.使用Firebase CLI部署</h1><p id="3be1" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">感谢Firebase让这一部分变得如此简单。</p><p id="44b8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">再次打开终端程序，导航到项目目录。我要用VSCode集成终端。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/75246a5dff371a6063ed2b5062524bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1ZiAf8pkbyjbm2B9G3OzQ.png"/></div></div></figure><h2 id="dbf0" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">1.使用以下命令从命令行登录到您的Firebase帐户:</h2><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="47c9" class="nl mk iq nh b gy nm nn l no np">firebase login</span></pre><p id="2c37" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它会给你提示。只需点击Y并输入，这将打开您的浏览器与谷歌认证。做所有的登录工作，当你完成后，关闭页面并返回到你的终端。现在，您应该在终端程序中登录。</p><h2 id="f682" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">2.将本地代码链接到您创建的Firebase控制台项目</h2><p id="fd1b" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">为了链接您的项目，您需要获得您的项目ID。使用此命令:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="6597" class="nl mk iq nh b gy nm nn l no np">firebase list</span></pre><p id="48ef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将列出Firebase控制台中所有活动的项目。第二列显示“项目ID /实例”，是项目ID。找到您创建的项目，并从第二列复制ID。</p><p id="3b82" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后使用以下命令:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="5622" class="nl mk iq nh b gy nm nn l no np">firebase use --add &lt;Paste your project ID here&gt;</span></pre><p id="9c1d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以我的看起来像这样:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="93d9" class="nl mk iq nh b gy nm nn l no np">firebase use --add fir-helloworld-c494f</span></pre><h2 id="2bbb" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">3.部署您的项目</h2><p id="0817" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">终于，我们期待已久的时刻…</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="ebc7" class="nl mk iq nh b gy nm nn l no np">firebase deploy</span></pre><p id="ff3b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将把你的项目推到云端。如果所有的检查都没问题，你就可以走了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/332838cf86f477e2332167117f2d962f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fjz_zpVCHBxoGm_6SEtcOQ.png"/></div></div><p class="oe of gj gh gi og oh bd b be z dk translated">我的终端告诉我我准备好了</p></figure><h2 id="15ad" class="nl mk iq bd ml nr ns dn mp nt nu dp mt la nv nw mv le nx ny mx li nz oa mz ob bi translated">4.检查以确保您的项目正在运行</h2><p id="a2ec" class="pw-post-body-paragraph kr ks iq kt b ku nb jr kw kx nc ju kz la nd lc ld le ne lg lh li nf lk ll lm ij bi translated">回到<a class="ae nq" href="https://console.firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>，选择您的项目，在导航中应该有一个显示“功能”的按钮。点击它，它会把你带到这里:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/b6c9fb9192f360dca8903979bf08c765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JP-rXPVysnuOZR-QnFfDIg.png"/></div></div></figure><p id="436c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它现在显示我们有一个活动的cron作业以“* * * *”的时间间隔运行。点击“日志”查看console . log(“Hello World”)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pg"><img src="../Images/038511df1c9ac47bc5d314d52a1a976f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hVqd_gnpIEYIs_oDOzae7Q.png"/></div></div></figure><p id="1f8b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们看到我们的工作正在运行。</p><p id="8a90" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">注意:</strong>你在我的日志中看到的警告仅仅意味着在我们的函数中，我们没有返回任何值，显然他们希望我们返回一些东西。要解决这个问题，我们可以将它添加到我们的代码中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/2463694f1f876f138511dcc2eabe1fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVjdCDF_gF85HX7hhq1-6Q.png"/></div></div></figure><p id="abfb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">保存我们的文件。</p><p id="2479" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用以下命令再次部署我们的功能:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="aa25" class="nl mk iq nh b gy nm nn l no np">firebase deploy</span></pre><p id="db01" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它会再次执行所有检查。</p><p id="ebaa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">回到Firebase控制台，在那里我们再次查看我们的日志。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pi"><img src="../Images/ba2d56dadff03cc78151445dd9276ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e89cTZrzWhcXGSoH77mZJQ.png"/></div></div></figure><p id="d0b8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它已经不在了。</p></div></div>    
</body>
</html>