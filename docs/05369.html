<html>
<head>
<title>Build Simpler, More Modern Collection Views in iOS 14+</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在iOS 14+中构建更简单、更现代的收藏视图</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/build-simpler-more-modern-collection-views-in-ios-14-ca74eab2bb89?source=collection_archive---------10-----------------------#2020-07-02">https://betterprogramming.pub/build-simpler-more-modern-collection-views-in-ios-14-ca74eab2bb89?source=collection_archive---------10-----------------------#2020-07-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4d6e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">UICollectionView的新增功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fae4ca8015906f91d6f69217947f74f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jKFlMaqob4YCGWNMZDkMSA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ferrit?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Ferit ciek</a>在<a class="ae ky" href="https://unsplash.com/s/photos/scroll?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="f0d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来苹果正在提升收藏视图，通过让它包括水平滚动、垂直滚动等等，给了我们更多定制的灵活性。我相信这种现象的新术语是<em class="lv">现代收藏观</em>。</p><p id="5007" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天，您将走一条简单的路线，构建一个简单的现代收藏视图。</p><p id="df02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">切记这只有iOS 14及以上版本支持，并且只能在XCode 12+中使用。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="9669" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">先决条件</h1><p id="8ec3" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">要跟随本教程，您需要对Swift有一个基本的了解，并至少具备Xcode 12+的一些基础知识。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2c54" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">设置集合视图</h1><p id="9557" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">创建一个<code class="fe na nb nc nd b">UICollectionView</code>的<code class="fe na nb nc nd b">@IBOutlet</code>:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="4c71" class="ni me it nd b gy nj nk l nl nm">@IBOutlet weak var collectionView: UICollectionView!</span></pre><p id="44ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建<code class="fe na nb nc nd b">UICollectionViewDiffableDataSource</code>，用于管理数据并为集合视图提供单元格。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="a5a5" class="ni me it nd b gy nj nk l nl nm">var dataSource: UICollectionViewDiffableDataSource&lt;Section, Int&gt;? = nil</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="7906" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">设置数据源</h1><p id="b2a2" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">创建一个名为<code class="fe na nb nc nd b">configureDataSource</code>的函数，并插入以下代码来注册单元格并设置UI:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="62e9" class="ni me it nd b gy nj nk l nl nm">let cellRegistration = UICollectionView.CellRegistration&lt;UICollectionViewListCell, Int&gt; { (cell, indexPath, item) in<br/>    var content = cell.defaultContentConfiguration()<br/>    content.text = "Row \(item)"<br/>    cell.contentConfiguration = content<br/>}</span></pre><p id="dabf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在同一个函数中，您需要实例化之前创建的数据源。如果你记得的话，目前是零。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="d06e" class="ni me it nd b gy nj nk l nl nm">dataSource = UICollectionViewDiffableDataSource&lt;Section, Int&gt;(collectionView: collectionView) {<br/>    (collectionView: UICollectionView, indexPath: IndexPath, identifier: Int) -&gt; UICollectionViewCell? in<br/>    <br/>    return collectionView.dequeueConfiguredReusableCell(using: cellRegistration, for: indexPath, item: identifier)<br/>}</span></pre><p id="b88f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，将每条信息追加到数据源中:</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="1cf3" class="ni me it nd b gy nj nk l nl nm">var snapshot = NSDiffableDataSourceSnapshot&lt;Section, Int&gt;()<br/>snapshot.appendSections([.main])<br/>snapshot.appendItems(Array(0..&lt;94))<br/>dataSource?.apply(snapshot, animatingDifferences: false)</span></pre><p id="14ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，您将看到一个行为与表视图完全一样的集合视图。我总是试图在所有东西中使用表格视图，但看起来苹果正在试图改进收藏视图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/6d3aa0c908aa7ee093c9a708f8a64195.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/1*juzLk-A1ZYOUenZ1LVYw9g.gif"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="17aa" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">设置布局</h1><p id="a541" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我发现特别有趣的一点是你可以使用的布局。目前，布局设置为<code class="fe na nb nc nd b">plain</code>，这就是你在上面的GIF中看到的。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="260e" class="ni me it nd b gy nj nk l nl nm">let config = UICollectionLayoutListConfiguration(appearance: .plain)<br/>let layout = UICollectionViewCompositionalLayout.list(using: config)<br/>collectionView.collectionViewLayout = layout</span></pre><p id="5eea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe na nb nc nd b">insetGrouped</code>如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/1d9112fd1874529ba33b8513019c52da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jiNT-Q55uzmcf2zF7_5mbw.png"/></div></div></figure></div></div>    
</body>
</html>