<html>
<head>
<title>Improve PHPUnit Performance by Parallelization Using Liuggio-fastest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Liuggio-fast通过并行化提高PHPUnit性能</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/improve-phpunit-performance-by-parallelization-using-liuggio-fastest-ff0abc111078?source=collection_archive---------17-----------------------#2022-02-23">https://betterprogramming.pub/improve-phpunit-performance-by-parallelization-using-liuggio-fastest-ff0abc111078?source=collection_archive---------17-----------------------#2022-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="55d9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">最后，使用您的多核CPU以数倍的速度运行您的测试，即使是复杂的测试设置。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/85f13a27f165bbf93569940929f29ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ixKVe6la2ir565A5"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">费伦茨·阿尔马西在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="3a95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有多种方法可以并行化PHPUnit测试。</p><ul class=""><li id="1066" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">并行测试</strong>:<a class="ae kv" href="https://github.com/paratestphp/paratest" rel="noopener ugc nofollow" target="_blank">https://github.com/paratestphp/paratest</a></li><li id="d2c8" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">最快</strong>:<a class="ae kv" href="https://github.com/liuggio/fastest" rel="noopener ugc nofollow" target="_blank">https://github.com/liuggio/fastest</a></li></ul><p id="5456" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们首先来看看为什么要使用fast而不是Paratest</p><h1 id="8c43" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">比较的可用解决方案</h1><h2 id="6e49" class="my mh iq bd mi mz na dn mm nb nc dp mq lf nd ne ms lj nf ng mu ln nh ni mw nj bi translated"><a class="ae kv" href="https://github.com/paratestphp/paratest" rel="noopener ugc nofollow" target="_blank">并行测试</a></h2><ul class=""><li id="099c" class="ls lt iq ky b kz nk lc nl lf nm lj nn ln no lr lx ly lz ma bi translated">✅可以给你一个代码覆盖率的测试结果</li><li id="1565" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">✅简单的设置:因为它使用与PHPUnit相同的API和<code class="fe np nq nr ns b">--filter</code>等。</li><li id="d25f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">对于已经包装了PHPUnit可执行文件的更复杂的测试设置，❌可能会有问题</li></ul><h2 id="49b5" class="my mh iq bd mi mz na dn mm nb nc dp mq lf nd ne ms lj nf ng mu ln nh ni mw nj bi translated"><a class="ae kv" href="https://github.com/liuggio/fastest" rel="noopener ugc nofollow" target="_blank">最快</a></h2><ul class=""><li id="ec5e" class="ls lt iq ky b kz nk lc nl lf nm lj nn ln no lr lx ly lz ma bi translated">✅与其他PHPUnit抽象配合得很好，比如symfony的phpunit-bridge或numut/testing-framework，因为它可以调用任何脚本</li><li id="4c31" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">⚠️需要一些设置，因为它只是一个CLI实用程序</li><li id="72b7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">❌:摘要没有那么好，而且你不能综合报道结果。</li></ul><h2 id="d745" class="my mh iq bd mi mz na dn mm nb nc dp mq lf nd ne ms lj nf ng mu ln nh ni mw nj bi translated">选择什么</h2><p id="7601" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nt lh li lj nu ll lm ln nv lp lq lr ij bi translated">根据我的经验，它几乎总是以最快的<strong class="ky ir">结束</strong>，因为我使用的框架通常已经有了围绕PHPUnit的包装脚本。但是如果你需要的话，你将会丢失漂亮的覆盖报告。</p><h1 id="b5e0" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">最快是如何工作的？</h1><p id="d555" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nt lh li lj nu ll lm ln nv lp lq lr ij bi translated">这是一个CLI实用程序。</p><ul class=""><li id="e1e4" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">你给它一个所有测试类的列表~通常使用find命令</li><li id="3d2b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">对每个文件运行PHPUnit命令，然后解析结果</li><li id="35a9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">您将获得可以在CI中使用的成功或失败的单一结果</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/e6a4d9323d6946c459544b9fefe4272d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lElNe75qSZ0pwb7jhD_YcA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图表显示最快的控制流</p></figure><p id="f9e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是运行密集测试套件的样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/86bfcdf2143f23ad8d2b7ad195911e62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/1*CJA300csrfI5bnvUId7cEw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">跑得最快</p></figure><h1 id="f365" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">示例:与symfony的phpunit桥一起使用</h1><p id="f97a" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nt lh li lj nu ll lm ln nv lp lq lr ij bi translated">Symfony有一个<code class="fe np nq nr ns b">bin</code>文件夹，里面已经有一个<code class="fe np nq nr ns b">phpunit</code>二进制文件，它下载一个PHPUnit副本，然后运行测试。这意味着它已经比一个简单的PHPUnit脚本更复杂，paratest不能在那里工作。</p><p id="7a7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我喜欢在它旁边创建一个类似这样的外壳脚本</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="f5fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这个，您可以运行您的整个测试套件或者您的测试套件的一部分:</p><ul class=""><li id="b98a" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><code class="fe np nq nr ns b">bin/fastest</code> <br/> —运行所有测试</li><li id="aca0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><code class="fe np nq nr ns b">bin/fastest controller</code> <br/> —运行所有名称中带有“控制器”的测试类</li></ul><p id="687e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以在这里添加任何您想要的复杂性，甚至可以在want内运行另一个shell脚本。例如，如果不同的测试需要不同的配置文件，这可能会很有用。</p></div></div>    
</body>
</html>