<html>
<head>
<title>How I Used a Convolutional Neural Network to Classify Cricket Shots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何使用卷积神经网络对板球击球进行分类</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-i-used-a-convolutional-neural-network-to-classify-cricket-shots-d44197e79aff?source=collection_archive---------6-----------------------#2019-06-30">https://betterprogramming.pub/how-i-used-a-convolutional-neural-network-to-classify-cricket-shots-d44197e79aff?source=collection_archive---------6-----------------------#2019-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5d464701cd6e14f8e1fff70d65d438bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KGV_CLuZOVfyj5XB"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@sushanthkulkarni07?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">苏珊·库尔卡尼</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="e65d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我最近深入研究了深度学习的世界；更具体地说，图像分类。</p><p id="2baf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在完成了fast.ai MOOC 的第一堂课后，我决定去他们的图书馆玩一会儿。这让我制作了一个模型，可以对不同类型的板球击球进行分类。</p><p id="63e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<a class="ae kf" href="https://types-of-cricket-shots.onrender.com/" rel="noopener ugc nofollow" target="_blank">尝试分类板球击球</a>。模型并不完美，但确实有96%的准确率。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi le"><img src="../Images/8975d9a02d25738e863da4b4719b0990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*K1jhqznElc_1hpW9dHGZTA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">我的图像分类器网络应用！</p></figure></div><div class="ab cl lj lk hx ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="im in io ip iq"><h1 id="bcaf" class="lq lr it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">设置先决条件</h1><p id="1f7c" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">对于这个模型，我使用Google <a class="ae kf" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Colab </a>来托管我的笔记本。</p><p id="8e1c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个过程的第一步是去<a class="ae kf" href="https://colab.research.google.com/notebooks/welcome.ipynb#recent=true" rel="noopener ugc nofollow" target="_blank">https://colab.research.google.com/</a>用你的谷歌账户登录。</p><p id="8698" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您应该会看到一个类似如下的屏幕:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/bac4aebf451763d72e684e764912c719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJjRg6t37w99coo4M7L9jg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">Google Colab欢迎屏幕</p></figure><p id="94ee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想继续学习本教程，您应该按照下面的步骤在Colab中打开我的GitHub存储库中的笔记本。</p><p id="a4f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要从我的GitHub存储库中打开笔记本，请点击GitHub选项卡，并输入:<em class="mu"> siddhantdubey </em>。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/9f0fe0f644ed8302d8722b39d65b99b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6imxYkkI8TqunIxJGp0Z2A.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">这是弹出的屏幕</p></figure><p id="a7b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，点击<code class="fe mv mw mx my b">typesofshots.ipynb</code>文件。不要担心笔记本中弹出的错误消息，我们会处理好的。</p><p id="5051" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了确保您的笔记本将使用GPU加速器，请单击顶部选项卡上的<code class="fe mv mw mx my b">runtime</code>，然后单击下拉菜单中的<code class="fe mv mw mx my b">change runtime type</code>。</p><p id="331a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您应该会在屏幕上看到:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/38de9426c9fe9e199f92b10b3e8fd365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzSeZ-GjqDiHPqt3KlRtsQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">笔记本设置</p></figure><p id="7236" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">选择GPU作为您的硬件加速器，我们就万事俱备了。</p></div><div class="ab cl lj lk hx ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="im in io ip iq"><h1 id="375e" class="lq lr it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">编写代码</h1><p id="9614" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">本教程中的大部分代码将获取和清理数据。此外，我将更多地关注如何让它工作，而不是为什么它会工作。</p><p id="c257" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第一步是导入我们需要的库。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="68cd" class="nd lr it my b gy ne nf l ng nh">!curl -s https://course.fast.ai/setup/colab | bash<br/>from fastai.vision import * </span></pre><p id="c6c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行笔记本中的代码块，下载并导入fast.ai视觉库。</p><p id="f624" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是确保笔记本电脑将必要的数据保存到您的驱动器上，并且能够导入数据。</p><p id="e165" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，请运行以下代码块:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="2217" class="nd lr it my b gy ne nf l ng nh">from google.colab import drive<br/>drive.mount('/content/gdrive', force_remount=True)<br/>root_dir = "/content/gdrive/My Drive/"</span></pre><p id="02c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将确保您的数据是好的和可用的。</p><p id="c125" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在是真正下载数据的时候了！</p><p id="b0b4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将获得六种板球击球的图像:</p><ul class=""><li id="b4d6" class="ni nj it ki b kj kk kn ko kr nk kv nl kz nm ld nn no np nq bi translated">清扫。</li><li id="f795" class="ni nj it ki b kj nr kn ns kr nt kv nu kz nv ld nn no np nq bi translated">封面驱动。</li><li id="bf30" class="ni nj it ki b kj nr kn ns kr nt kv nu kz nv ld nn no np nq bi translated">直道行驶。</li><li id="2aa0" class="ni nj it ki b kj nr kn ns kr nt kv nu kz nv ld nn no np nq bi translated">直升机开枪了。</li><li id="f3d9" class="ni nj it ki b kj nr kn ns kr nt kv nu kz nv ld nn no np nq bi translated">独家新闻。</li><li id="e0df" class="ni nj it ki b kj nr kn ns kr nt kv nu kz nv ld nn no np nq bi translated">拉拍。</li></ul><p id="ad48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还有更多的类型，在完成本教程后，您肯定也可以尝试这些类型。</p><p id="c542" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">键入您想要的搜索查询，在这种情况下是“板球扫描镜头”)，用您想要的每种板球镜头替换“扫描镜头”。</p><p id="1b2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在Windows/Linux下按<code class="fe mv mw mx my b">Ctrl+Shift+J</code>，在Mac下按<code class="fe mv mw mx my b">Cmd+Opt+J</code>，就会出现一个小窗口(JavaScript的‘控制台’)。</p><p id="6c44" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是您粘贴JavaScript命令的地方:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="3504" class="nd lr it my b gy ne nf l ng nh">urls = Array.from(document.querySelectorAll('.rg_di .rg_meta')).map(el=&gt;JSON.parse(el.textContent).ou);<br/>window.open('data:text/csv;charset=utf-8,' + escape(urls.join('\n')));</span></pre><p id="a7e1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">复制并粘贴到控制台，它应该开始下载图像。</p><p id="43b1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将下载文件重命名为<code class="fe mv mw mx my b">urls_sweep.csv</code>，其中“sweep”是任何照片的名称，没有空格或大写字母。</p><p id="1d71" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，在你的google drive中创建一个名为<code class="fe mv mw mx my b">data</code>的文件夹，并在这个文件夹中创建另一个名为<code class="fe mv mw mx my b">shots</code>的文件夹。</p><p id="42e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将获得的所有CSV文件上传到<code class="fe mv mw mx my b">shots</code>文件夹。</p><p id="af16" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">接下来的步骤必须严格按照这个顺序进行！</strong></p><ol class=""><li id="0a50" class="ni nj it ki b kj kk kn ko kr nk kv nl kz nm ld nw no np nq bi translated">运行这个代码块。</li></ol><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="b21e" class="nd lr it my b gy ne nf l ng nh">folder = 'sweep'<br/>file = 'urls_sweep.csv'</span></pre><p id="3c60" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.运行这个代码块。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="9ef5" class="nd lr it my b gy ne nf l ng nh">path = Path(root_dir + 'data/shots')<br/>dest = path/folder<br/>dest.mkdir(parents=True, exist_ok=True)</span></pre><p id="24f0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.运行这个代码块。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="831b" class="nd lr it my b gy ne nf l ng nh">classes = ['sweep', 'coverdrive', 'straightdrive', 'helicopter', 'scoop', 'pull']</span></pre><p id="f4ea" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.运行这个代码块。</p><p id="f8c4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mv mw mx my b">download_images(path/file, dest, max_pics=1000)</code></p><p id="e4ce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对每个文件夹的文件块重复这四个步骤，总共六次。</p><p id="663d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，运行以下代码块:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="f220" class="nd lr it my b gy ne nf l ng nh">for c in classes:<br/>    print(c)<br/>    verify_images(path/c, delete=True, max_size=500)<br/>#This deletes all the images that it cannot open</span></pre><p id="a165" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们刚刚做的是为每一个不同类型的镜头创建文件夹，然后我们将图像从CSV文件下载到所述文件夹中。</p></div><div class="ab cl lj lk hx ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="im in io ip iq"><h1 id="1c1e" class="lq lr it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">创建数据集</h1><p id="fc95" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">现在我们必须创建数据集本身。</p><p id="afb4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，请运行以下代码块:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="2d71" class="nd lr it my b gy ne nf l ng nh">np.random.seed(42)<br/>data = ImageDataBunch.from_folder(path, train=".", valid_pct=0.2,<br/>        ds_tfms=get_transforms(), size=224, num_workers=4).normalize(imagenet_stats)</span></pre><p id="d48c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这从我们的路径<code class="fe mv mw mx my b">data/shots</code>创建了一个数据集，它将所有的图片转换成一个224x224的图像。</p><p id="4c59" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为什么是224x224？这使得模型更容易阅读，我们也更容易编码。</p><p id="7352" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行以下两个代码块将向我们展示我们的类(标签)和数据集中的一些图像。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="2c4b" class="nd lr it my b gy ne nf l ng nh">data.classes</span><span id="47b3" class="nd lr it my b gy nx nf l ng nh">data.show_batch(rows=3, figsize=(7,8))</span></pre><p id="8733" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，运行此代码块以获得更多关于数据集大小的信息:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="9af5" class="nd lr it my b gy ne nf l ng nh">data.classes, data.c, len(data.train_ds), len(data.valid_ds)</span></pre></div><div class="ab cl lj lk hx ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="im in io ip iq"><h1 id="167e" class="lq lr it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">训练模型</h1><p id="189e" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">我们终于准备好训练我们的模型了！</p><p id="b68e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就代码而言，这是该过程中最短的一步，但就时间而言，它有可能是最长的一步。不是因为它很难编码，而是因为它需要多大的处理能力。</p><p id="3af4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你试图在你的电脑上而不是像Google Colab这样的外部主机上做这件事，它会花更长的时间。</p><p id="0589" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，运行下面的代码块:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="32b5" class="nd lr it my b gy ne nf l ng nh">learn = cnn_learner(data, models.resnet50, metrics=error_rate)</span></pre><p id="60d2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这使用ResNet-50模型创建了一个卷积神经网络。ResNet-50是目前最好的图像识别模型之一。</p><p id="6c6e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，运行这段代码来训练网络。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="01af" class="nd lr it my b gy ne nf l ng nh">learn.fit_one_cycle(5)</span></pre><p id="d578" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将训练五个“时期”的模型，并向您显示每个周期的错误率。</p><p id="40fe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行下面的代码块来保存模型，并了解什么时候最有效。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="89ff" class="nd lr it my b gy ne nf l ng nh">learn.save('stage-1')<br/>learn.unfreeze()<br/>learn.lr_find()<br/>learn.recorder.plot()</span></pre><p id="546a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将保存模型，解冻它以进行进一步的训练，并绘制出训练的效率。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="2c2a" class="nd lr it my b gy ne nf l ng nh">learn.fit_one_cycle(2, max_lr=slice(3e-5,3e-4))</span></pre><p id="c290" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过运行上面的代码块，我们提高了模型的准确性，并有可能通过为更多的时期(如五个时期，而不是当前的两个时期)训练它，使其超过96%的准确性。这取决于你。</p><p id="f65f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要再次保存模型，请运行以下代码块:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="2516" class="nd lr it my b gy ne nf l ng nh">learn.save('stage-2')</span></pre></div><div class="ab cl lj lk hx ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="im in io ip iq"><h1 id="3b37" class="lq lr it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">解读数据</h1><p id="8cbe" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">首先，我们需要加载模型，看看它有多好。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="38b4" class="nd lr it my b gy ne nf l ng nh">learn.load('stage-2');</span></pre><p id="df0c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在一个时期内再训练一次。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="322a" class="nd lr it my b gy ne nf l ng nh">learn.fit(1)</span></pre><p id="565d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要获得模型有效性的解释，请运行以下代码块:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="8e35" class="nd lr it my b gy ne nf l ng nh">interp = ClassificationInterpretation.from_learner(learn)</span></pre><p id="2ecc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要显示混淆矩阵，它向您显示每个类别中的图像与正确标签匹配的次数，请运行以下代码块。</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="a6e4" class="nd lr it my b gy ne nf l ng nh">interp.plot_confusion_matrix()</span></pre><p id="4828" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从左上角到右下角的对角线展示了每张图像被正确识别的频率。</p><p id="6b9b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要查看哪些图像最容易混淆(我个人最喜欢的统计数据)，请运行以下代码块:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="c958" class="nd lr it my b gy ne nf l ng nh">interp.most_confused()</span></pre><p id="8795" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要绘制最大的损失——模型最有把握的图像，但无论如何都出错了——运行以下代码块:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="1b57" class="nd lr it my b gy ne nf l ng nh">interp.plot_top_losses(9, figsize=(15,11))</span></pre><p id="801d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们完了。如果您希望将您的生产模型导出为web应用程序并进一步测试它，请继续阅读。</p></div><div class="ab cl lj lk hx ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="im in io ip iq"><h1 id="c2da" class="lq lr it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">导出您的模型</h1><p id="7212" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">运行以下代码行:</p><pre class="lf lg lh li gt mz my na nb aw nc bi"><span id="bded" class="nd lr it my b gy ne nf l ng nh">learn.export()<br/>defaults.device = torch.device('cpu')<br/>learn = load_learner(path)</span></pre><p id="3e84" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这会将一个<code class="fe mv mw mx my b">export.pkl</code>文件保存到您的Google Drive的data/shots目录中。</p><p id="3525" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完成此操作后，不要再次训练您的模型，否则它会将<code class="fe mv mw mx my b">shots</code>作为要训练的职业之一。</p><p id="1ebf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要把这个模型变成一个网络应用程序，请跟随<a class="ae kf" href="https://course.fast.ai/deployment_render.html" rel="noopener ugc nofollow" target="_blank">这篇非常简短简单的教程</a>。这将有助于你将你的模型(希望不是这个)发布为一个web应用程序，就像我的一样。大约需要10分钟，非常简单。</p><p id="33df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢这篇文章，可以考虑订阅我的简讯:【https://mailchi.mp/35c069691d2c/newsletter-signup<a class="ae kf" href="https://mailchi.mp/35c069691d2c/newsletter-signup" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl lj lk hx ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="im in io ip iq"><h1 id="026b" class="lq lr it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated"><strong class="ak">资源:</strong></h1><p id="086b" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated"><a class="ae kf" href="https://course.fast.ai/" rel="noopener ugc nofollow" target="_blank"> FastAI课程</a></p><p id="86fa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://github.com/siddhantdubey/cricketshotclassifier" rel="noopener ugc nofollow" target="_blank">我的板球射门分类器github储存库</a></p><p id="d039" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://course.fast.ai/deployment_render.html" rel="noopener ugc nofollow" target="_blank">如何将您的模型部署到web上。</a></p></div></div>    
</body>
</html>