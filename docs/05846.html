<html>
<head>
<title>How to Make Google Sheets Send Personalized Emails for You</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何让Google Sheets为你发送个性化邮件</h1>
<blockquote>原文：<a href="https://betterprogramming.pub/how-to-make-google-sheets-send-personalized-emails-for-you-61be083553eb?source=collection_archive---------7-----------------------#2020-08-11">https://betterprogramming.pub/how-to-make-google-sheets-send-personalized-emails-for-you-61be083553eb?source=collection_archive---------7-----------------------#2020-08-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="03e1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">逐步邮件合并指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c32a43e23a570a913731b947349d3246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4fzXbkC-AHRXl3iC"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Kon Karampelas 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="b7e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您是否曾经需要向一群人发送电子邮件，并希望对每个人的问候进行个性化设置？哦，你不想一遍又一遍地发送同一封邮件吗？</p><p id="aa4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是啊，我也是。我想很多人都发现自己一遍又一遍地复制同一封邮件，并把它发送给一长串的收件人。</p><p id="02fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢天谢地，有一个解决方案。</p><p id="2f7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不可否认，Google让像你我这样的用户可以很容易地进入他们的工具，创建定制的功能。我最喜欢的构建工具之一是Google Sheets。</p><p id="9b99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对Google Sheets(谷歌版的电子表格应用程序)非常熟悉，你就会知道它已经非常强大了。但是用一点小魔法(又名<a class="ae ky" href="https://www.google.com/script/start/" rel="noopener ugc nofollow" target="_blank">应用程序脚本</a>)，你可以进一步发挥这个工具的内在功能。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3227" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建并设置您的Google表单</h1><p id="6760" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有了谷歌的应用程序脚本，我们可以快速方便地将谷歌表单连接到Gmail。让我们首先创建一个新的电子表格。我们将保持这个例子的简单性，并将这五个列标题添加到我们的工作表中:</p><ul class=""><li id="46ca" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">名字</li><li id="22c6" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">电子邮件</li><li id="70a5" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">科目</li><li id="6de4" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">消息</li><li id="2fdc" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">状态</li></ul><p id="e42e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的工作表应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/aaa1333c1570c28980c8acff6aed404a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLH0we92fiVl9JSc9CBtkQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">你可以随心所欲地设计你的表格！</p></figure><p id="7895" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常在这一点上，我们会继续添加我们想发送电子邮件的人。但是要让你开始，继续添加你自己的名字和电子邮件，然后填写主题和信息。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="af50" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">创建您的应用程序脚本文件</h1><p id="9ae4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在，您已经准备好设置我们之前谈到的一些魔法了。</p><p id="cdf1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导航到工作表顶部，选择工具→脚本编辑器:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d882267ce040ede7d48be8c3b4d87137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*J7EEaJ7QzRHr6_pCELR_SA.png"/></div></figure><p id="f961" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将为您打开一个新标签。继续给该文件命名并点击保存按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/67b883cf415824da638afafac563cd33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5jKfFjx7Y_YPpkO_Ja-CSA.png"/></div></div></figure><p id="02c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你会注意到Google已经为我们建立了一个很好的功能模块。我们将用它来编写允许我们通过Google Sheets发送电子邮件的函数。</p><p id="4845" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nq">注意:在我们开始之前，让我们讨论一下我们的脚本将做什么→ 1。连接到我们的工作表，并建立我们的数据范围，2。循环浏览每封电子邮件/联系人，并向每个人发送一封电子邮件；3 .发送电子邮件时，将每个电子邮件/联系人的状态更新为“已发送”。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="90b0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">第一步</h1><p id="7174" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们需要做的第一件事是创建一些变量来连接我们的工作表并保存我们将在电子邮件中使用的数据。<strong class="lb iu"> </strong>您可以将以下内容添加到您的功能块中:</p><pre class="kj kk kl km gt nr ns nt nu aw nv bi"><span id="e1d1" class="nw md it ns b gy nx ny l nz oa">// Connect your script to your sheet<br/>var sheet = SpreadsheetApp.getActiveSheet();</span><span id="acac" class="nw md it ns b gy ob ny l nz oa">// First row of data to process (start your count at 1)<br/>var startRow = 2;</span><span id="7d83" class="nw md it ns b gy ob ny l nz oa">// Gets the last row of data<br/>var lr = sheet.getLastRow();<br/>  <br/>// Fetch the range of cells A3:B(lr)<br/>var dataRange = sheet.getRange(startRow, 1, lr-1, 5);<br/>  <br/>// Fetch values for each row in the Range<br/>var data = dataRange.getValues();</span></pre><p id="e036" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我留下了一些注释，这样你可以看到我们在每个变量中存储了什么。如果你的工作表和我的一样(参考上面的图片)，你不需要修改任何代码。在这一点上，我们的函数能够连接到我们的工作表并获取我们发送电子邮件所需的数据。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="bfc0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤2和3</h1><p id="957c" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们的下一步是建立一个循环，它将遍历我们的联系人并发送电子邮件！</p><p id="6723" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">复制这段代码，并将其粘贴到我们在步骤1中创建的<code class="fe oc od oe ns b">data</code>变量下的函数中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="fad1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于工作表中的每一行数据，这个<code class="fe oc od oe ns b">for</code>循环:</p><ol class=""><li id="9fc8" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu oh nf ng nh bi translated">获取我们存储在变量中的数据。</li><li id="4397" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu oh nf ng nh bi translated">验证该地址实际上是一个电子邮件。</li><li id="9609" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu oh nf ng nh bi translated">发送个性化电子邮件。</li><li id="8b72" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu oh nf ng nh bi translated">将状态更新为<em class="nq">已发送。</em></li></ol><p id="9c6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就这么简单！</p><p id="b62c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您已经设置好了一切，您的函数应该如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="of og l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="94bf" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">这仅仅是开始</h1><p id="b5fb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">你可以把它带向很多方向。我鼓励你去看看谷歌关于<a class="ae ky" href="https://developers.google.com/apps-script/reference/spreadsheet" rel="noopener ugc nofollow" target="_blank">电子表格</a>和<a class="ae ky" href="https://developers.google.com/apps-script/reference/gmail" rel="noopener ugc nofollow" target="_blank"> Gmail </a>应用程序脚本的文档。</p><p id="65c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一些很酷的功能想法供您探索:</p><ul class=""><li id="9c42" class="mz na it lb b lc ld lf lg li nb lm nc lq nd lu ne nf ng nh bi translated">自定义问候语</li><li id="bc7b" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">自定义签名</li><li id="cba4" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">文件附件</li><li id="fd3c" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">模板(使用您的Gmail草稿或预设回复)</li><li id="ac09" class="mz na it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">跟踪退回的电子邮件</li></ul><p id="e18b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">发挥创意，让我知道你想出了什么！</p></div></div>    
</body>
</html>